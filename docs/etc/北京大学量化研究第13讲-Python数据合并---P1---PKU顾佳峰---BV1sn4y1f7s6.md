# 北京大学量化研究第13讲：Python数据合并 - P1 - PKU顾佳峰 - BV1sn4y1f7s6

亲爱的亲爱的同学们，大家好，我是北京大学郭嘉峰老师，今天我们继续来讲北京大学量化方法课，今天我们讲第13讲，讲开始之前，首先给同学们推荐这么一课，我们在9月20号至22号在北京大学举办。

然后研究方法课总共三天的课程，然后呢这个大家有兴趣的话，可以关注这个公众号啊。

![](img/40d766e036083661ddad18d9c0639651_1.png)

具体去了解具体的信息，那我们接下来呢今天要讲第13讲，讲什么呢，讲如何通过Python做数据合并。

![](img/40d766e036083661ddad18d9c0639651_3.png)

以及数据合并之后的一些处理，所以关于这个课的具体情况，大家可以去点击这个微信公众号，相关信息都在上面，我今天就不具体展开来讲，那我们今天呢实际上来讲Python做数据合并呢。



![](img/40d766e036083661ddad18d9c0639651_5.png)

还是用pandas这个命令来做，然后呢我们这有两个数据啊，前面上前两节课我们都介绍过，我们现在呢要把这两个数据给它合并啊，合并当然我们跑一下，跑rain出来，这个这个是第一个数据库，这样是第二个数据库。

我们可以看到他们都是五五个case，然后统计学数学经济学的。

![](img/40d766e036083661ddad18d9c0639651_7.png)

那我们合并以后呢，我们比如说要修改这个王自强他的数学成绩，把它改成85，然后呢我们我们就怎么来处理啊。



![](img/40d766e036083661ddad18d9c0639651_9.png)

我们可以看一下，这个时候大家可以看这个王王志强嗯，然后数学成绩呃。

![](img/40d766e036083661ddad18d9c0639651_11.png)

呃这个第三统计学成绩变成了85。

![](img/40d766e036083661ddad18d9c0639651_13.png)

我们可以看到对吧，就是把它修改，那下面呢我们可以把他们的那个行。

![](img/40d766e036083661ddad18d9c0639651_15.png)

全重重新命名。

![](img/40d766e036083661ddad18d9c0639651_17.png)

我们可以看到他这个还是回到统计学，计算机管理学这几个啊，然后统计跟统计学的这个。

![](img/40d766e036083661ddad18d9c0639651_19.png)

我们这里看到这个DNFF出来，数学数学上面啊，计算机经济学，管理学，统计学统计，我们现在可以看到是统计。



![](img/40d766e036083661ddad18d9c0639651_21.png)

计算机管理学，那我们如果把共同变量合并之后呢，我们可以看一下共同编啊，合合并之后呢，实际上只有一个就是王子强啊，然后呢他的成绩就是这些成绩。



![](img/40d766e036083661ddad18d9c0639651_23.png)

其中呢他的数这个统计学成绩，我数已经修改过啊。

![](img/40d766e036083661ddad18d9c0639651_25.png)

那呃我们也可以继续继续合并啊。

![](img/40d766e036083661ddad18d9c0639651_27.png)

看一下第一FD1DF1DF2。

![](img/40d766e036083661ddad18d9c0639651_29.png)

我们可以看他实际上跟前面还是一样的。

![](img/40d766e036083661ddad18d9c0639651_31.png)

如果有多个没有或者没有返回值的情况。

![](img/40d766e036083661ddad18d9c0639651_33.png)

怎么样呢，我们可以看一下啊，这里面你看这里面他就有有这个控制，然后这里面都是有控制的。

![](img/40d766e036083661ddad18d9c0639651_35.png)

实际上也也可以把它做出来嗯。

![](img/40d766e036083661ddad18d9c0639651_37.png)

然后呢合并之后有控制怎么样也可以，你看这像这些都属于控制啊。

![](img/40d766e036083661ddad18d9c0639651_39.png)

如果额用write，这是左边的。

![](img/40d766e036083661ddad18d9c0639651_41.png)

用right的right，他就控制就变成了这边嗯。

![](img/40d766e036083661ddad18d9c0639651_43.png)

我们再来看一下，这就我们重新命名啊，重新命名一个是统把统计变成统计学是吧。

![](img/40d766e036083661ddad18d9c0639651_45.png)

这个名称就可以改变，然后我们根据姓名来来看姓名。

![](img/40d766e036083661ddad18d9c0639651_47.png)

然后这个移右侧的话，右边的XXYYY区别开来。

![](img/40d766e036083661ddad18d9c0639651_49.png)

然后呢如果有有这个共同变量合并。

![](img/40d766e036083661ddad18d9c0639651_51.png)

如果有发这个这个缺失值的话。

![](img/40d766e036083661ddad18d9c0639651_53.png)

也可以看到这些缺失值啊，然后我们可以下面看数据怎么筛选。

![](img/40d766e036083661ddad18d9c0639651_55.png)

我们这个就是这个调用这个数据。

![](img/40d766e036083661ddad18d9c0639651_57.png)

我们如果选出统计线乘积为大于80的。

![](img/40d766e036083661ddad18d9c0639651_59.png)

它就两个啊，然后我们选择统计学成绩85。

![](img/40d766e036083661ddad18d9c0639651_61.png)

88或者90的，我们可以看到其实就两个。

![](img/40d766e036083661ddad18d9c0639651_63.png)

八十五八，我们选择名字叫田剩余的。

![](img/40d766e036083661ddad18d9c0639651_65.png)

就这个啊，我们选择统计学88，数学100的就这个。

![](img/40d766e036083661ddad18d9c0639651_67.png)

所以这个经济学，这这这这我们可以选择前面两个。

![](img/40d766e036083661ddad18d9c0639651_69.png)

然后根据经济学排序，经济学成绩排序。

![](img/40d766e036083661ddad18d9c0639651_71.png)

这个是这个，所以都可以做啊。

![](img/40d766e036083661ddad18d9c0639651_73.png)

统计学成绩在85~100之间的，只有两个对吧。

![](img/40d766e036083661ddad18d9c0639651_75.png)

下面的我们随机随机放抽样。

![](img/40d766e036083661ddad18d9c0639651_77.png)

那随机样本的抽样，这个我想还是照明天来讲，我们现在呢讲到这里。

![](img/40d766e036083661ddad18d9c0639651_79.png)

今天就差不多了，大家可以看，其实Python做数据库处理啊，尤其合并处理是非常简单的哈，欢迎大家来报我们9月份的量化课。



![](img/40d766e036083661ddad18d9c0639651_81.png)