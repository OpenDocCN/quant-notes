# 【2024新版--5天拿下Python金融量化+股票分析+数据清洗+可视化从入门到实战】100集（全）附视频课件 资料 代码等等 - P8：07 df的前世之Series~1 - 写代码的程序猿儿 - BV1Q7SdYkEhS

的话。

![](img/4be2e1bd23f0e8f018a1260572551a00_1.png)

咱们就进入到了pandas这样的一个模块，的学习过程当中，那么前几个小节呢，咱们已经把这个NIPPP模块进行了一个，讲解对吧，那么nip模块，我们再次的进行一个大致的回顾哈，nip模块。

我们说它就是一个基于一维或者多维的，一个数组吧，并且这个数组当中存储的应该是一，些数值型的数据，是不是啊，那么有了NIKE这样的一个模块，这样的一个容器可以存储相关的数据，并且可以对这些个数值型数据。

进行相关形式的处理和运算，为什么还需要学习pandas as呢，那么首先咱们来看一下哈，那么我都知道这个nip模块已经可以，帮我们进行数值型数据的处理了对吧，那么学习pandas as的目的是什么呢。

OK我们来解答一下啊，那么首先这个在我们的数据分析当中，除了需要去分析处理，运算相关数值型的数据之外，那么还有大量的需求，需要我们去分析处理相关非数值型的数据，OK吧。

那么如果你想去分析处理非数执行的数据的话，那么非数值型的数据，我们常见的应该是字符串类型的数据吧对吧，那么这些数据咱们怎么处理呢，就需要借用到我们的pandas这样的一个模块。

所以说我们的pandas as，主要是用来帮我们去处理什么呢，非数执行类型的数据吧，OK吧，所以说你要把pandas跟NIKE它的特性区分开来，nip主要是存储处理我们数值型的数据。

而我们所谓的pandas主要是用来存储跟处理，非数值型的数据吧，是吧好。

![](img/4be2e1bd23f0e8f018a1260572551a00_3.png)

那么首先这个pandas as模块咱们怎么学呢，首先在pandas模块当中，我们需要学习两个常用的类，一个类叫做series，一个类叫做data frame，OK吧。

那么首先这个series跟data frame，是两种不同形式的数据结构，一再提到数据结构的话，那么我们就要知道数据结构指的就是一个容器，容器当中可以装载数据，是不是啊，我们在讲解NIKE模块的时候。

我们说NIKE它也是某种形式的数据结构，它也可以装载去处理数据吧，那么我们pandas当中这两个常用的类，一个series，一个data frame也是两个常用的数据结构，我们也需要将非数值型数据。

可以存储到我们的series跟data frame当中，并且基于这两种数据结构封装好的，相关的工具类相关的特性，可以去处理其存储的非数值型数据吧，OK吧，那我们说这个pandas。

主要是用来存储和处理非数值型数据吧，那你让它去存储数，存储这个数值型的数据可以吗，也是可以的啊，也是可以的，只不过它通常被用来存储和处理，非数值型类型的数据。



![](img/4be2e1bd23f0e8f018a1260572551a00_5.png)

OK吧，那么接下来我们就来看一下pandas当中，封装好的这两个常用的类，这两个数据结构怎么去用，OK吧，那么首先咱们先来看一下series啊。

我们可以从serious逐步的引出咱们data frame，这样的一种数据结构的使用和处理方式，OK吧好那么这个在pandas as模块当中，咱们重点要学习的就是我们的data frame啊。

但是的话我们的series可以帮我们逐步的引出，data frame到底是怎样的一个东西，OK吧，包括我们的series就是组成data frame的一个组成元素。

或者说我们的date frame就是由series组成的，所以说我们如果能够想要更好的去学习，data frame的话，首先你得先知道series是什么。



![](img/4be2e1bd23f0e8f018a1260572551a00_7.png)

对不对啊，那么现在看一下我们的这个series啊，那首先我们说serious它是一种形式的数据结构，可以装载存储数据，是不是，那么我们可以暂且的把这个series，当成是一个一维的数组，OK吧。

当成是一个一维的一个数组，OK吧啊，当然它本质意义上来讲并不是一个一维的数组，只不过和一维数组存储数据的格式很相似，所以说咱们暂且可以把它当成一个一维的数组，仅仅可以是一维。



![](img/4be2e1bd23f0e8f018a1260572551a00_9.png)

不可以是多维，OK吧，OK啊，那么serious暂且把它理解成是一个一维的数组，那么这个一维的数组是由两部分组成的，第一部分叫做values，第二部分叫做index，OK吧，那毫无疑问。

values指的是说我们series这样的一个，类似于一维的数组结构，存储的数组元素叫做values吧对吧，index指的是我们每一个数组元素，所对应的一个索引，OK吧，对应的一个索引啊。



![](img/4be2e1bd23f0e8f018a1260572551a00_11.png)

那接下来咱们就首先来学习一下，如何去创建咱们的series吧，那么在创建之前，在这我们先要导入一下我们的这个series，对应的一个类吧对吧，怎么导入呢，首先我们从pandas当中import。

导一下我们的这个series这样的一个类就可以了，OK吧，From pandas import series。



![](img/4be2e1bd23f0e8f018a1260572551a00_13.png)

将series进行一个导入，打完之后，我们就可以基于series去创建一个，类似于一维数组的一个数据结构了吧，好怎么创建呢，在这的话就是基于我们series的构造方法，进行一个创建，OK吧。

首先series是一个类，那括号表示的是调用这个类的构造方法吧对吧，那构造方法有哪些参数呢，首先我们会用到这么几个参数，第一个叫做data data，指的是我们的数据源。

那就是说我们需要把series这样的一个，一维的数据结构当中存储的数据是什么，对不对，index毫无疑问指的是我们存储数据的一个索引吧，DETAPE指的是存储数据的数据类型，是不是。

那么首先首先咱先用一下这个data吧，那谁可以充当data呢，那在这的话，首先我们可以使用列表充当我们的数据源，比如说123是吧，这再写一个啊，for ok吧。

那么现在啊这块的话我们就创建好了一个series s，咱们在这呢用S去接受一下。

![](img/4be2e1bd23f0e8f018a1260572551a00_15.png)

并且将series打印一下走，你会发现现在这块所返回的，这样的一个数据结构，就是咱们创建好的一个series，OK吧，你看这个serious，首先第一列是不是我们每一个元素的索引是吧。

默认的索引是从零开始的呀，第二列指的是我们这个series当中，存储的每一个元素吧，分别是123跟for，是不是跟for吧，OK吧啊，那所以说你看这块我们就创建了一个啊series。

这个serious看上去就像是一个一维的数组吧，OK吧，当然它跟数组是有不同的，因为我们说数组哈，数组的话它是什么呢，它是需要存储的数据元素的类型得是统一的吧，对吧，得是统一的，那现在在这块的话。

你看我们的这个series创建好了之后，这块所存储的是123跟four啊对吧，那123four这几个数值它的类型是什么呢，OK吧，那是统一的还是可以为不统一的呢，我们逐步的往后去看，OK吧。

逐步的往后去看啊，那现在我们使用了我们的列表，充当了我们的数据源是吧，那除了用列表充当数据源，我们还可以用什么呢，用我们的NIKE充当数据源，我们来看一下啊，首先将我们的这个NIKE模块呢进行一个导入。

是不是就可以了，然后呢在这啊我们来创建一个serious serious，然后再次使用它的构造方法，date等于什么，等于我们的这个NP点r random点，random int对吧。

从0~100size，给他一个三行四列，你会发现，现在我这个数据源对应的是不是一个三行四列，二维的一个NP数组啊，那么二维的NP数组可以充当咱们一维serious，这样的一个数据结构的数据源吗。

我们来试一下S打印一下走，那这块给我们报了一个异常。

![](img/4be2e1bd23f0e8f018a1260572551a00_17.png)

是不是为啥呢，是因为我们说series，它仅仅是一个一维形式的数据结构，那一维形式的数据结构，怎么可以去存储一个二维的数据源呢，不可以吧，那怎么办呢，好我们把这个什么呢。



![](img/4be2e1bd23f0e8f018a1260572551a00_19.png)

nip啊，给它更换成一维的形状，再看一下走是不是可以了对吧，可以了啊，那么从这个案例当中也可以更加充分的体现出，我们的series仅仅是一个一维的数据结构吧对吧。



![](img/4be2e1bd23f0e8f018a1260572551a00_21.png)

仅仅是一个一维的数据结构，OK啊那接下来我们来看一下，那现在我们是不是只用了data呀对吧，只用了data这样的一个这样的一个这个呃，构造方法的参数副词之外，我们再来看一下下的参数二叫做index吧。

index指的是它的索引，那就是说我们可以通过index这样的一个参数，动态的显示的去声明它的索引，比如说我这写一个A写一个B写一个C，再次看结果哎，应该有四个元素是吧。



![](img/4be2e1bd23f0e8f018a1260572551a00_23.png)

对走会发现现在这块所打印的series123for，这几个值，它的索引就不再是0123了吧，而变成了ABCD是不是，那么就意味着这块我们来写一下啊，因DEX啊，这个参数是用来啊用来这个指定什么呢。

显示索引的，那么这个显示索引就是我们的index可以表示的吧，对吧，那如果没有index，我们默认的0123，它它被称之为隐式索引啊，隐藏的隐隐式索引。



![](img/4be2e1bd23f0e8f018a1260572551a00_25.png)

而我们使用index可以给我们构建显示索引吧，OK吧，那这块我们来想一个问题哈，就是说这个为什么为什么，需要啊，需要有显示，所以呢只有隐式索引的话是够了吧，为啥还需要有显示索引呢，对吧，为啥呢。

这块我们来思考一下啊，那么原因就在于，是不是意味着我们使用显示索引，那就是说显示索引可以可以增强这个，serious的，可读性啊对吧，你比如说啊我们这我们这想存的是什么呀，1234这么四个值吧。

那么1234各表示的含义是什么呢，如果用默认的隐式索引的话，是用0123来表示1234的索引啊对吧，那0123表示的是什么含义呢对吧，那可读性不强，那如果我这可以用什么，可以用这个语文啊。

用语文数学英语理综，那么这几个值来表示1234各自的索引的话，那么意味着就可以通过显示索引，更加直白的来表示，我们1234这四个数所对应的含义吧。



![](img/4be2e1bd23f0e8f018a1260572551a00_27.png)

所以说我们可以使用显示索引，增加cs s的一个可读性，OK吧啊增加cs的可读性好。

![](img/4be2e1bd23f0e8f018a1260572551a00_29.png)

那这块的话我们就使用了这个这个NIKE啊，NIKE作为了我们serious的一个数据源吧，那除此之外啊，这块还可以使用我们的字典，充当serious的数据源，比如说我这有个字典DC好。

那这块有一个什么呢，叫做语文啊，后边是一个100分啊，还有一个是数学好，这个是99分，还有一个叫做理综，250分OK吧，现在这有个字典，然后的话我们来看一下SS等于serious。



![](img/4be2e1bd23f0e8f018a1260572551a00_31.png)

好，这块的话data我们来指定义一下数据源，数据源就是我们的字典，可以吧，好打印下serious走。

![](img/4be2e1bd23f0e8f018a1260572551a00_33.png)

会发现现在我们就创建了一个series，这个series当中所存储的数据来源于我们的字典吧，会发现字典当中的key作为了series的显示索引吧，字典当中的value值作为了series当中存储的元素。

是不是OK吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_35.png)

那么基于这三种方式，我们就可以创建series s吧，对吧啊，使用我们的列表充当数据源。

![](img/4be2e1bd23f0e8f018a1260572551a00_37.png)

使用NIKE充当数据源，使用字典充当数据源，OK吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_39.png)

那这个是我们serious的一个基本的创建形式，OK吧，那serious我们会创建了。

![](img/4be2e1bd23f0e8f018a1260572551a00_41.png)

那么接下来我们就来看一下，serious的索引和切片，那其实series的索引和切片很简单，因为它是一个类似于一维的数组啊，那么它的索引和切片，就跟我们一维数组的索引和切片是一模一样的。

你比如说我S是这样的一个series s吧对吧，那我在这中括号零我取的是谁呢，取的是不是第零个元素啊，取的是语文的成绩是100啊对吧，那除此之外我还可以series s可以怎么着，可以点一个什么呢。

点一个语文走返回的是不是也是100，对不对，也是100万，这意味着如果我们的series有显示作用的话，我们可以通过打点儿啊，打点调显示索引，来返回显示索引所对应的一个内容吧，OK吧这个是我们的索引。

那切片呢S中括号。

![](img/4be2e1bd23f0e8f018a1260572551a00_43.png)

比如说零冒号二走是不是切除了前两个呀，对不对，切除前两个啊，那这个就是我们的索引和切片很简单。

![](img/4be2e1bd23f0e8f018a1260572551a00_45.png)

这个我们就不说了是吧，跟一维数组很类似吧对吧，很类似啊，好那么接下来看一下我们所用的常用的属性。

![](img/4be2e1bd23f0e8f018a1260572551a00_47.png)

那常用的属性哪些呢，首先S点sheep。

![](img/4be2e1bd23f0e8f018a1260572551a00_49.png)

sheep返回的不就是serious的形状吗，对吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_51.png)

S点size size返回的不就是什么呢，这个series元素的个数吗对吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_53.png)

还是我们的S点index轴，那么这个index所返回的是不是我们的索引啊对吧，这个是返回这个serious的索引，返回索引OK吧，然后的话还有S点values走。



![](img/4be2e1bd23f0e8f018a1260572551a00_55.png)

返回的是不是值啊对吧，这个是返回value值，返回的是我们series当中所存储的每一个元素值，对不对啊，这个是他所常用的这四个属性。



![](img/4be2e1bd23f0e8f018a1260572551a00_57.png)

很简单吧，我们就一带而过了，OK吧，一带而过啊，好那然后的话还有一个S点S点d type，看一下类型。



![](img/4be2e1bd23f0e8f018a1260572551a00_59.png)

看这块所返回的是不是int64啊，那么意味着d tape可以返回啊，返回我们series元素的类型吧对吧。



![](img/4be2e1bd23f0e8f018a1260572551a00_61.png)

返回元素类型好，那这块的话我们就来做一个测试，比如说咱们之前说。

![](img/4be2e1bd23f0e8f018a1260572551a00_63.png)

我如果通过这种形式去创建一个series的话，这个series当中啊。

![](img/4be2e1bd23f0e8f018a1260572551a00_65.png)

这个serious里边既有啊整数值，也有字符串是值，那么最终它的类型是什么呢，看一下它的一个DETAPE造，看O这个O表示什么的啊，这个数据数据类型O啊表示的是object的意思。

object表示的就是字符串类型，OK吧，那所以说你看现在我们原始的数据是，123跟four吧对吧，最终都给我强转成了字符串类型，对不对啊，那么意味着在series当中，也只能存储同类型的数据吧是吧。



![](img/4be2e1bd23f0e8f018a1260572551a00_67.png)

只能存储同类型的数据啊，好这个是我们series相关的属性的一些个操作。

![](img/4be2e1bd23f0e8f018a1260572551a00_69.png)

那么接下来还有什么呢，serious常用的方法，这四个方法的话就我逐一的来看一下吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_71.png)

啊其实也不多啊也不多，首先那在这的话我先去创建一个series s吧，S等于series好，在这儿的话我的data数据源就是由NIKE创建吧，random点random int好。

还是从这个60~100吧，size的话给它一个长度是十，可以吧，是十啊。

![](img/4be2e1bd23f0e8f018a1260572551a00_73.png)

现在看一下我们的serious走series s有了吧对吧，那首先看一下第一个方块。

![](img/4be2e1bd23f0e8f018a1260572551a00_75.png)

点2head干嘛使的走head，就是说显示什么呢，显示这个series当中的前个什么呢，数据吧，默认的这个N是五，OK吧，默认N是五，那如果这写一个三呢。



![](img/4be2e1bd23f0e8f018a1260572551a00_77.png)

只显示前三条数据吧，对不对好，那除此之外还有tell，那tell是不是后几个呀对吧，tail就是后几个，比如我这几个三不显示后几个元素啊，对吧好，显示后N个元素吧。



![](img/4be2e1bd23f0e8f018a1260572551a00_79.png)

OK吧好，那还有啥呢，还有我们的这个unit queen啊，unit queen的话，它的功能就更强大了，比如说啊现在我S点S点uni k好，这块返回的是什么呢，返回的你看这元素个数几个。

2468是不是九个了，为啥是九个呢，原来的数组是不是原来的这个series，里面存的是不是十个值啊，为啥这返回值九个呢，是因为我原始的数据当中一定有重复的元素吧，对吧。

unit queen表示的是什么呀，去重啊，去除重复的元素是去重的意思，OK吧，unit queen啊，然后下边的话什么is呢，not now这些是什么意思呢，好在这去看一下啊。

看SSD r is none啥意思。

![](img/4be2e1bd23f0e8f018a1260572551a00_81.png)

走返回的都为false，返回的十个false吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_83.png)

啥意思意思，那我们这写一下，is n是用于啊用于判断，判断每一个元素是否为什么呢，是否为空，OK吧，设为空，如果为空，返回true，否则返回什么呢，false吧，这意思，那是不是，那有意思呢。

还有什么呢，有一个叫做not ns点，Not now，那not呢跟it now是不是刚好相反的对吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_85.png)

它是用来判定元素是否为非空吧，为非空返回true。

![](img/4be2e1bd23f0e8f018a1260572551a00_87.png)

否则返回false吧，所以这返回的是不是十个true啊，另外十个true啊，你在想，那我的series里边怎么可能会产生空值呢，对吧，怎么会产生空值呢，咱们在这去试一下。

比如说哈现在我有S1SE1等于series好，它里边所存储的值是1123，可以吧，好这块的话，我给他设定一个显示索引吧，显示索引分别是A。



![](img/4be2e1bd23f0e8f018a1260572551a00_89.png)

C可以吧，好还有一个呢是S2啊。

![](img/4be2e1bd23f0e8f018a1260572551a00_91.png)

看一下S2，S2的话存的也是123，只不过索引变成了ABC可以吧，现在我有S等于S1加上S2，你看现在我是不是让两个series相加了。



![](img/4be2e1bd23f0e8f018a1260572551a00_93.png)

然后现在我去执行，看一下相加之后的结果是什么，走看一下这返回的是什么呀，2N6N啥意思呢，会发现那series如果进行算术运算的话。



![](img/4be2e1bd23f0e8f018a1260572551a00_95.png)

那么它的一个运算的法则是什么呢，法则法则根据我们这儿所看到的一个样式，会发现法则一定是索引，索引啊，索引一致的元素进行算术运算，否则不空，你会发现，首先你看这啊，我们这儿的话。

那S1里边的123分别对应的，所以是ABC吧是吧，S2的123对应，所以是不是ADC呀，会发现，那如果啊现在我让S1加S2，意味着只有A和C这两个索引对应的一和三，能相加，分别得到了二六这两个值。

那么二和二能加吗，不能加，因为S1当中的二对应的，所以是BS啊，S1对应的是B是不是S2当中的二对应，所以是D啊，这个B和D这两个值它的索引不一样，那就不能添加，不能添加怎么办，是补空啊。

你看B跟D就以none的形式给他补空了吧，这块用的是一个NAN，并不是我们的NONE吧对吧，那么这两种形式那是有区别的。



![](img/4be2e1bd23f0e8f018a1260572551a00_97.png)

区别是什么，我们后边会说到啊，会说到那，所以说现在我会发现我这块的话。

![](img/4be2e1bd23f0e8f018a1260572551a00_99.png)

我的S里边就产生控制了吧对吧，那我就s d r is n看走你返回的既有false又处吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_101.png)

那这个false就表示A啊A这一块啊，A这个索引所对应的值是一个废空吧是吧，B索引对应的值是不是空啊，这个空是不是，所以说这个是is now跟note n这两个函数，它所对应的含义。

可以监测我们series当中的每个元素。

![](img/4be2e1bd23f0e8f018a1260572551a00_103.png)

到底为非空或者是空吧，OK吧啊那么后边还有什么呢。

![](img/4be2e1bd23f0e8f018a1260572551a00_105.png)

还有我们的这个ADD sub new div，这是不是加减乘除对应的意思呀对吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_107.png)

你可以使用什么，可以使用我们的这个运算符来进行加减乘除。

![](img/4be2e1bd23f0e8f018a1260572551a00_109.png)

当然也能去调用，上边已经给我们封装好的这些方法吧对吧，那能用运算符我们就不用方法了吧，你只需要知道这些方法是什么意思。



![](img/4be2e1bd23f0e8f018a1260572551a00_111.png)

是不是就可以了对吧，表示的是加减乘除对应操作吧，OK吧，那这个就是我们series的一个基本使用对吧。



![](img/4be2e1bd23f0e8f018a1260572551a00_113.png)

会发现在series当中并没有学到过多的东西吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_115.png)

只是我们掌握了如何创建series对吧。

![](img/4be2e1bd23f0e8f018a1260572551a00_117.png)

然后series的常用属性包括常用的方法有哪些对吧，并且series s在进行算术运算的时候。

![](img/4be2e1bd23f0e8f018a1260572551a00_119.png)

它有一个法则，就是索引一致的元素才能够进行算术运算，否则的话就补空白，这个否则指的是与之进行算术运算的。



![](img/4be2e1bd23f0e8f018a1260572551a00_121.png)

索引不一样才会补空，是不是，OK吧好这个就是我们serious。

![](img/4be2e1bd23f0e8f018a1260572551a00_123.png)

所以说series，我们会发现它就是一个类似于一维数组的。

![](img/4be2e1bd23f0e8f018a1260572551a00_125.png)

数据结构吧，OK吧，那么这个数据结构哈它如果创建好了之后。

![](img/4be2e1bd23f0e8f018a1260572551a00_127.png)

所显示的样式是这样的吧，对不对，那么在这个series当中既有隐式索引，也有显示索引吧对吧，那为啥会需要有显示索引呢，是因为显示索引可以增加我们serious，存储数据的一个可读性。



![](img/4be2e1bd23f0e8f018a1260572551a00_129.png)

是不是，OK吧好，那么这个就是我们的series，那么serious完事之后呢。

![](img/4be2e1bd23f0e8f018a1260572551a00_131.png)

下一小节咱们就来看一下这个data frame怎么来用，OK吧，那么首先先铺垫一下我们的series啊，是data frame的一个组成元素，那就是说我们的data frame是由SER。

是由多个series组成的，OK吧，那所以说你看series是一个一维的数据结构，而我的data frame是由多个series组成的，那你就来试想一下data frame到底是一个怎样的。

是怎样的一个维度的数据结构呢，OK吧，各位可以思考一下啊。

![](img/4be2e1bd23f0e8f018a1260572551a00_133.png)