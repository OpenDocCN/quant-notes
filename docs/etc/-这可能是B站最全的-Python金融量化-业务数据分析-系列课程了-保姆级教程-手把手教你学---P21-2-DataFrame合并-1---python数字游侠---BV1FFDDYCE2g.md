# 强推！这可能是B站最全的【Python金融量化+业务数据分析】系列课程了，保姆级教程，手把手教你学 - P21：2.DataFrame合并~1 - python数字游侠 - BV1FFDDYCE2g

那么这一小节咱们来看一下data frame当中。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_1.png)

合并的操作，OK吧，那这个合并跟基连啊，听起来像是两个近义词啊，对不对，好像它们表示的含义是一样的呀，其实大清啊其实呃是不一样的啊，其实是大有区别的啊，那么我们来说一下它们主要的区别是什么啊。

区别是什么，首先我们说这个基点，就是说将我们的date from进行横向或纵向的拼接，是不是啊，那它所对应的载体是表格吧，是不是使用两个表格进行横向或纵向的拼接，这个是我们的基点，对不对。

那我们这个合并是啥呢啊，合并指的就是说啊，我们需要将两个data frame当中的数据进行整合，进行合并，所以说合并对应的是数据，而我们的基联对应的是表格吧，一个是对表格的拼接，一个是对数据的合并。

数据的整合，对不对，那这个合并就可以把它当成是咱们MYSQL，数据库当中的什么呀，多表联查之前的什么呀，这个多表的合并吧，对吧是吧，你想进行多表联查，比如说想进行两张表的联查。

你得先把这两张表合并到一起啊是吧，把这两张表合并到一起，只就是说把这两张表里的数据合并到一起来，对不对，所以说这个是我们的合并，合并对应的是我们的数据。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_3.png)

OK吧，那咱们来感受一下吧，比如说啊这块看一下DF长这个样子吧对吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_5.png)

DF2长这个样子，看一下，那DF1和DF2这两张表对吧，看一下它们的列索引不一样吧是吧，一个是employee，一个是group，一个是employee，个是hear date吧对吧。

那么这两张表首先我问你能不能做几点，能是不是可以做横向节点，那竖着纵向节点也行吧，只不过会补空，是不是因为知道group跟car date是不一样的，所以是不是得补空对吧，所以说它是可以节点的。

但是我们在这需要对其进行一个合并，什么叫合并合并，我们说是对数据做合并吧对吧，那你看一下，你看这一两张表有没有共有数据啊，有吧，看employee这一列是不是有bob jack lisa。

我们的DF是不是也有bob jack lisa呀，是不是有固有的数据，就可以将固有的数据合并到一起啊，怎么合并，你看我能不能将bob accounting跟下边的bob2008，合并到一起啊是吧。

合并成一条一个新行表示的，还就是说bob这个人，是不是在这个22008年进行的，一个这个这个这个呃入职啊对吧，然后他的工种他的部门是这个accounting，对不对对吧，然后呢。

这个jake engineering，可以跟下边的JK2012合并吧是吧，那LISA是不是跟下边的LISA合并，最终这两张表的数据合并成一张新表之后，它所对应的是应该是有三行三列呀，对不对，那试一把吧。

试一把啊，好怎么合并呢，pd d r调一下我们的march啊，march march当中的话看一下它的参数，首先参数一是一个什么呀。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_7.png)

left参数是right是左表运用表啊，你要知道我们基点可以集点多张表，而我们的合并一次只能合并两张表吧，对吧好，那life就是我们DF1right是不是DF2啊对吧。

那在这的话我们合并不得有一个合并条件。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_9.png)

你在做多表联查的时候，需不需要有一个连查的条件啊，也需要吧对吧，那在这我们就准备下on本田的on的话，就是我们的这个进行合并的条件吧是吧。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_11.png)

那合并条件不就是我们的employee吗。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_13.png)

是根据这一列进行了一个什么呀，合并啊，走返回的是不是三行三列对吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_15.png)

就将这两张表基于一个合并条件，进行了一个什么呢，数据的合并吧对吧，那么这个on你也可以不写啊，不写默认情况下你不写的话，就是说它会将两张表当中。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_17.png)

共有的列作为合并条件走不一样啊，OK吧一样吧啊你写不写是不是都可以啊，因为这两张表已经有共有的一列列了是吧，有共有的employee这列，它就可以默认的作为咱们合并的条件吧对吧。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_19.png)

那么合并的话，咱们是不是是不是有说有一对一的合并。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_21.png)

一对多的合并跟多对多的合并啊对吧，在咱们的数据库也有类似情况吧对吧，那现在你看我们这儿的这种合并方式。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_23.png)

是不是一对一啊是吧，一个bob对应一个bob lisa对一个LISA是吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_25.png)

然后呢JK对一个JK吧，是不是一对一，那是不是也有一对多啊对吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_27.png)

你看下一对多的合并，这是DF3。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_29.png)

就是DF4，首先这两张表能合并吧，先看能不能合并对吧，能不能合并，你得找有没有可以作为合并的条件吧，这里边有吗，不有啊，是不是group可以作为合并条件，对不对，你看accounting。

Accounting，Engineerary engineering，你看那么这个engineering跟下边第二张表的engineering，做合并的话，是不是一对多啊。

我是不是需要将ENGINEERY跟它合并一次，再用engineering，是不是跟他再合并一次，是不是也得多对吧，最终所产生的是不是也应该是一个三行几列啊，算好几列，三行四列吧，是吧。

三行四列的一个表吧对吧，那试试呗，p DDR marge好，那这块的话我们DF3是左表，DF4是右边吧对吧，那合并条件不写。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_31.png)

默认是不是group呀是吧，这返回的不就是我们的334列吗，这不是一对一的合并啊对吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_33.png)

这块的engineering跟下边的两个engineering，进行了一个一对多的数据合并吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_35.png)

OK吧好那有一对多是不是也有多对多呀是吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_37.png)

DF1长这个鬼样子，DF5长这个鬼样子OK吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_39.png)

现在能不能合并呢，看一下有group吧是吧，可以作为合并条件，是不是可以合并啊对吧，你看这的engineering是不是跟这的ENTERERARY，是不是多对多的合并，什么叫多与多。

先拿这一行跟这一行合并吧，对不对，再拿这一行跟第二行合并吧，不再拿它的第二行跟第一行合并在哪，看第二行是不是跟第二行合并，就是说这个engineering和这两个engineering合并之后。

会产生四行，是不是OK吧，然后bob是不是跟下啊，这个这个什么这个accounting，是不是跟下边的accounting合并啊，那没有counting怎么办，应该补空吧，对不对，那试一把啊，试一把好。

在这的话是pd点marge d f。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_41.png)

一是左表DF5是表吧，条件不写的话，默认用的是GRP吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_43.png)

走那这里边有空吧，没有空，为什么没有空呢，好看它的参数啊，这里边有一个号吧，how末是不inner啊，那我的这个号如果是一个outer是啥呢。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_45.png)

找你有空吗，是不是有空啊，对不对，所以说这个号是用来指明咱们合并的方式吧，那在数据库做多表连接的时候，你在进行多表链接的时候，有没有左连接内连接，外连接内连接啊，有吧。

那么在我们data frame做合并的时候也是有的，那怎么表示啊，用我的号表示，how默认是inner，表示是内连接，outer是外连接吧，是不是外链接可以保留所有的数据，而内连接只能去连接。

能够连接的下啊。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_47.png)

是不是也有左连接右连接啊对吧，那左连接右连接什么意思呢，比如在这好，我的连接方式是左连接，左连接是谁，这个左指的是左表啊对吧，组表你说保留左表所有的数据吧。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_49.png)

组表是DF1DF1里边有谁，看一下DF1里边是不是有accounting。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_51.png)

Df5，里面是有A，这个这个这个这个这个什么这个hr对吧，那我们先看一下。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_53.png)

那保留左表accounting有没有有吧，hr有吗，没有吧，那右连接呢是不保留右边组数据啊，hi有account没有啊，对不对，就是左连接跟右连接的区别是不是OK吧。

这是号所对应的这个参数所对应的含义啊。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_55.png)

再看这啊，DF1长这个样子。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_57.png)

DF2长这个样子是吧，现在我们让这两张表做合并能合并吗，看一下有没有共有列吧，有employee group，Employee group。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_59.png)

你看你是不是有两列都一样啊对吧，那如果两列都一样，在这看一下啊，P d d r marge，如果两列要是都一样，我如果不指明我的on的话，那么默认情况下谁作为合并条件呢，是employee还是go配啊。

都不是，是employee和group共同作为边界条件，因为这两列跟下边两列是一样的呀，我们说共有的列是不是作为合并条件，那就是说这个accounting是这两个条件，作为合并条件。

JKCTING只能跟下边的jk accounting连接吧，能不能跟这个CEO连接啊。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_61.png)

不能吧，所以说你的二不写的话，默认情况下是让我们的employee和accounting。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_63.png)

都作为一个合并条件吧对吧，如果你想指明一个话怎么办。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_65.png)

是不是通过on去指明啊，是通过on指明，比如说GROP对吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_67.png)

这样的话我们的合并条件就是group，而不再有employee了吧。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_69.png)

OK吧好，那再看这种情况，Df1。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_71.png)

这两张表看一下能合并不，首先你初步观察它没有共有的列吧，employee还是this，这是什么呀，Headate group，Employee，Employee，这是name。

是不是是不是没有共有的一列啊，对不对，这是还是date，这还是this吧对吧，那没有固有的列，是不是就不能合并了呢，不一定我们说合并是对数据做合并，如果有固有的数据是可以合并的。

即使它的列索引不一样也行啊，你看这的employee跟name都是员工的名字呀，bob是LINDA，bill lisa bills啊，box是不是有共有的数据啊，能合并不能吧。

但是的话这就会出现一个问题，pd点，好比如说我DF1左边DF5右边吧对吧，那这块我的on指明成什么呢，on指名成name还是employee呢，是不是都不行啊，不是name的话。

是不是这里有个这里有个这个表里面没有name啊，如果是employee的话，这个表里面没有employee吧，那怎么办，我需要分别指明left啊，我用左表，你看是不是left是左边条件。

左边条件是不是DF1啊，用什么呢，employee对不对，右眼呢right on用谁用。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_73.png)

是不用name啊，等你这样是不是可以合并啊，对不对。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_75.png)

这样我们的employee和name，是不是作为我们的合并条件进行合并了吧，这是我们的left on和right down这两个参数的作用吧。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_77.png)

OK吧啊好。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_79.png)

那下边的话就指的是我们的outer取并集，inner取交集。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_81.png)

还有我们的left1和right吧，这个我们是不是刚才已经做过了对吧，做过了啊。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_83.png)

这是他的合并方式，左连接内连接，外连接右连接，是不是，OK吧，这个就是我们的合并。

![](img/0f485c9903ae290f08f0ff9b4aca74f5_85.png)

所以说通过观测我们的合并跟我们的几点，你可以更加深入的理解，我们的合并是对数据的合并对吧，就跟我们MYSQL的库表多表联查是一样的对吧，而G点是对我们的数据做拼接呀对吧，那你要知道。

那如果哈给了你两张表，那这两张表我需要做合并还是做几点呢，先看题目的要求，如果题目没有要求，你需要怎么分析呢，如果这两张表大部分的索引都一样，那一定是做几点吧是吧，如果只有局部的索引一样对吧。

甚至有索引都不一样，那就不能做节点，是不是只能做合并啊，OK吧，自己理解一下这样一句话，OK吧，好，那么所以说这块就是我们data frame当中的，节点跟合并，OK吧，那么下一小节。

咱们就需要对人口的一组数据展开分析，那么在这个人口分析数据的案例当中啊，我们会用到几点合并，和我们之前所用所讲解过的data分当中，一些常规的新操作。



![](img/0f485c9903ae290f08f0ff9b4aca74f5_87.png)

OK吧好。