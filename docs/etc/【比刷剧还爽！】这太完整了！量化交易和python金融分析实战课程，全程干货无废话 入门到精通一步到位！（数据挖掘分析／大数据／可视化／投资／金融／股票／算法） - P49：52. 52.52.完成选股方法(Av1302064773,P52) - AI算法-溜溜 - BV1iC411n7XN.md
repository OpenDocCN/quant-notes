# 【比刷剧还爽！】这太完整了！量化交易和python金融分析实战课程，全程干货无废话 入门到精通一步到位！（数据挖掘分析／大数据／可视化／投资／金融／股票／算法） - P49：52. 52.52.完成选股方法(Av1302064773,P52) - AI算法-溜溜 - BV1iC411n7XN

![](img/36e3ba5736a8fdc63249bdef9e244e5e_0.png)

接下来咱们来把这两张表给它做一个拼接操作，让我们写一下这块呢我们要做一个拼接操作。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_2.png)

pr操作，就是啊用一个data frame去转另外一个data frame。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_4.png)

就完事了，咱们把这个复制一下，就是让我们这个down，然后呢我说他点啊，然后去转一下传当中啊，把我们第二节frame给它传进来，这就行了好了。



![](img/36e3ba5736a8fdc63249bdef9e244e5e_6.png)

现在我们把两个data frame已经拼接起来了，那我们给它起个新的名字了，现在在这个data frame当中。



![](img/36e3ba5736a8fdc63249bdef9e244e5e_8.png)

我们要做的其实上就是一个排名操作吧。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_10.png)

好了，我指定名字叫做一个电弧状就可以好了，现在呢我们已经有了一个代表了，但是这个代表当中啊，还没有咱们这些排名的信息吧。



![](img/36e3ba5736a8fdc63249bdef9e244e5e_12.png)

在这块我说我新建一个列啊，新建一个列，这个当中呢就叫做哎咱们现在排名的一个结果。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_14.png)

我叫做一个得分值吧，暂时先让这个得分值吧。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_16.png)

它是一个都是零的，然后呢我们把这个得分值实际啊给它计算出来。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_18.png)

在这里啊我们就是哎这给我提示什么东西。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_20.png)

这一块我们传进来的就是哦指定好，南派点ZS当中，你矩阵的一个维度。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_22.png)

我们指定成一个300×1的就行了，这块就是一共有多少样本数据。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_24.png)

然后接下来再写一个一，把这一列数据给它构建出来，那好了。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_26.png)

现在我们这一列已经构建出来了，但是这一列里面的数据啊全是一的啊。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_28.png)

我们得写一下这块呢我们要去计算总分，计算总分。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_30.png)

然后并排序，现在呢我们每一个指标分都有了是吧，那接下来我要把这些指标的分啊，给它合在一起了好了，把它们计算一起计算一起啊。



![](img/36e3ba5736a8fdc63249bdef9e244e5e_32.png)

其实上我需要什么，就是唉我看一下当前比如说咱这六个指标嘛。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_34.png)

六个指标做一个加法，算一个求和操作，这就完事了吧，好了，咱们写一下这块，我看不上一下，然后呢接下来我说把这个横着的，把它们其中一个一个的全部加到一起行吧，加到一起，我说我取最后的一个总和，这就完事儿了。

然后呢，接下来我再对这个总和干什么，做一个排序的操作吧。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_36.png)

好这里我说要做一个SVALUES，做一个排序，排序当中啊。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_38.png)

现在唉你告诉我你要去拜哪个指标了，那既然我们已经排到一起了，那最后排序完之后，com算完之后，咱得到什么scar，里边就是前面所有的累加吧，好了，把这个scar拿过来就行了，然后呢我们希望这个排序啊。



![](img/36e3ba5736a8fdc63249bdef9e244e5e_40.png)

它是升序还是降序，应该是一个降序吧，因为我们现在我们要找的什么排名最。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_42.png)

就是分数最高的唉这些结果吧，所以说咱们指定成一个false。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_44.png)

我们要做一个降序好了就完事了，做完相遇之后。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_46.png)

现在我说给他一个返回值吧，这个就是我的一个the frame啊。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_48.png)

把这个返回值咱们给它做出来了行了，那现在我们已经得到了总分的一个结果，那接下来啊把这个东西直接叫做一个啊，这个其实我们不需要其他指标。



![](img/36e3ba5736a8fdc63249bdef9e244e5e_50.png)

我们只需要什么，只需要它这个scars值就行了，把其中的一列拿过来好了，这一列这是一个呃，就是一个series，在这个series当中我们取了某一列这个列达了之后。



![](img/36e3ba5736a8fdc63249bdef9e244e5e_52.png)

接下来我说哦，你做一个返回吧，返回什么哎。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_54.png)

我们返回的是前十名那个得分啊，还是前十名那个股票啊，我们要选的是前十名的股票吧，就在这里我们要把他的index也就是股票给拿到手。



![](img/36e3ba5736a8fdc63249bdef9e244e5e_56.png)

并且呢给他to list一下，在这里我再取吧。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_58.png)

取一个前十，那就是从0~10，哎这就完事了，这样我们就完成了。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_60.png)

咱们当前就是呃get stars当中咱们的基本操作了。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_62.png)

相当于啊，哦第一步我们是去啊读我们的因子数据，端点数据之后呢。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_64.png)

对应的数据啊，我们做做一个打分操作，把最终打分结果我说拼接起来。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_66.png)

最终呢咱再完成一个排序，那现在他返回结果就是啊。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_68.png)

我my guest DOS当中你执行一次，我们现在就你返回哎呀，当前啊就是当前某一天的啊。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_70.png)

当前这些指标，然后他具体的前十是谁。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_72.png)

我们就做完了吧，好了，这里我们的最关键的一个函数已经做完了，就是怎么样获取诶当前我的前十诶。

![](img/36e3ba5736a8fdc63249bdef9e244e5e_74.png)