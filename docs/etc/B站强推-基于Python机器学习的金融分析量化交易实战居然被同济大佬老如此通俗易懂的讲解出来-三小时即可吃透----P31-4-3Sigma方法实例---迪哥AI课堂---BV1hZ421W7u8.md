# B站强推！基于Python机器学习的金融分析量化交易实战居然被同济大佬老如此通俗易懂的讲解出来，三小时即可吃透！ - P31：4-3Sigma方法实例 - 迪哥AI课堂 - BV1hZ421W7u8

最后啊咱们来说去一日当中啊，还有一个叫3SA方法，它的原理非常简单啊，大家先来看这张图，这张图当中你看我们画了个什么，那大家可能一眼就看出来了，我画了一个正态分布吧，正态分布啊。

如果大家理解起来比较麻烦，你就当做是一个正常的分布，什么叫正常分布啊，我以前讲机器学习当中经常举几个例子，我说你啊现在上银行贷款，银行啊，就是多借给你个三块五块的，那是不是挺正常啊，多借你10万8万的。

少借你10万8万的，是不是就不正常了呀，咱们来看这样一个走势啊，这里我说我先画一条线，那咱们就拿标准正态分布来说吧，标准人家分布当中啊，这是什么，这里有个均值，均值是什么零，什么意思啊。

比如现在我要干一件事儿，哎我这一个误差吧，就让我去去银行贷款，他可能多借有钱也可能少借我钱吧，那多就有钱，那往右边点少借有钱往左边点，但是但是大家来看哦，我们现在这个区间来说呀。

比如说你看我现在画的第一个区间红色，我现在阴影画出一个区间，你看它的面积怎么样，是不是相对来说会比较大一些呀，代表着这些个事发生的可能性会比较高吧，那你看当我把这个区间越往外放的时候。

你说这个可能性发生的概率怎么样了，是不是就越低了呀，那来想一想，我们现在要干什么，是不是要做一个去极值的问题啊，那极值它可能落到哪啊，我拿这个红色来画，落到这可能吗，这块落的你说能是极值吗。

在均值附近了，大概率发生的事，那就是正常的数据吧，均值一般落哪儿啊，落在比较偏远的地方吧，这一块这一块这一块这些个地方越远的，离均值越远的，偏差越大的，越有可能是一些离群点吧，哎这样一件事。

那什么叫做一个三倍的西格玛啊，它是这样一件事。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_1.png)

你看这里啊，我们画的这个东西当中有什么，哎这有一个X哎它的均值是吧，加上一倍的减去一倍的，加上减去两倍的，加上两倍的，减去三倍的，加上三倍的，那你看从这个区间当中哎我们能发现一件事。

你看啊一旦你这个区间选的越大的，你看加减三倍的，你得到数据它越往左右偏的可能性会怎么样，就越小了吧，那这个三西格玛意思是这样，我说我现在啊做这样一份数据啊，原数据来了。

然后我假设吧就是可以对数据做一些变换，使得它理论上服从这个高斯分布啊，或者正态分布，哎咱们先不知道怎么变的，就假设它就是正态分布的一个规则，那你看当我指定一个正负的三倍随维码的时候。

你说这个当中啊包含了百分之多少数据，这个值已经给大家列出来了，这是统计当中啊，咱们经常会定的指标90。7%多吧，那好了，我们现在发现一件事，哎呦如果我认为数据当中啊，我想取最正常的九十九十九。7%的诶。

当做我的数据，剩下0。3%的，我当做一个极值给它规范一下，是不是可以啊，这个就叫做一个三西格玛啊，相当于你的一个下限和你的一个上限谁来定的，在高斯分布当中啊，你要算两个值，告诉我一个均值是多少，诶。

告诉我你的一个标准差是多少，是不就行了，咱就能把这个上限和这个下限全部计算出来了。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_3.png)

好了，这个叫做一个3SA方法写一下吧，其实也很简单哦，在这里名字跟之前一样吧，还是做一个复制呃，在这里我们做个复制，然后把最后面那个值吧，改成一个三西格玛就行了。



![](img/bc98878f896a8b5b26cd1a36afdb9db2_5.png)

然后这一块我们输入的值啊，这块NV等于三吧，既然你说三，咱就写个三得了。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_7.png)

然后这块咱来写吧，我们要需要算什么哎，在整个数据当中，这一列数据，我是不是得知道当前它的均值是多少，当前这个S这个标准差是多少啊，所以说对我的数据我可以算两个值哎，一个是点min。



![](img/bc98878f896a8b5b26cd1a36afdb9db2_9.png)

第二呢就是一个啊，直接复制吧，直接第二个就它就是一个点s std，这个它就是一个点s std，算它的一个标准差行了，那我们指定两个变量吧，变量名字就是一个面，然后下面的它就是一个STD行了。



![](img/bc98878f896a8b5b26cd1a36afdb9db2_11.png)

前两个指标我算出来了，有两个两个指标之后，接下来那都复制就行了。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_13.png)

这也不用自己去写了，把这个东西给它复制过来好啦，这复制过来了，那你看中间等于什么一个均值，加上我N倍的一个STD吧，那下面呢就是我的一个均值，减去咱N倍的一个s std，是不就行了。

那返回值这是一个series，然后我的一个下限，我的一个上限咱们指定出来是不是就完事了。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_15.png)

非常简单吧，咱又完成了这样一个3C嘛。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_17.png)

哎这个函数呃，执行一下就是得到这个西格玛等于什么呢，等于我的这个数据当中，然后把我当前这个data啊。



![](img/bc98878f896a8b5b26cd1a36afdb9db2_19.png)

我的这一列传进来，然后N值N值我不用写了，N值哦，这个数据咱写一下吧。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_21.png)

这个数据你要画这个90。7%啊，画的太不明显了，咱画个稍微明显的。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_23.png)

你看贼明显，68。3，这个挺明显，是不是咱取68。3%的。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_25.png)

当做正常的，超出这个范围的当不正常的，那我写个一吧，假设我N等于个一。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_27.png)

然后我们执行一下，然后来画下这个图，简单来看一看它的一个大概取值的一个位置。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_29.png)

这是一个这个码执行一下吧，你看这是大概的一个位置。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_31.png)

我们是不是算出来了，可能通过啊，就是就是大家整体来看这个图就是绿色线啊。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_33.png)

都是不会去变的，然后这个蓝色线啊可能在不同任务当中，你看这里边可能等于60左右。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_35.png)

然后这个里边可能等于不到50，然后这种方法可能等于50多一点，可能不同方法咱得到的结果略微有一些差异啊。



![](img/bc98878f896a8b5b26cd1a36afdb9db2_37.png)

当然就是用哪种方法啊都行，看你的一个实际任务需求吧，这也相当于是预处理方法当中的，不同的几种策略吧，啊，到时候大家都可以我们自己来去做一些实验的。



![](img/bc98878f896a8b5b26cd1a36afdb9db2_39.png)

主要就是三种吧，我给大家说完了，我们的第一步叫什么。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_41.png)

叫做一个哎一个去极值，注意点啊，这个去极值不是给它丢掉。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_43.png)

而是给它做一些规范，定义好一个下界和一个上界，然后呢，让所有数值保持在我们指定好的，下界和上界当中。

![](img/bc98878f896a8b5b26cd1a36afdb9db2_45.png)

这就行了，这个是我们三步走当中啊。