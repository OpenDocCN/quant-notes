# python量化8：自动化价格突破检测 - P1 - LuQuant - BV1RA4m1P7sN

大家好，欢迎今天再次到来。我们将了解如何使用突破指标自动检测价格突破。我们将在本视频中使用pyython进行编码。因此，如果您喜欢编码实验，可以从模式下方描述中的链接下载源代码。我们正。😊。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_1.png)

寻找的是以下内容，我们需要我们正在交易的资产在相同的价格水平上反弹多次。为了这个演示，我们只说三倍三反弹，所以我们将反弹水平记录为阻力位或支撑取决。价格变动的方向。然后我们的算法将观察价格变动。

测试是否有突破高于或低于检测到的关键水平。如果是这种情况，那么我们会在突破反弹或突破的方向上生成突破信号，价格的书轴。不必完全处于同一价格水平。事实上，现实中很少有像我们在本历中看到的那样完美的对齐。

大多数时候必反弹价格会徘徊围绕平均关键级别稍高一点和稍低一点。这样我。就可以定义一个关键区域，而不是精确的级别。在我们的代码中，我们还将考虑区域的宽度，并将其作为变量包含在内，以便我们可以对其进行调整。

根据需要对其进行实验，并以数字方式检查其对我们的交易指标的影。如果蜡烛收盘价高于看涨突破模式中的上区域边缘，而收于看跌设置中的下区域边缘下方则检测到突破。此事例显示了典型的阻力区域设置。对称设置中。

当价格在较低水平上反弹时，最后一根蜡烛出现看涨突破，我们可以定义一个支撑区域，并且我们正在寻找看跌方向的突破，表明下降趋势的延续。我们也可以在以下情况中使用此模式检测与移动平均线等其他指标相结。因此。

如果该模式出现在移动平均线上方，则表明市场处于上升趋势，看涨突破是一个潜在信号，表明趋势已对称的上升势头延续。我们可以应用此组合也处。相反的方向，其中，价格交易低于移动平均线，并且突破支撑区下方。

表明潜在的下降趋势延续。实际上，当我们对此进行编码时，我们需要考虑一个缺口窗口，以避免前瞻偏差。因此如。我们正在测试最后一根蜡烛，以了解它是否带有突破信号，我们停止检测数轴蜡烛。

并且我们避免测试超出绿色缺口窗口早期边缘的支撑位和阻力位。我们还考虑了后蜡烛窗。

![](img/9652b49ca12f3d5d2d0c0d522f634faa_3.png)

其中，我们将寻找书轴蜡烛以及支撑位和阻力位。因此回顾一下，我们有缺口窗口，我们有后蜡烛窗口，我们寻找在某个区域内对齐的三个书轴点，区域区域的宽度是我们算法的一个参。因此，每当检测到设置时。

我们就可以调整它并研究不同的情况。我们等待另一根蜡烛突破并收盘于关键区域边缘之上或之下。因此，我们像往常一样，根据趋势方向生成看涨或看跌信号将。pyython编写所有这些内容。

以便我们可以自动化整个过程。所以现在让我们浏览一下代码，看看它在第一个单元格中如何工作。我们正在加载数据。所以在这个视频中，我使用了1个CSV文件。我们刚刚从CSP下载了，这是欧元美元。😊。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_5.png)

小时时间范围，这是2003年到2023年之间的出价。所以我们有20年的数据，我们正在过滤蜡烛，其中交易量为0，所以这些是我们没有任何交易的蜡烛，市场上有任何变动，我们正在重置。

我们正在添加指数移动平均线，以防万一在某个时候需要它，然后我们可以打印尾部。如果需要的话，只是为了检查我们是否现在我们的数据已正确加载，我将数据针的一小部分切分为5000根蜡烛，以便能。😡。

更有效的运行代码。然后当我们的函数正确运行时，我们可以运行整个数据帧。因此，在该视频中，我们没有使用此功能，但如果您需要进行实验，并将当前指标语一。平均线结合起来，我已将其保留在这里。

所以基本上在该单元格中，我们可以生成指数移动平均线信号，我们将使用该信号在我们的数据框中添加一个星链，它将测试最后15根蜡烛是否位于移动平均区线上方。在这种情况下，我们有看。😊。

信号和上升趋势以及这些蜡烛是否位于移动平均区线下方。如果我们有下降趋势，那么我们返回疑惑M信号将等于一。然后我们需要检测输轴点或输轴蜡。为此，我使用一个名为SPfi的函数。

因此它将测试当前蜡烛或任何作为窗口内参数提供的蜡烛，因此要成为书轴。我们需要测试该蜡烛是否高于或高于其所。邻居或者低于其所有邻居，因此它要么是高书轴，要么是低书轴，如果蜡烛是一个书轴高位。

因此它比左侧和右侧的所有邻居都高。因此在蜡烛之前和在蜡烛之后，那么它是一个书。高位，因此我们在这里返回书轴高位，它等于一，并且如果这是我们返回书轴低点的低点，它等于2。因此我们根据书轴的类型返回一或2。

在任何其他情况下，我们返回零，因为我们没有任何性。所以现在我们可以运行这个函数来测试数据真的蜡烛图，我正在考虑使用时的窗口。因此，如果一根蜡烛图的高度高于其左侧邻居的10个和右侧的10个。

则它被认为是一个书轴高。对称如果左侧低于10个蜡烛，右侧低于10个蜡烛，则我们可以考虑书轴低点。每当我们有由函数piVt生成的这些信号时，我们可以将它们保存到数据框中，作为新列，称为pit让。

我们定一点位置，这样以防万一书轴信号等于2，我们放置一个点，我们为低于当前蜡烛的低价或当前蜡烛的低纬的点生成一个位置蜡烛。如果它是书轴高点，我们会。当前蜡烛上方放置一个点，这只是为了可视化蜡烛。

这就是我们得到的。所以每当我们截取数据框的切片时，我们都会使用pult global绘制蜡烛对象。我们添加刚刚使用此单元格生成的那些点，这样我们就可以确。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_7.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_8.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_9.png)

我们的算法在哪里检测这些这些书轴蜡烛，正如我们所看到的，我们这里有这个书轴蜡烛，我们有这个这个这个这个到目前为止，在这个算法中都是很好的信号。现在我们需要检。😡。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_11.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_12.png)

突破的结构。为此，我们定义这个函数称为检测结构，它需要一个蜡烛索引，后面的蜡烛数量和窗口数量，我们需要避免的间隙窗口。我们需要包含它以避免前瞻偏差。所以。😡，在这里留下了评论。

窗口值应该始终大于书轴窗口。并且我们之前在这里使用过书轴窗口检测这些书轴点。所以IAP我们使用了十0，所以这里的窗口等于10。所以如。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_14.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_15.png)

我们在这里使用了时，我们需要使用大于食的东西，我们需要小心。我们需要为了不惜一切代价，避免看起来阿耗不偏差。如果蜡烛小于后面的蜡烛加上窗口，那么这。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_17.png)

数据真开头的哟，那么我们返回零，同时这是我们到达末尾的另一个边缘情况。数据框的右侧。因此，我们在蜡烛右侧不再有任何蜡烛来检测它是否是书轴，然后我们可以停止分。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_19.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_20.png)

返回零，否则我们可以继续。因此我们正在创建一个本地数据框，这是当前蜡烛减去后面的蜡烛减去，直到当前蜡烛减去窗口的窗口，这是我们包含缺口窗口的地方，以避免前瞻偏差。因此我们。

数据框的一部分与相对于当前蜡烛的位置，然后我们计算高点，这是我们采用的输轴点，最后三个低点也是如此。所以这些是低输轴点，我们采用最后三个点，我们定。水平突破变量区域宽度在本利中为欧元美元为10到-3。

如果您使用不同的资产，或者即使您在不同时间使用欧元美元，您可能需要更改，但您可能还想更改。框架因为当您查看不同的时间框架时，区域可能会发生变化。因此，现在如果我们有三个低数轴。

我们认为在这种情况下支撑条件等于true。因为我们有三个低点和平均低点，意味着低点的平均价。等于低点平均值。对于这些低点的每个点。

我们正在检查我们正在测试的当前低点与所有低点的平均值之间的距离的绝对差是否高于区域宽度。在这种情况下，我们没。支撑条件。因此我们有三个低点，但他们没有充分对齐，无法认为他们正在形成支撑位或支撑位。

请记住，在这种情况下要形成支撑位，我们需要三个低数轴。但他们也需要以某种方式在一个支撑位内对其某些区域宽度。如果它们高于或低于区域宽度，那么我们不能将它们视为有效的支撑区域，这就是我们放弃这个的原因。

这就是我们放弃支撑条件等于fill的地方。所以我。不替有支撑条件。然后如果我们有支撑条件，如果支撑条件仍然为真，那么我们现在就跳出for循环。因为我们从支撑条件等于 truee开始，同时平均低。

减去当前蜡烛的收盘价价格高于区域宽度时间2。换句话说，如果当前蜡烛收盘价低于我们检测到的关键区域的平均值或中心值一定距离汲取。宽度时间2，在这种情况下，我们有一个水平在看跌方向上检测到的突破。

这就是为什么它在相反方向上等于一它是对称的。所以我们需要高点，我们需要一个等于出路的阻力条件。我们检。高点的平均值以及每个高点的平均值高点，只是为了确保这些形成有效的阻力位。

我们将检查它们是否全部在特定区域宽度内对齐。如果不是我们返回false，因此阻力条件为假，我们会突破。万一我们有一个阻力，我们正在查看当前蜡烛的收盘价，减去阻力位的平均值或中心值。

这个差值应该大于区域宽度时间2。在这种情况下，我们的水平突破等于2。所以这。看涨突破，此函数将返回水平突破，因此，只要为检测到这些条件，水平突破就等于0。但当检测到其中一个条件时。

在我们的任何其他情况下，它要么是看跌突破，要么是看涨突。现在我们将得到零回报，我们可以运行这个函数来生成信号，突破信号。并且我们在数据帧中名为检测到的模式的新列中对结果进行评分。

所以我使用等于60的反向蜡烛，我使用了窗口，这里等于9。所以。应该可能是11，这更安全。我将从数据框中过滤列。其中我们检测到不同于零的模式，所以我们在这里有它，所以我们有一根蜡烛40878889。

所以我们可以看到。模式与实际检测到的三个连续蜡烛图的模式相同。我们通常采用第一根蜡烛图，因为这是我们最早检测到此信号的信号，让我们返回并可视化蜡烛图4087。因此它不在这里。我们。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_22.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_23.png)

选择此信号假设4000点。那么当我们可视化这一点时，我们谈论的是4087点。因此我们可以看到这里检测到了三个高点，我们有一个阻力位，如您所见。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_25.png)

在该蜡烛上被突破，请注意，当这之后发生的情况，这里检测到4087蜡烛，只是为了确保我们谈论的是同一根蜡烛，它是4087式的。所以。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_27.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_28.png)

检测到这一蜡烛时，请注意价格继续处于上升趋势。因为我们目前在向上方向有突破指标运行良好。我们可以说让我们检查另一个点，所以4372，这是这。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_30.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_31.png)

72、所以这个显然是下行方向的突破。所以我们总体上有一个下降趋势，我们有这三个点，尽管这两点非常非常棘手，因为这些可能是等于两根蜡烛的两个点。我。实际上不应该拥有这些，但在这种情况下没关系。

我们在向下方向上突破，所以它是看跌的，请注意价格回撤到完全相同的水平，并继续下跌，处于下降趋势方向。所以这也很好，让我们检。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_33.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_34.png)

第3个，我们不会检查所有这些，但很高兴看看它是否也适用于其他方向，让我们检查这个。因为我们有一个差距，这里在79和82之间，所以这是这个蜡烛，我不会说这是最好的信号。尽管这是另一。😊。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_36.png)

输轴点，但如果考虑到最后三个低输轴点，它与这三个输轴点相距甚远，这些不应该被视为一个输轴点支识级别，因为它们没有充分对齐，这个与其他的相距甚远，无论如何。😡。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_38.png)

你会看到他是如何工作的。我认为他或多或少工作的很好，我们可以在更宽的数据针切片上运行它。在这种情况下，我们需要一万再次运行函数，将需要更多的时间。因为现在我们有了更宽的数据针，现在我们可以看到我。😊。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_40.png)

有更多的信号让我们检查一下这个，例如5965800，比如说50到6000，所以596是这。

![](img/9652b49ca12f3d5d2d0c0d522f634faa_42.png)

看起来像是向下方向的良好突破，让我们检查一下，增加我们的切片，看看我们是否有三个支点。所以是的，他检测到了这个支撑位，所以考虑了第一次反弹。第二。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_44.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_45.png)

反弹第三次反弹，然后是突破下降方向和价格继续下降。所以它在这组数据上运行的非常好，让我们检查另一组数据。所以5000比方说79。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_47.png)

7800到8000，它将显示7903好吧，所以这里有点太多了，因为运动发生在一根蜡烛内，所以我们无法捕捉到这一趋势，它太快了，但我们仍然检测到。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_49.png)

一个阻力位，我们可以在这里看到最后三个竖轴点，因此它们充分对齐，我们可以看到它是一个阻力位良好的阻力位。我们在向上方向上突破了这个突破，这是一个很好的信号。我们无法抓住他，他发生的太快了。

也许如果我们开一个较短的时间框架，如果你仍然在，那就更好了。观看实情，不要忘记喜欢并订阅支持此频道。如果您有任何建议，请在评论中留下他们，我总是很高兴阅读您的来信并获得这些想法。但是对于这个视频，这就。

😡。

![](img/9652b49ca12f3d5d2d0c0d522f634faa_51.png)

我今天要告诉您的全部内容，我们的指标运行良好，我很满意，我们可以将其纳入我们的任何策略中，直到我们下一次安全交易，下次再。😊。



![](img/9652b49ca12f3d5d2d0c0d522f634faa_53.png)

![](img/9652b49ca12f3d5d2d0c0d522f634faa_54.png)