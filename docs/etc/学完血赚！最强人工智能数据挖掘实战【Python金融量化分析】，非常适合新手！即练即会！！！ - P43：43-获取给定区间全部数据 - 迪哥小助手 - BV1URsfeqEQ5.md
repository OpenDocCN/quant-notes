# 学完血赚！最强人工智能数据挖掘实战【Python金融量化分析】，非常适合新手！即练即会！！！ - P43：43-获取给定区间全部数据 - 迪哥小助手 - BV1URsfeqEQ5

咱写一想啊，是不是说现在哎你的一个日期，它是一个序列，然后你会查其中一天，那你会查其中一天。那每一天，那说白了咱写个复循环呗，OI一转一下。😊，乱是什么，咱们当前就看一看一共我是有多少天就行了。好了。

你这个序列，你不是有这么多天吗？看你这个呃日期呢，日期在上面看下日期一共多长，那相当于是有多少天吧，便利其中呢我的每一天数据。然后呢对我每天数据我都要干什么，都要去获取一下当前它的一个值吧。好了。

我这块直接复制就行。对于每一天数据，我都要获取它的一个值呃，只不过这回这回这里边它就是不是传一个零了，而是传什么，应哎不是啊应该是传一个I是吧？获取它第I天实际的一个值。然后它的值来说。

它返回的是一个三维的，我不需要还是IOC一下。😊。

![](img/cd6a9b8084abe0f97bb14664ea4582c5_1.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_2.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_3.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_4.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_5.png)

LOC当中啊第一个指标就是一个0，然后第二个也是0，然后第三个指标取全部啊，因为有用的全在第三指标当中嘛。刚才这个ship值属给大家打印来看了，这样我就能取到当前哎它的就是每一天它的一个数据了。那行了。

那取完每一天的数据之后，那我最后啊你不能只把每一天的告诉我，你是不是要做一个汇总啊，我希望可能这样。

![](img/cd6a9b8084abe0f97bb14664ea4582c5_7.png)

我做一个数据啊，我是这样呃，第一个维度啊，它是一个日期啊，代表它是哪一天，比如2019年3月8号。然后第二指标第二指标可能是它的一个股票的一个名字是吧？然后第三个指标可能是它的一个实际指标值。

一个value到底是等于多少呢？那我是不是说我得构建一个新的大点data frame。然后呢，我这里读完每一天数据之后，把每一天数据，把每一天数据拼接到哪啊。

拼接到我当前组成的一个整体的一个data frame当中嘛，fes，然后呃fes的一个da吧？

![](img/cd6a9b8084abe0f97bb14664ea4582c5_9.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_10.png)

等一下呃，新建一个dta frame，一会儿呢咱拿这个d framework往里去传数据啊，我说先构建一个，这个就是总的啊，就是一个总表吧。啊，然后这个就是一个每天的啊每天的数据。好了。

那现在我们已经有了一个每天数据。然后呢，在这里哎我们先给它指定一个列名吧。在这里我说我现在也是重新的去创建一个daate frame嘛，然后一会儿对data frame进行一个拼接操作。好了。

我说当前我的一个data啊，等于一个新建一个da frame。

![](img/cd6a9b8084abe0f97bb14664ea4582c5_12.png)

新建一个d frame。然后在我当前的date frame当中啊，我看一看当前pas当中呃，pa当中，我直接把d frame导进来了吧。所以说在这里可以直接去用啊，在创建一个新的d frame。

然后呢我就把啊实际它的一个值哎，给它传进去就行了。然后这个给它起个名字吧，它就是一个d frame了，不是这么一列数了啊。行了，咱们现在有了一列值了，有一列值还没完，还有什么，再得给它起个名字。

这个列啊，你得告诉我它叫什么名字是吧？咱们自己来起一个啊，呃，起什么名都行，我们来起一个。😊。

![](img/cd6a9b8084abe0f97bb14664ea4582c5_14.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_15.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_16.png)

等于啊它的一个名字传进去，它就是哎这个factor，它的一个实际指标值等于多少吧。好了，这样我们现在创建一d frame当中只有一列数据，哎，我们来给它起了一列名字。

那我们刚才说啊就是在这个d frame当中啊，哎呀，你不光定个值。你是不是还有得有一些日期的一些信息啊。好了，我说这样你再新加一列吧，新加一列，我说指定名字就是一个日期。



![](img/cd6a9b8084abe0f97bb14664ea4582c5_18.png)

日期等于什么？在这里哎，你说我们现在有没有它是哪一天啊，是不是当前遍利到第I天了，我把DI天数据加进去是不是行了？这样我现在构建了一个哎就是每一次循环当中。

我都会构建一个d frame这个d frame有两列，一列呢就是我的一个日期，一列就是它的一个value值啊，咱们也有了吧。好了，那我说我现在啊哎呀有了所有的操作了。

那我那我视频应该怎么样把这些个数据做一个拼接操作，怎么拼接你复循环每一次都得到一个新的d frame，你是不把每个da frame放到这个总表当中啊，最后我要的是什么？就是这样一个总表吧。好了。

咱来执行拼接操作。😊。

![](img/cd6a9b8084abe0f97bb14664ea4582c5_20.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_21.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_22.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_23.png)

点conct一下呃，拼接拼接当中啊，你需要传建参数，谁跟谁拼呢？好了，先把咱们呃最开始啊我说我构建的一个data词啊，拼到我的个总表当中，把谁拼上去呢？

咱刚才啊是不是自己哎我构建了一个data framework，把咱们当下这个da framework给构进去，我说拼接成啊拼接到总表中吧。



![](img/cd6a9b8084abe0f97bb14664ea4582c5_25.png)

行了，这就是执行一个拼接操作。呃，我们先执行一下，看没有什么问题啊。这一块的速度啊肯定会比较慢啊。因为这里它是咱们先指定什么，我们是指定了一个呃时间间隔，是有这么一年吧。

19年1月1号到这个20年1月1号，时间间隔会比较久。所以说它的速度啊相对来说会比较慢啊，到时候大家自己玩的时候啊，要不就没没有说完，就行了，没有后化了啊，大家自己玩的时候也不用了，也不用再改小了。

一年这个时间挺快的，很快就出来了。😊。

![](img/cd6a9b8084abe0f97bb14664ea4582c5_27.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_28.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_29.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_30.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_31.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_32.png)

好了，说完之后，咱打印一下当前headd看看跟我想要的是不是一样的啊。哎呦这个这个当中总表来说有点问题。咱来检查一下这一块拼接完哎，拼接完之后，咱疏忽了一点什么。

这个表实际是不是啥也没有我这个拼接完就是光拼了，怎么样，没复值吧，咱们是不是重新复值啊，要不然相当于这个表始终没东西吧，这不行，咱再来再重新执行一下啊，这回重新执行完之后。

咱再点ha看一看当前啊我们的一个表当中是不是按照我的一个想要的，有我的一个日期啊，然后有它实际指标的一个值，然后还你还得还得有什么，还得这还得有当前这个股票它是什么吧，我们需要这几个指标来看一看。😊。



![](img/cd6a9b8084abe0f97bb14664ea4582c5_34.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_35.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_36.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_37.png)

呃，稍微再等几秒啊，咱们就哎来执行一下。好了，你看一下这些是不是我们想要的股票啊，它具具体是什么，不管了，它的一个值是为有了，它的一个日期是为有了。这样是咱们现在完成第一步，哎。

把我们这一个数据啊全部给它取出来了。取的过程当中啊，其实挺麻烦的，但是也没什么好办法，你不能就是有汉卓自动一天一天给你执行。所以说咱必须得自己完成这样一个操作，把数据取出来了。😊。



![](img/cd6a9b8084abe0f97bb14664ea4582c5_39.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_40.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_41.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_42.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_43.png)

![](img/cd6a9b8084abe0f97bb14664ea4582c5_44.png)