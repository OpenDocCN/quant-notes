# 【比刷剧还爽！】这太完整了！量化交易和python金融分析实战课程，全程干货无废话 入门到精通一步到位！（数据挖掘分析／大数据／可视化／投资／金融／股票／算法） - P28：30. 30.30.Mad法去极值演示(Av1302064773,P30) - AI算法-溜溜 - BV1iC411n7XN

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_0.png)

接下来咱们来说唉我们的聚集值当中，第二种方法叫做MAD MAD啊。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_2.png)

给大家的感觉像是公式上稍微复杂，其实计算起来也蛮简单的。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_4.png)

给大家先来看一下吧，首先啊他有这个要求，就是要求我们啊先算出来这样一个MAD值诶，就是跟他名字其实是一样的，他是这个操作，咱们先来看一看啊，首先啊我说我先拿到了一个序列哲学当中，比如说什么123。

然后四点点点点一堆数是吧，我们对这个序列可以算一个中位数吧，好了，比如这里我算中位数，它等于四啊，后面还有567之类的，现在呢我算是中间数等于四之后，然后干什么，对于我们当前这个学习当中每一个数。

那这块有这个一是吧，好那我算1-4哎，注意点，这里我们是没有负号的，外面有什么一个绝对值吧，你看这点它都是有绝对值，所以这块我们算的是一个绝对值差，好用我的每个数减去中位数，能算出来绝对绝对值差吧。

比如第一个它等于三，然后第二个算等于二，第三个等于一把这些啊这零二，然后这里就无所谓了，然后接下来再把其他的都算完之后，我又形成了什么，又形成这样一个序列吧，对这个序列在干什么。

再求一下它的一个中位数啊。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_6.png)

相当于这东西总感觉是绕了两遍啊。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_8.png)

为了求诶咱们当前的一个范围，我说现在啊我一开始先对我数据求了中位数，然后呢对每一个数据减去当前中位数，得到一个新的序列吧，但这个序列都是正的，因为这块绝对值再求它的一个中位数，也能求出来是什么。

是不是一个值啊，那好了，有了这个MAD值之后呢，我说我这样，现在你不是想对这个数据来做一些，规范的操作吗，我说这样吧，我说这个数据啊，这是一个哦数据对于这个数据来说呀，如果说你看这块这公式当中做什么。

做了一个判断吧，如果说呀这个原始的数据当中唉，比如说一个中位数加上N倍的一个MAD值，以及减去一个N倍的MAD值，比如这里我说这个是数据数据当中，这块是它的一个中位数加上了N倍MAD的值。

这一块是一个中位数减去了一个N倍的MAD值，把他俩当做我的一个下界和一个上界，是不是就可以了，然后正确操作就用刚才咱说的那个百分位的，是不一样啊，其实说白了就是怎么样去找这两个界限，然后这个N值。

N值通常情况下就是有一个固定取值啊，1。4826，关于这个MAD啊，大家就简单熟悉一下就行啊。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_10.png)

唉知道一下他大概是做一件事的就行，这里啊相当于我们是用另外一种方法啊。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_12.png)

来去干什么，来去对我的一个数据啊，做了一个去极值的一个操作，然后代码其实也挺简单的，咱们给大家简单写一写吧，就是按照咱们上面给大家写出公式，先算什么，先算这个MD值，然后再算我的一个上下键好了。



![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_14.png)

一个filter，这当中我们来指定，就是跟之前名字咱们是一样的吧。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_16.png)

跟之前的名字都是一样的，还有这东西，这东西最后我说叫做一个MAD可以了，这个叫做一个MAD，然后呢这一块咱们输入也是一样的，我传进来一个series，然后这一块需要传进另外一个参数，叫做一个NN是什么。

你看这里哎这一块不是有个N吗。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_18.png)

多少倍的MAD，咱们刚才是不是说了有个通常的取值吧。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_20.png)

哎咱们就咱不仅不认知了，一会儿咱们自己传进来一个值，然后呢首先在我们这个函数当中啊。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_22.png)

第一步算什么，是不是我说我现在算的是一个中位数。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_24.png)

中位数等于我整个序列的中位数啊，好了，这是我的序列，中文数怎么算。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_26.png)

刚才咱们任务当中哎，这一块我说算的是什么来着。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_28.png)

幂是0。25max0。75，我传进两个才能帮我去算，我传进来个0。5。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_30.png)

讲道理他是不是也可以啊，还在这里我说点一下，把这个什么传进去，就传一个值为0。5，那就是一个中位数吧，好了现在我说我算出来了。



![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_32.png)

当前我的一个中位数，接下来呢咱要去做计算是用什么。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_34.png)

我序列当中每一个值，你看这里序列当中每一个值减去我中位数，再算一个绝对值吧，好这里这样，我说我序列当中每一个数啊，对于这个判断来说，一个序列减一个数，相当于这个序列当中的每一个数。

都会减咱当前这个中位数吧，好了剪完之后算什么，算一个a abs，我的一个绝对值是吧，把它绝对值给拿到手，然后呢对这个绝对值干什么。



![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_36.png)

绝对值，现在我得到的还是一个序列吧，对当前这个序列怎么样。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_38.png)

再求一下啊，它的一个中位数吧，那好了，我把它括起来，对当前整体的一个序列再求中位数，再求中位数，方法是不是还是一样的。



![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_40.png)

再求个中位数就完事了，然后呢，我说指定咱当前的一个范围吧。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_42.png)

我的一个啊最大还有一个最小写一下吧，我说啊咱们当前最大的一个范围等于啊，我当前算出来的这个中位数怎么样。



![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_44.png)

他应该加上，你看这块中位数加上N倍的MAD值吧。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_46.png)

好了，这里我说给他加上一个N乘上，我刚才算出来的结果哦，算出结果咱们还没起名字，这个名字就叫做一个得了，就叫MAD得了，把这个MAD拿过来乘上我N倍的这个结果吧，然后下面呢用我这个中位数怎么样。

减去我当前的这个结果是不是就行了好了。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_48.png)

这现在我们算作为一个上界。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_50.png)

还有一个下界了，那接下来呢哎你看这一块，咱之前return他这个结果给它就是相当于做规范吧。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_52.png)

好了，同样return大于这个结果，这是series，然后这个稍微改一改啊，这个就是我的一个最小的，然后呢第三个就是我的一个最大的。



![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_54.png)

是不是就完事了好了，这里咱们就写了一下，怎么样去算什么一个MAD值啊。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_56.png)

函数给大家列出来了，那好了，那现在咱们来执行一下吧，我说啊咱们当前这个结果我也叫MAD得了，然后等于执行一下这个函数，把这个函数给它复制过来，函数复制过来之后啊，然后我说把这个数据给他实际的传进去。

然后这个N值啊。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_58.png)

咱就用一个通常的数值来去执行一下就完事了。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_60.png)

然后大家如果想画图，这里可以这样，咱们再来画个图吧，简单画了，画图不是重点。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_62.png)

我随便画了MAD，点一下原始数据，点一下这个结果，咱是不是就有了这一块部分的大于了，我要等于这个蓝色的这一块部分小于了。



![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_64.png)

我要等于这个蓝色的啊，这个就是第二种方法，叫做一个MAD啊。

![](img/aef7d14194cd2f3e29b4cfe75fd22bf2_66.png)