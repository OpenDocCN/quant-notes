# 【比刷剧还爽！】这太完整了！量化交易和python金融分析实战课程，全程干货无废话 入门到精通一步到位！（数据挖掘分析／大数据／可视化／投资／金融／股票／算法） - P9：10. 10.10.指标相关情况分析(Av1302064773,P10) - AI算法-溜溜 - BV1iC411n7XN

![](img/176a31b2583f501dbbe85d036cbcc8f8_0.png)

接下来咱们来看一下这个回归分析啊，说白了就是我现在要看一下，变量之间有什么样的一个关系，或者说呢变量当中啊一些走势啊，一些呃，我们刚才说的一些增长率之间，有没有什么样的一个相互影响。

或者是相互的一些就是观点吧，咱们要做这样一件事，这里呢我给大家说一下我们的流程。

![](img/176a31b2583f501dbbe85d036cbcc8f8_2.png)

第一步咱们还是先选择两个指标啊，我们选一个FPS，还有一个VX，一个标普，还有一个可能系数呃，在这里我们第一步还是先把这两列给拿到手，就是我们现在有个data，之前不叫data2吗。

还是用这个data2吧，等于data2当中，把这两列的名字我直接拿过来得了啊，这两列是它的一个名字，然后这个名字哎呀，把这块稍微改一改，中间用逗号，然后名字我得给它引起来啊，这是第一个名字。

然后后面这是第二个名字，然后这个名字啊还得多做一件事，它那个原始数据当中啊，它是一个大写的，再改一改是一个大写的，然后这个它也是一个大写的。



![](img/176a31b2583f501dbbe85d036cbcc8f8_4.png)

然后把数据打印出来看一看，像我只拿这两个数据还行了。

![](img/176a31b2583f501dbbe85d036cbcc8f8_6.png)

因为我们只观察他两个之间的关系，其他的我就不用去看了好了。

![](img/176a31b2583f501dbbe85d036cbcc8f8_8.png)

在这里我们就做完了，就是第一步先把数据给读过来，然后数据读完之后，然后这个索引目目前也都是没问题的，咱直接来往下去做第一步啊。



![](img/176a31b2583f501dbbe85d036cbcc8f8_10.png)

你说我要去展示它们之间的一个关系，做这个关系啊，其实还挺简单的吧，最简单方法什么，直接在图当中，我们把这个结果给它画出来，是不是就完事了好了，咱们来画图啊，在这个data当中。



![](img/176a31b2583f501dbbe85d036cbcc8f8_12.png)

我们来看一下data里边，然后去plot一下pro当中，去把当前两个结果传下去是不行了，直接点plot一下，然后其实什么都不用写了。



![](img/176a31b2583f501dbbe85d036cbcc8f8_14.png)

直接一画这个结果是不是出来了，但是这个结果出来之后啊，有一个小问题。

![](img/176a31b2583f501dbbe85d036cbcc8f8_16.png)

如果说你现在你说给它放到一个图当中，好像看不出来一个趋势吧，所以这块咱们还是得把这个东西啊，给他soft close一下，soft当中放到我们两个图当中。



![](img/176a31b2583f501dbbe85d036cbcc8f8_18.png)

咱们来指定一下，然后呢我们执行一下吧，这样当前结果我们就给他画出来了吧。

![](img/176a31b2583f501dbbe85d036cbcc8f8_20.png)

行了，这是我们第一步，先把这个图哎我们已经给他画出来了，然后呢画完图之后，其实我们可以观察一下，那此时我们想看它这个鼠标好像挺难的，我一正常情况下，我们不是看这个关系，应该放到一个图当中吧。

但是一个图我又给他描述不出来，那怎么办呢，之前咱们就给大家说一种方法可以干什么，在一张图当中我可以诶既有一个左边的Y轴，我还可以再有右边这个Y轴，这样我可以把它放到一个坐标系当中。

而不是一个坐标系就放在一张图当中，但是呢他的结果哎会就是怎么说呢。

![](img/176a31b2583f501dbbe85d036cbcc8f8_22.png)

给大家来画一下吧，画一下应该会更清晰一点，这样我们把这个数据啊重新来去指定一下。

![](img/176a31b2583f501dbbe85d036cbcc8f8_24.png)

还是我们data这个数据，然后把这个多写个参数。

![](img/176a31b2583f501dbbe85d036cbcc8f8_26.png)

不光这回咱就不用这个SOLOSER，然后直接指定我的一个哦坐标轴，咱们之前不是说了吗，在这里我可以去构建两个坐标轴，第二个我指定一个Y，然后呢在这个Y当中啊，咱们来去写吧。

咱们的Y指定成它的一个列的名字。

![](img/176a31b2583f501dbbe85d036cbcc8f8_28.png)

这个名字我就拿第二个吧，我看第二谁啊，直接给他复制过来得了，指定好我的一个队的名字。

![](img/176a31b2583f501dbbe85d036cbcc8f8_30.png)

然后呢我再执行一下，再来看结果，这个结果你是不是大概能看出一点趋势了哦。

![](img/176a31b2583f501dbbe85d036cbcc8f8_32.png)

这个结果可能看的趋势不是特别明显是吧。

![](img/176a31b2583f501dbbe85d036cbcc8f8_34.png)

再这样吧，咱为了使得这个结果太明显一些诶，再画一画这个数据当中啊，你看它是从这个10年到18年，如果把8年数据化一起，那这个东西里边的点太多了，是不是变化太多了，咱把它稍微选一选吧。

只选择其中的一部分数据可以吧，比如说我只选择这么一年，或者只选择这么两年的一个数据，他之前不是已经把这个日期当做一个索引了吗。



![](img/176a31b2583f501dbbe85d036cbcc8f8_36.png)

我把这个数据读过来啊，格式我来复制一下，然后把这个格式复制过来，我们自己来选，比如现在我只是想选择这个到这个12年得了。



![](img/176a31b2583f501dbbe85d036cbcc8f8_38.png)

他是从这个10年开始，然后到这个12年年底吧，12月一个31号，然后呢我们再换一下这个图，看着有点小呃，把这个图稍微画的再大一点，或指定一个菲尔塞斯啊，指定一个比赛等于稍微大一点。



![](img/176a31b2583f501dbbe85d036cbcc8f8_40.png)

执行一下，看这它出现了一个报错啊。

![](img/176a31b2583f501dbbe85d036cbcc8f8_42.png)

在这里哦，点float一下，点float完之后还给我报错。

![](img/176a31b2583f501dbbe85d036cbcc8f8_44.png)

再来看一下什么问题啊，他说当前这个label诶。

![](img/176a31b2583f501dbbe85d036cbcc8f8_46.png)

这个当前这个东西它不是一个label啊，哦这块这块冒号完之后，他没有一个不是一个逗号，应该是它是一个区间啊。



![](img/176a31b2583f501dbbe85d036cbcc8f8_48.png)

我们取这样一个数据，刚才不该写个逗号，然后再执行一下行了，这回画出来了，那你看啊，现在我们选了两年的一个数据，我们的一个变化幅度是不是就清晰一点了，来观察一下吧，他们之间有什么结果，当这个SP指标啊。

我们来看一下，当它变化的时候，如果在在在这个蓝色当中啊，SPX你看哦它发生下降的时候，这个BS怎么样上升了吧，你看这里它发生下降的时候，这里呈现上升吧，这一块也是蓝色的下降，绿色上升，蓝色的下降。

绿色的上升，我们是不是可以通过画图啊，把这个结果观察出来啊，啊所以说最直接有效的方法。

![](img/176a31b2583f501dbbe85d036cbcc8f8_50.png)

直接去画画的过程当中啊，其实啊刚才我故意啊就是给大家多画了几步啊。

![](img/176a31b2583f501dbbe85d036cbcc8f8_52.png)

其实正常我直接把这一份代码写出来也行，但是呢我给大家说这样一件事。

![](img/176a31b2583f501dbbe85d036cbcc8f8_54.png)

画图啊从来都不是一蹴而就的啊，一般我们都先画一个最基本的。

![](img/176a31b2583f501dbbe85d036cbcc8f8_56.png)

然后看一看有什么问题，有了问题之后，我们再想诶怎么去改进一下。

![](img/176a31b2583f501dbbe85d036cbcc8f8_58.png)

再改进一下，能使得咱结果看起来更清晰一些吧，啊这是我们的第一种做法，直接去画这样一个图，那还有没有一些其他方法能帮我去做呢，唉刚才咱不是说了吗，我们要干什么。



![](img/176a31b2583f501dbbe85d036cbcc8f8_60.png)

我们可以去画当前的诶一个回归分析吧，做回归分析之前。

![](img/176a31b2583f501dbbe85d036cbcc8f8_62.png)

我们还得先把数据再处理一下，或者说呃先变数与数据了，我们先把第二个图再来画一画，其实这里不光可以画一个折线图，我们还可以画一个散点图是吧，画散点图的方法其实蛮多的诶，再来带领大家来举个例子。

比如说也这样啊，我说现在啊我说现在咱指定一个结果。

![](img/176a31b2583f501dbbe85d036cbcc8f8_64.png)

这个结果呢，咱们之前这个数据当中不是有这两列吗，哎记不记得咱之前说过一种方法算什么，我说算那个增加率的时候啊啊增长率的时候，咱们用NPLOG的时候，然后用数据去做了一个除法吧。

来咱把那个再写一下安排点到底下，然后呢，我之前好像用这个data比上什么，比上一个data点shift是吧，shift当中哎给他，我给他那个往下滑一天水就得了，然后再把这个结果打印出来。



![](img/176a31b2583f501dbbe85d036cbcc8f8_66.png)

这是我们当前的结果，然后给他点害得一下打印出来啊，这个结果就有了，那有机会之后呢，咱接下来那你说该怎么样，我去把它的一个相关性给它描述出来呢，或者说怎么样通过画图能够说呀。

让我更清晰地去观察到当前的这个结果当中啊，它各自变量的关系以及呢，比如说变量的一个分布关系，以及两两变量之间的关系呢，再把这个图啊给大家来画一下，其实画的方法非常简单啊。

呃咱用咱就直接用这个pandas来去做了，其实还有一些其他额外工具包，像saber之类的也能帮咱们去做啊，panda当中我直接去BT下哦，直播说他的API名字稍微变化啊，protein下pro当中啊。

我们要去选你要画什么样的图，这是两个数据吧，两两之间我看它的变化情况，不光折线图也可以，我用散点图是不是也行啊，这回咱们把这个散点图给大家画出来啊，mattress一下，在这个三角图当中啊。

它里边的一个参数相对来说比较多啊，第一个参数就是呃我们得写一下，你把哪个数据给我传进去是吧。

![](img/176a31b2583f501dbbe85d036cbcc8f8_68.png)

然后呢第二参数呃，因为散点图啊，是这样，如果说你的数据点特别密集，咱这个就属于数据点特别密集。

![](img/176a31b2583f501dbbe85d036cbcc8f8_70.png)

那肯定很多点可能都会重叠在一起，咱得指定什么一个透明度啊，别让太多的点重叠在一起啊，你指定一个透明度，然后呢接下来一会儿呢当咱们画的图啊，它是一个2×2的图啊。



![](img/176a31b2583f501dbbe85d036cbcc8f8_72.png)

然后呢它会有对角线在对角线当中啊，你可以去选啊，你是想画直方图还是想画一个kt plot和密度，估计咱这里先拿这个直方图给大家呃，描述一下就是我们的一个在对角线当中，你去自己写一下，你要画什么图啊。

现在大家可能说哎这个对角线是什么啊，不太了解，没关系啊，马上咱就给它画出来，然后呢这个直方图当中啊，呀你也得指定它的一个q words，Key words，就是说啊我们都会涉及到哪些个参数。

然后用字典的格式给传进来，对于直方图来说啊，你就得告诉我咱要做多少个并字，比如说啊做50个并字吧，平均的分成多少个块，分成多少个格，要做一个并字吧，最后咱指定一个这size，然后等于稍大的一个图就行了。

这个就是我们当前得到的一个解啊。

![](img/176a31b2583f501dbbe85d036cbcc8f8_74.png)

还没得到，这就是我们当前这个图我要去画一下，然后来执行一下好了。

![](img/176a31b2583f501dbbe85d036cbcc8f8_76.png)

执行完之后来看这个结果吧，刚才是不是说对角线了，这是不是对角线，对角线当中描述的就是呃一个图自己和自己，你看这里这是点SPX吧，这是点PS吧，所以说中间的这一块是谁啊，就是啊SP这个指标它的一个直方图。

直方图啊，其实呃有两种画法，不是两种画法吧，就这条线当中啊，大家可能现在看的是一个直方图诶，我知道什么意思，但是其实啊就是当我们画过程当中，还有一种图啊，是一个就是怎么说。



![](img/176a31b2583f501dbbe85d036cbcc8f8_78.png)

还有一种图画的更好看一点，给大家看一看，我直接复制一下，你把这个参数啊稍微改一改。

![](img/176a31b2583f501dbbe85d036cbcc8f8_80.png)

我改成一个KD，KD当中不需要这个参数了，然后再执行一下。

![](img/176a31b2583f501dbbe85d036cbcc8f8_82.png)

你看这个结果变成什么了，诶变成了一个很平滑的曲线吧。

![](img/176a31b2583f501dbbe85d036cbcc8f8_84.png)

这个叫核密度，估计他是怎么做的，呃大概的做法就是呃，其实他俩的一个趋势是一个类似的，你看当前这个趋势和这个直方图画出来，结果是类似的吧，其实他是这样的，就是把你当前这个图啊，啊这不是分成一个BS吗。

那你想如果你能分成1万个BS，或者说分的BS越多，你当前得到的这个曲线就接近于这个曲线，是不是会越光滑呀。



![](img/176a31b2583f501dbbe85d036cbcc8f8_86.png)

啊大概就这样一件事，所以说啊到时候画图的时候呃。

![](img/176a31b2583f501dbbe85d036cbcc8f8_88.png)

你愿意画这个KD也行，愿意画这个hie一个直方图也行啊。

![](img/176a31b2583f501dbbe85d036cbcc8f8_90.png)

通过这个图咱可以去观察啊，什么其实这两个三角图是类似的，观察谁啊，就是当前我们这两个指标如果说在散点图当中，它的一个趋势是什么。



![](img/176a31b2583f501dbbe85d036cbcc8f8_92.png)

肯定是负相关的吧，咱之前哎在这张图当中，我该说给大家看了。

![](img/176a31b2583f501dbbe85d036cbcc8f8_94.png)

你下降人员增加，你下降人员增加，咱通过这张图是我观察来的。

![](img/176a31b2583f501dbbe85d036cbcc8f8_96.png)

但是散点图当中是不是会更清晰的，帮我把这件事给他做出来啊，所以说啊，到时候大家来做分析或者观察的时候啊，至于具体用什么图无所谓啊，选择一个看起来舒服的就行，诶那你说这个图现在舒服吗，好像差点。

你说还差了点啥呀，唉这个图当中啊，如果说你说你画了一个这个散点图，你再给我画一个回归方程行不行，给我画一个回归方程往上一看，或者说你把这个回归系数告诉我，我是不是一打眼我就能知道哎呀。

这个当前他们之间的关系长什么样子。

![](img/176a31b2583f501dbbe85d036cbcc8f8_98.png)

所以说接下来唉咱们终于说到了。

![](img/176a31b2583f501dbbe85d036cbcc8f8_100.png)