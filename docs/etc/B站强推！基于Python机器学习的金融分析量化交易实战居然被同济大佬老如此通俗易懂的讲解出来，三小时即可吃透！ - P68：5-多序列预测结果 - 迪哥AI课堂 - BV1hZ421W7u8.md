# B站强推！基于Python机器学习的金融分析量化交易实战居然被同济大佬老如此通俗易懂的讲解出来，三小时即可吃透！ - P68：5-多序列预测结果 - 迪哥AI课堂 - BV1hZ421W7u8

![](img/91394bea95788f06c5816fbe714c76d4_0.png)

在这里在这块打上一个断点吧，然后哎呀我得把墙上断点都消掉。

![](img/91394bea95788f06c5816fbe714c76d4_2.png)

这个东西我看下model当中还没有断电了哦。

![](img/91394bea95788f06c5816fbe714c76d4_4.png)

这还有断点预处理模块下，这也有断点行都没了。

![](img/91394bea95788f06c5816fbe714c76d4_6.png)

保存一下，咱俩再重新再debug一下，进入到我们当前的额这个测试模块，其实啊这个测试模块除了测试我们还要干什么，就是啊其实就是你传建一个序列，我预测下去一个序列值呗，在这里也是一个窗口。

一个窗口去预测的，哎呀这里还需要大家重新看一遍。

![](img/91394bea95788f06c5816fbe714c76d4_8.png)

因为我把它没写到一起啊，就没写没写分开啊，都写到一起了，所以他得把前面训练的结果都在执行一遍。

![](img/91394bea95788f06c5816fbe714c76d4_10.png)

都相当于是在内存当中去做了呃行，马上就完事儿。

![](img/91394bea95788f06c5816fbe714c76d4_12.png)

啊这个debug debug的时候还稍微有点慢行，咱们F5跳进去来看一下。

![](img/91394bea95788f06c5816fbe714c76d4_14.png)

在这哎呀，我在这里我还得指定个东西，我看看这个指定个debug为false了。

![](img/91394bea95788f06c5816fbe714c76d4_16.png)

我这样我重新来吧，这块我多改了一步，我先给大家改过来，然后再说。

![](img/91394bea95788f06c5816fbe714c76d4_18.png)

咱们在写代码过程当中啊。

![](img/91394bea95788f06c5816fbe714c76d4_20.png)

估计大家也会经常遇到这个问题啊，就是你会时常的进行debug。

![](img/91394bea95788f06c5816fbe714c76d4_22.png)

debug的过程当中啊，你说你是不是要经常自己写一些打印的值。

![](img/91394bea95788f06c5816fbe714c76d4_24.png)

打印shift值，然后做一些观察，做一些展示啊，在这里啊，你看我我在这个函数当中，一会儿用这个函数啊，去预测一个多预测多个序列，你看我写两个，if if debug等于false。

我是执行正常的一个操作，就是它不打印任何东西啊，如果说else，那就是我指定debug为true，我刚才是不是把debug值改成成true值啊，debug为true。



![](img/91394bea95788f06c5816fbe714c76d4_26.png)

它会走下面这个东西，像这个东西啊，只是比上面多了一些我自己打印的。

![](img/91394bea95788f06c5816fbe714c76d4_28.png)

我自己要观察的一个结果，这个是方便大家自己进行观察的，你看这回它就跳到这个else当中吧，在这个else里啊，我就可以进行一个观察了，来看一下它当前的一个结果是等于多少的，我们可以来看在这里。

首先第一步我要预测什么，预测的是一个序列吧，先构建一个空的序列，然后呢我的一个数data，以及呢哎呀这个没显示出来，它的一个值data是这些值啊，在这里它都显示出来了，这边是一个值。

我这个ELISE啊经常一些抽风啊，我我我不给他关了一关，就会他可能就是那什么，他可能就是呃他好，就是他执行了一一，执行完这个训练之后啊，点开鼠标一往这移的时候，它不显示它具体值了，再拿右侧的面板来看吧。



![](img/91394bea95788f06c5816fbe714c76d4_30.png)

把这个面板稍微调大一点儿吧，行这么看吧。

![](img/91394bea95788f06c5816fbe714c76d4_32.png)

然后第一步啊，我去打印一下data的一个shape值什么，9514十九一，首先第一点，为什么951哪来的1000-49吧，一共预测序列长度是1000，但不要忘记要减去它的一个每一个time。

step的一个长度，49吧，行，然后这是我的一个data，它的一个shape值，第一步我是不是要拿到第一个序列啊，一开始for i这个I等于几，这个I是等于几啊，零吧，然后呢零乘上预测的一个长度。

预测的一个长度，我在这里预测什么，预测长度暂时定义成个50，所以说这块现在0×50=0吧，先把第一开始我的一个数据，就是当前第一个序列拿到手啊，这是第一个序列，我的一个输入数据。



![](img/91394bea95788f06c5816fbe714c76d4_34.png)

然后呢预测值暂时定义为空，首先在这里我要去做这样一件事儿了，在这里啊，接下来你说要预测几个值，预测50个值，预测50个值啥意思啊，咱现在拿输入数据是不是0~49，我预测出来第50个值等于多少。

那我问大家一个事啊，你预测完第50个值之后，是不是相当于第50个值，你就有了，接下来我拿1~50去预测51，这个值可不可以预测完51之后，51你是不是有了，我是不是可以拿2~51去预测52了。

所以说啊咱这个时间序列什么意思啊，相当于你有的是这个0~49，这个序列我需要做出来什么，这个大小画的有点不一致啊，反正大小这么的吧，切一点再切一点，这个大再切再再切一点，这个大小差不多，这一块是50。

是不是我在这里这一块是49个数据，我要接下来预测50个数据，可以吧，那你说接下来我预测100个行不行啊，道理是不一样的，但是有一点就是你用前面49个，你说你预测将来十个可能挺准的。

预测50个是不是可能有点偏移啊，你再预测100个，可能跟实际偏差再大点，你要预测200个是不是偏差就越更大一些啊，所以说我们现在要预测的结果是这样，基于预测的结果再进行预测，这个意思啊行了。

刚才咱们是不是训练出一个model，用我的model点product一下是不是可以进行预测啊，预测的时候需要你传进来当前的什么，当前的我的这个我的一个序列吧，来看一下当前这个序列等于什么东西。

等于什么格式啊，呃我调这个里边，首先第一开始我看的是什么格式啊，它这一块是一个二维的吧，二维当中应该是什么，应该是一个49，然后呢每个位置是一个值吧，在这里啊，我问大家第一个事儿，它是几维的二维的吧。

我们网络模型输入要求是几维的三维的吧，所以说啊我们现在是一就是一个序列，一个序列预去预测吧，没有一个by是一个by是吧，所以说这块是不是你应该自己再添一个一啊，相当于预测这一个序列吗。

在这里怎么填这个一啊，添加了一个new新的一个轴，转换成一个三维的，这样咱才能进行一个预测吧，预测完我得到了一个预测的一个结果，就是product result，为大家点开这里它是什么，它是一个值吧。

我预测出来结果是不是一个值啊，注意点这个值它是不是一个二维的，那我是不是要把它二维当中给它展开，就是把这个在这个二维的数组当中，把它值拿到手啊，所以说这块写个零零是不是实际去取这个值啊。

再执行一下final result当中，再来看一下呃，final result它就是实际的float32这个值吧，而不是一个ND类数组吧。



![](img/91394bea95788f06c5816fbe714c76d4_36.png)

行了，咱现在预测完了一个值，这是不是我预测的序列当中第一个值啊，把product当中拿过来，product当中第一个值我已经有了吧，你看这个里边现在是不是存在一个值了，接下来打印当前这个序列。

这咱就不看了，当前序列当中哎我写了一个一冒号，啥意思啊，一开始0~49，下一次要做的时候是不是1~50了，那我第一步我先把这个东西先变成什么，我重写一下，一开始0~49，接下来你要去1~50。

我先把1~49取出来行吧，在原始序列当中，这一步去取1~49可以吧，取完1~49之后，南派点insert一下，我这个1~49，我再把这50个给它加进去，是不是就完事了呀，这个东西可以吧。

你看这里我要加这个值了，在这个值当中在什么位置，在就是往哪个序列当中去加，加在什么位置，是不是最后一个位置啊，加什么值，是不是新预测出来的一啥意思啊，因为一会儿我要不断的去预测值。

我始终要添加的是预测的最后一个值吧，一是不是表示最后一个值，这样我就把最后的一个值又加进去了，再打印出来，这是不是说现在我就得到了一个1~50啊，有了这个东西，1~50之后，它是不是又是一个序列了。



![](img/91394bea95788f06c5816fbe714c76d4_38.png)

又是一个序列，我是不是还能进行一个预测呀。

![](img/91394bea95788f06c5816fbe714c76d4_40.png)

预测完之后，你看这个final result它是不是又是一个新的结果，有了一个新的结果之后，咱再不断进行执行，每一次final result值是不是都是不一样的，重新点一下，现在变成一个负的0。

762311，再来看当前的一个值是不是发生变化了，所以说我每次预测值都是不一样的吧，连续做多少次，连续做这么50次，做完之后我是不是得到了新的50个序列啊，所以说输入0~49输出呢，50个值从49开始。



![](img/91394bea95788f06c5816fbe714c76d4_42.png)

接着50个值输完事了，这个不用给大家一个做到底去看了吧，那这个就是我最终的一个结果吧，最终的一个结果预测完之后。



![](img/91394bea95788f06c5816fbe714c76d4_44.png)

我在这里你看啊，当我执行完到这儿的时候，诶，跳到这哇。

![](img/91394bea95788f06c5816fbe714c76d4_46.png)

他这块在打印好多东西，这一块是不是说什么，我做完了第一个位置的一个序列了。

![](img/91394bea95788f06c5816fbe714c76d4_48.png)

我做完第一个位置的一个序列了吧，那下面一步我要怎么去做，来看一下这是什么，I是第二个值，I1开始是零二，第二次数是一吧，一开始0×1个50等于一个零二，表示着从0~49。

这开始接下来你这个东西1×1个50，它是不是等于50啊，比方说从50这个序列开始一直到100吧，我要去干什么，可能不是到100~99吧，再做序列吧，在不同的地方都要去做啊，相当于是这个意思。

在不同的序列点分别开始执行这样一个操作。

![](img/91394bea95788f06c5816fbe714c76d4_50.png)

最后呢，我是不是就可以预测完所有的一个结果值了，预测完所有结果值，我再把它打印出来，就是我该给大家看的。



![](img/91394bea95788f06c5816fbe714c76d4_52.png)

咱的这个这个啊这个结果了，然后啊在这里啊啊这在在在这里用用这个函数。

![](img/91394bea95788f06c5816fbe714c76d4_54.png)

这个就是刚给大家说的啊，咱的一个预测当中啊。

![](img/91394bea95788f06c5816fbe714c76d4_56.png)

咱是一步步怎么去做的，哎呀这这这也这样，我这块我得把这个就你自己啊在补debug的时候。

![](img/91394bea95788f06c5816fbe714c76d4_58.png)

你把这个东西啊执行成一个false值，要不然它打印出来的结果太多了以后啊。

![](img/91394bea95788f06c5816fbe714c76d4_60.png)

大家也可以，就是呃就是反正我是习惯这么去做了，一般情况下我都会指定一个debug。

![](img/91394bea95788f06c5816fbe714c76d4_62.png)

因为就是你自己做东西的时候，那出问题是再常见不过的了。

![](img/91394bea95788f06c5816fbe714c76d4_64.png)

遇到问题最好的东西就是你把这个东西啊，就是怎么样debug时一步步看一看。

![](img/91394bea95788f06c5816fbe714c76d4_66.png)

最后啊这一步还有这一步，PLOAD这个画图函数我不说了吧。

![](img/91394bea95788f06c5816fbe714c76d4_68.png)

画图函数没什么说的，放一个图当中，哎你在这里预测多序列吧，多序列每一个自己画自己就完事了，这画图不说了，咱直接来看一下这个结果就可以了。



![](img/91394bea95788f06c5816fbe714c76d4_70.png)

额等进过程当中啊，顺便给大家总结一下。

![](img/91394bea95788f06c5816fbe714c76d4_72.png)

在这里是不是从头到尾跟大家说了一下，怎么样用我们这个KO的工具包啊，把我们时间序列这个东西做出来。

![](img/91394bea95788f06c5816fbe714c76d4_74.png)

对于一个正弦数据来说，咱们这么去做，其实其他数据是不是也一样的，需要注意大一点，就是你一定也知道啊，咱们从前到后我的一个图形，而不是我的一个图形，我的一个网络模型，需要要求它的一个输入是什么东西。

基于它要求的输入，把这个数据做出来，数据预处理啊，我觉着啊，永远是要比建模可能更复杂的一个东西，这个数据啊就是咱们这批数据啊，做一些时间序列可能比较容易，但是相对来说有很多数据啊，你想做时间序列。

需要做的额外处理还是比较多的。

![](img/91394bea95788f06c5816fbe714c76d4_76.png)

这个到时候大家就得根据啊，自己实际的一个任务需求，来不断的去进行做处理处理操作了。

![](img/91394bea95788f06c5816fbe714c76d4_78.png)

那行啊，那这节课就跟大家说了一下，我们怎么样啊。

![](img/91394bea95788f06c5816fbe714c76d4_80.png)

用这个QQ工具包啊。