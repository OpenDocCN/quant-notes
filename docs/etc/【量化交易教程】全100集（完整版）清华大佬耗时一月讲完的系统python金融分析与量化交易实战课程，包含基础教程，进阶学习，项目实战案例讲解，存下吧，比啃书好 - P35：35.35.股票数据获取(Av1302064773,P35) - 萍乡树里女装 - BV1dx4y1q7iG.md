# 【量化交易教程】全100集（完整版）清华大佬耗时一月讲完的系统python金融分析与量化交易实战课程，包含基础教程，进阶学习，项目实战案例讲解，存下吧，比啃书好 - P35：35.35.股票数据获取(Av1302064773,P35) - 萍乡树里女装 - BV1dx4y1q7iG

接下来啊我们就来看一下，刚才哎咱们说的一个因子选股的策略，哎，先把我们的一个因子拿过来做一些预处理。我要去基值，哎，我还要去做标准化，还有中性化操作，做完这些基本操作之后啊，咱们来看一看基于因子啊。

我设计个策略。哎，比如说像他们说的因子当中啊选择某些指标。然后我们来衡量一下哪些股票好，这样呢在股票时当中啊，咱把这批数据，哎，咱把这批股票拿过来，我去买。然后呢我们的因子啊会随着时间的变化。

每天都会发生变化吧。那其实啊像于这样一件事，哎，我过一段时间我要做一个调仓，就是说股票时当中啊，可能就是我买这么十只或者买20只，但是呢一定得是符合我的一个因子选股策略的吧。

咱们啊就要来完成这样一个任务。

![](img/99c73b0d62950eb3e64529bff14c2196_1.png)

好了，来咱们来看一下怎么去写啊。第一步，哎在这里我是新建了一个我们的文件叫做2-因子策略。在这里呢呃一开始它也注入信息啊，都删掉了，没什么用啊。咱把我们一会儿啊会用到的一些工具包先导进来。

在这里啊就是呃它也是支持就是你的一些额外的工具包。像是咱们常用的这个nad啊，pandas啊这些东西哎，都是只能导进来的。



![](img/99c73b0d62950eb3e64529bff14c2196_3.png)

然后呢，第二个就是一个panda。然后1个PD，然后接下还有一个还有一个就是呃一会儿我们肯定要做一个回归方程吧。因为当我们在做这个中细化的时候，你要求解一个回归方程，所以说啊咱们得把回方程哎。

这个东西导进来。呃有两个可选的工具包，一个叫S learn啊，非常经典的一个及学习工具包还有一个呢就是统计分析当中啊也会比较常用的叫t models呃，对比一下。

就是还是觉着state models用起来更简单一点啊，基本上咱们两行代码就能把这个事做出来。就这里啊咱们把 models给导进来在咱们当前的模块当中我们导入一下。呃。

其实只需要导入啊它的一个回归模块就可以了。其他的咱们暂时还用不上。这个是我们要用的几个工具包一会儿看看吧，一会看看咱们还能不能用让其他的用什么咱们现导也行。然后咱们就按照这个顺序一步来去写吧。

首先第一步。

![](img/99c73b0d62950eb3e64529bff14c2196_5.png)

![](img/99c73b0d62950eb3e64529bff14c2196_6.png)

![](img/99c73b0d62950eb3e64529bff14c2196_7.png)

![](img/99c73b0d62950eb3e64529bff14c2196_8.png)

咱们的一个初始化模块，在这个初始模块当中啊，我们要设计哎设计什么？一会儿呢我们要肯定要做的一件事儿，大家想一想，你看啊我一会儿我会选择一个时间，比如说这个时间要改一改啊。

从2016年的1月1号到这么2017年的一个1月1号吧，咱们就这么一年时间。😊。

![](img/99c73b0d62950eb3e64529bff14c2196_10.png)

![](img/99c73b0d62950eb3e64529bff14c2196_11.png)

![](img/99c73b0d62950eb3e64529bff14c2196_12.png)

一会儿啊咱们是这样，我说现在啊我去选了一个策略，然后在这个策略当中，我选了一个股票啊，咱们有大池子。在这个池子当中啊，可能呃我每个月都要做一个调仓啊，每个月我都要选一选，看看哪些哎不符合我策略了。

我给它卖掉，哪些呢符合我策略可以买进来，是不是这样一件事儿啊？那这个就是当我们说一说啊，咱们也消好，你是按月来执行呢，还是按天来执行啊，按天你说是不有点太频繁了，没必要吧，一般情况下。

咱们还是按月来执行，所以说这里。😊。

![](img/99c73b0d62950eb3e64529bff14c2196_14.png)

![](img/99c73b0d62950eb3e64529bff14c2196_15.png)

![](img/99c73b0d62950eb3e64529bff14c2196_16.png)

在我们这个权益当中啊，咱们得写一下啊，因为我们的定时器需要写到我们的一个构造函是当中啊，咱写一下咱们之前啊是不是说过，有一个模叫什么？叫做一个哎，就这个我们这个定时器吧，指定好咱的定时器定时器当中啊。

你可以去指定，你看我这块点，它入串了，你是按天呢，还是按月呢，还是按这个周呢？咱们按月数就行了。好了，我们指定一个按月指定按月的时候啊，然后你需要去指定交易日不管了。然后你需要去指定个指就是呃按月啊。

你在做的过程当中，咱们该怎么样去调吧。好了，那我们写一下吧。呃，咱们写一个re。😊。

![](img/99c73b0d62950eb3e64529bff14c2196_18.png)

![](img/99c73b0d62950eb3e64529bff14c2196_19.png)

![](img/99c73b0d62950eb3e64529bff14c2196_20.png)

![](img/99c73b0d62950eb3e64529bff14c2196_21.png)

一会儿呢我们定义这样一个函数啊，相当于在这个函数当中啊，我们就去执行一下实际咱们的一个呃池子该怎么去选啊，这样一件事儿。好了，然后把这个复制一下名字稍微改一下就行，在这里。



![](img/99c73b0d62950eb3e64529bff14c2196_23.png)

宁泽伟复制过来，你balance。这里啊咱们来想一想我们都需要做什么，是不是说一开始的时候啊，哎呀我得去看一下啊，不是一开始的时候我得去先找一批股票出来，然后在这个股票当中，我去选哪个是我要的。

哪个是我不要的吧。我们有这样一件事儿吧。那这个啊咱们该怎么去做啊，是不是说第一步我先得把咱们的做的股票数据，哎，我说都得给它读进来。然后呢，接下来咱们在这池当中一个去选吧。



![](img/99c73b0d62950eb3e64529bff14c2196_25.png)

先把我们的数据给它读进来。数据读啊，其实有很多种方法。这里咱们就暂时啊先选所有的一个股票数据了。你看它是API咱们点进去啊，点进去的时候不用点进去，就是你鼠标放到这儿的时候，他就会给你解释啊。

当前哎你用的函数它是什么意思？他说这样啊，往上一点啊，他说了，现在呢我们要去哦这个。

![](img/99c73b0d62950eb3e64529bff14c2196_27.png)

![](img/99c73b0d62950eb3e64529bff14c2196_28.png)

![](img/99c73b0d62950eb3e64529bff14c2196_29.png)

![](img/99c73b0d62950eb3e64529bff14c2196_30.png)

哎，这个我再往下点吧，因为我看不清。好了，他说啊现在哎你要获得某个国家市场啊，然后一些所有科学信息了。在这里我们就玩股票就行了。所以说一会儿我们会传建个tpe值等于CS啊，咱们找到这批股票。

找到所有的股票啊，咱们先来写一下，在这里呢咱们该说了，看到有一个参数type叫什么，叫做1个CS吧。好了，我把这个CS传进去，这样它会把我的一个股票啊给拿到手，拿出股票之后啊，然后。😊。



![](img/99c73b0d62950eb3e64529bff14c2196_32.png)

我们还得对股票过做什么？其实一会儿啊咱还得对股票做一个操，就是作为过滤的事吧。因为这些显示所有的，咱一会儿呢可能不会用到这么多个股票啊，一会儿我们可能只会用其中一部分。

所以这里我们把这些股票的ID怎么样，把这些股票ID啊，我要做一个筛选了，看看有些怎么样，它是不符合的那我们在前面还得写，我得写一个筛选的函数。😊。



![](img/99c73b0d62950eb3e64529bff14c2196_34.png)

![](img/99c73b0d62950eb3e64529bff14c2196_35.png)

![](img/99c73b0d62950eb3e64529bff14c2196_36.png)