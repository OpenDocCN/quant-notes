# 学完血赚！最强人工智能数据挖掘实战【Python金融量化分析】，非常适合新手！即练即会！！！ - P55：55-聚类分析实例 - 迪哥小助手 - BV1URsfeqEQ5

好，这节课咱们来看一下剧类啊，还有统计的策略方法。我们在排演当中啊，咱们该怎么样去做。首先呢还是第一步啊，先把咱们这个工具包全部的给它导进来。跟咱们之前一样，工具包哎是没有发生任何变化的。

然后第二步呢就是导入啊咱们现在要用的这份数据。上节课咱们是不是跟大家说过了，哎，对于这个数据我们要提取出来一些特征吧。这块呢我们选了两个特征啊，就是前一天啊它这个指标还有前两天它的个指标。

这两个信息啊是一会儿我们要建模的时候用到的啊两个具体的指标。然后接下来有了指标之后，我们就可以做一些建模的事情了吧。这次啊咱们做的任务跟之前啊不太一样。之前呢我们是用一些回归的方法去做。

这回啊咱们拿剧类的方法来去做。首先啊第一步。

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_1.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_2.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_3.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_4.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_5.png)

咱们在这个SK learn当中，哎，这咱们述说了，做一些建模方法，最好用的包就是这个SK learn了。然后这回我们选的模块跟之前不太一样。

之前是回归这回呢我们用聚类聚类当中啊有一个算法叫做K min啊，咱们之前给大家讲了K min建模的一个基本方法。好了，这我第一步先把我的一个模块给导进来哦，上儿面实醒。😊。



![](img/53bc1fe1ab3b10a18b36f25549ea64e3_7.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_8.png)

重新的都执行一下啊，导建一下我们的模块。然后接下来我执行这样一个K means操作。在这里啊，我说我建立一个模型，哎，这个模型就是K min。然后这里边需要我们指定一个参数。

就是呃我们要建立有这么多少个促吧啊，一个clustercluster这里啊我们需要自己指定一下，也就是一个K值。咱们这个任务当中啊比较简单，我是不是说呀我想去判断一下嗯，什么时候涨了，什么时候跌了吧。

那也就是说两个结果，一个负一，一个一说就行了。好了，我说指定2去构成这么两个醋就行了。

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_10.png)

然后呢，咱们执行一下吧，哦，我看这里哦N clutter，我看这里啊少一个S是吧？

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_12.png)

再执行一下，这样呢咱完成了一个建模的操作啊，不是建模，就是一个模型实例化操作。然后呢对我的model，我说点fiit一下，把咱们的实际数据啊传进去。实际数据啊之前我说这里有一个beta啊。

我们的数据当中呢我们要选择其中的某些列这列名，咱之前是得做好了。好了，把这些列传进去，我们进行一个模型建立就完事了。这里显示出来了，就是当我们建模时候啊，会用到的一些参数，这些参数当中啊都有一些初始值。

比如说我的一个就是两个类别中心点初始化的一个方法，然后最大的一个DI次数，然后要聚成几个对，然后呢就是我这个模型会重复的执行多少次，重复执行多少次是这样，就之前给家演示K当中啊。

不是每一次结果都是不一样嘛。所以说当我们用聚类建模的时候啊，它不是建模一次就给你返回的结果，它是建模的10次，看这1次哎整体的一个结果把你返回每一个点它的一个到底属于啊哪个这样一个归属这个就。😊。



![](img/53bc1fe1ab3b10a18b36f25549ea64e3_14.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_15.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_16.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_17.png)

是有些参数啊，大家如果说想详去看啊，在SK learn当中啊，官方官方文档里边都会有这样一个详细的介绍的。然后呢，接下来我说。对，有这个模型啊，我建完之后，然后呢我要去预测一下当前咱们这批数据点啊。

它都是呃预测结果都是什么，或者说得到一个零还是一个一，代表着它属于哪一个错。在这一块代脑当中，我说指定一个新的店名吧，就叫做当前啊，我的一个错它的一个归属啊就行了。classster行了。

然后我们来执行一下吧，看一下当前的一个效果。执行完之后，我们的数据当中已经有了这个错。呃，这也这样，我把这个结果再稍微改一改。



![](img/53bc1fe1ab3b10a18b36f25549ea64e3_19.png)

因为你看啊就是当前我点还列完之后，这里边它是一个01吧，可能咱们要的并不是一个01，而是什么，而是一个一和一个负一吧。所以这里我说我给它稍微改一改啊，安排点问一下数据当中呢就传入我们当前的一个预测结果。

对预测结果做一个判断。如果说它是一的时候。

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_21.png)

然后呢我说把一这个堆儿，然后当做一个负一吧，然后把零那个堆儿哎当做一个一啊，相当于判断了两个堆儿啊，这里我们对数据稍微改一改，名字不用去变了，还是这个名字就行。然后来执行一下吧。

这一回数据当中啊就是我们想要的一个结果了。比如这里你可以去给大家。

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_23.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_24.png)

啊，打开来看一看，你看这里边是什么，就是一个一，还有-一了。这个结果我们现在已经有了吧。好了，有了一个一，还有一个负一之后，接下来我是不是说啊可以对我的一个数据来给大家画个图吧。

看一看咱剧两都是长什么样子吧。😊，呃，画一个三点图。在这个三眼图当中啊，咱们来指定一下呃，第一个就是我的一个data，我先把这个数据啊给它传进去啊，这个是我们当前的一个数据。

哎呀这个数据当中我三眼图里吧得指定这个X轴，还有个Y轴，我得重新画一下，先画这个X轴数据吧。然后取所有的数据样本点冒号取所有吧。然后呢呃第一个维度当做一个X轴行了。然后第二个维度我当做一个Y轴。

这是第一个维度。然后这里我说改成第二个维度是不就行了。然后呢，我说用呃不同的颜色吧，然后来表示这不同的一个错，我说指定一个C。C当中呢呃它是什么呢？C是这个就是我们刚串建好的，哎。

它的一个到底它是一个一还是一个负一来进行一个展示。然后接下来我说我选择一个呃颜色就行，选择一个颜色，那就是从浅到深的吧，从浅到深，其实说白了就是一个红色和一个蓝色啊，靠望一下看一下吧。



![](img/53bc1fe1ab3b10a18b36f25549ea64e3_26.png)

这里他就把这个图啊画出来了，其中蓝色是一个醋，哎，这个红色它是另外一个醋啊，这里咱们两个类别是不是已经划分好了呀？其实大家可以来看一下。在这个数当中啊，你看啊如果说它是一些负值的时候，就是昨天也跌。

前天也跌，那可能大概率今天也跌吧，可能是有这样一个趋势啊。这个是不是哪有两个错。但是现在问题来了，那你说现在啊你做这样一件事儿，那它能靠谱吗？你看这里哎你就说这个东西，哎一个是一个业，一个是一个副业。

你直接这么说它能靠谱吗？其实啊这个策略，我从这个剧类角来说啊，用的不是特别多啊，因为剧类它没有一个指导思想吧，所以说啊今天这个任务大家只需要简单熟悉一下剧类哎咱们是怎么去做的，以及呢在这个剧当中啊。

咱们得到什么样的一个结果就行了。实际当中啊，可能聚类效果啊，它的一个效果来说吧，并不是会特别好啊。😊。



![](img/53bc1fe1ab3b10a18b36f25549ea64e3_28.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_29.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_30.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_31.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_32.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_33.png)

试一下吧，在咱们这个任务当中，然后呃returns，然后之前乘上我们的一个看是不是returns名字啊，是没写错，returns给拿过来看一下咱这个剧类能使得咱们赚多少钱吧。

这里啊算了一下咱们能挣多少钱，然后。

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_35.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_36.png)

指定一下吧，指定一下，我们得到了一个新的店名。这个店名呢就叫做我们的一个。ctter然后它的一个returns吧。然后我们来看一下执行一下，执行完之后，咱就可以哦这个数据还没还原。

咱得把这个数据啊之前不是做了个对数嘛，现在我们给它还原一下，呃，重新的还原一下，把这个列还原回去，要对比哪两个指标来着？第一个是一个rence啊，原始的第二个呢就是一个咱们剧类得到的一个结果。

对于它然后我说点some一下，some完之后呢，我说点apply一下咱们的一个nad点E叉P数就行了。这回我们做一个还原。还原回去之后啊，再看结果吧。😊。



![](img/53bc1fe1ab3b10a18b36f25549ea64e3_38.png)

呃，看起来这个效果不是特别好啊，你看第一次啊就是当前啊人家就你啥都不做，你是亏了一点儿，做完剧烈之后，怎么好像亏的更多了呢？所也这样可能就由于啊剧烈当中有一些随机性，导致这样一个问题。

这样我说我把这个东西给它restar底下，咱重新再执行一次，每次结果啊可能会不同啊，因为剧烈当中有一些随机性，呃，这个当中还是一个0。6G，看起来效果反而不如之前了。

是不是效果稍微的有这么一点点的一个下降啊。😊。

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_40.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_41.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_42.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_43.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_44.png)

呃，刚才忽略了一个问题啊，就是在这个剧类当中，我们串算它的一个归属的时候，这两个点啊可能写的稍微有点反哦，应该什么？应该是一个一和一个负一，感觉会更靠谱一点吧。这样咱来重新执行一下，因为剧类来说。

这个结果不是特别可控啊，所以说咱们得到结果得多做一些尝试。你看刚才我是不是写反了，这边写了一个负一和一，那这样情况下应该是个一和负一吧，所以说现在啊当我们算完之后，哎，我们的一个剧类，它的一个收益效果。

看起来还不错，是不是这个只给大家举个例子啊，在这个例子当中看起来收益还不错，但是实际当中啊，像我刚说的剧类这个东西啊，毕竟它是不靠谱的。并且当我们去评估去分析的时候，剧类很难去分析，很难评估吧。

因为我们有标签，没法做什么，没法像是一些传统计聚问题做一些分析，还有评估，还有看一看最终结果怎么样吧。这个是一个剧类啊，给大家讲剧的原因，就是一旦。



![](img/53bc1fe1ab3b10a18b36f25549ea64e3_46.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_47.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_48.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_49.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_50.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_51.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_52.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_53.png)

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_54.png)

你逼到实在没招的时候，咱采用聚类啊。一般情况下，我们并不使用剧类种方法，只需要大家了解就可以了。

![](img/53bc1fe1ab3b10a18b36f25549ea64e3_56.png)