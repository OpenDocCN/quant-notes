# Python数据分析数据清洗，金融量化投资分析与股票交易实战 - P7：01 df的前世之Series - IT研究生 - BV1RqzBYzEnB

的话咱们就进入到了pandas这样的一个模块的学习过程当中。那么前几个小节呢，咱们已经把这个nP模块进行了一个讲解，对吧？那么ny模块我们再次的进行一个大致的回顾哈。ny模块。

我们说它就是一个基于一维或者多维的一个数组吧。并且这个数组当中存储的应该是一些数值型的数据，是不是啊？那么有了npy这样的一个模块，这样的一个容器可以存储相关的数据。

并且可以对这些个数值型数据进行相关形式的处理和运算。为什么还需要学习padas呢？那么首先咱们来看一下哈。



![](img/383d1ef72f2613f3059f728c0a0ae780_1.png)

那么我都知道这个n模块已经可以帮我们进行数值型数据的处理了，对吧？那么学习padas的目的是什么呢？O我们来解答一下啊，那么首先这个在我们的数据分析当中，除了需要去分析处理运算相关数值型的数据之外。

那么还有大量的需求需要我们去分析处理相关非数值型的数据，O吧？那么如果你想去分析处理非数值型的数据的话，那么非数执型的数据，我们常见的应该是字串类型的数据吧，对吧？那么这些数据咱们怎么处理呢？

就需要借用到我们的padas这样的一个模块，所以说我们的padas主要是用来帮我们去处理什么呢？非数执行类型的数据吧，O吧？所以说你要把padas跟npy它的特性区分开来。

n主要是存储处理我们数值型的数据。而我们所谓的padas主要是用来存储跟处理非数值型的数据吧。是吧好，那么首先这个panda模块咱们怎么学？呢？首先在panda模块当中，我们需要学习两个常用的类。

一个类叫做serious，一个类叫做date frameOK吧。

![](img/383d1ef72f2613f3059f728c0a0ae780_3.png)

那么首先这个server跟date frame是两种不同形式的数据结构。一再提到数据结构的话，那么我们就要知道数据结构指的就是一个容器，容器当中可以装载数据，是不是啊？我们在讲解n模块的时候。

我们说n它也是某种形式的数据结构，它也可以装载去处理数据吧。那么我们nda当中这两个常的类，一个s一个date frame也是两个常用的数据结构。

我们也需要将非数值型数据可以存储到我们的s跟date frame当中，并且基于这两种数据结构封装好的相关的工具类相关的特性可以去处理其存储的非数值型数据吧。O吧。那我们说。

这个pandas主要是用来存储和处理非数值型数据吧。那你让他去存储数存储这个数值型的数据可以吗？也是可以的啊，也是可以的。只不过它通常被用来存储和处理非数值型类型数据，OK吧。

那么接下来我们就来看一下pandas当中封装好的这两个常用的类，这两个数据结构怎么去用。OK吧。那么首先咱们先来看一下se啊。

我们可以从seer逐步的引出咱们date frame这样的一种数据结构的使用和处理方式，O吧。

![](img/383d1ef72f2613f3059f728c0a0ae780_5.png)

好，那么这个在panda模块当中，咱们重点要学习的就是我们的date frame啊。但是的话我们的se可以帮我们逐步的引出d frame到底是怎样的一个东西。OK吧？

包括我们的se就是组成date frame的一个组元素，或者说我们的date frame就是由s组成的。所以说我们如果能够想要更好的去学习date frame的话，首先你得先知道se是什么，对不对啊。

那么现来看一下我们的这个s啊。

![](img/383d1ef72f2613f3059f728c0a0ae780_7.png)

那首先我们说sious它是一种形式的数据结构，可以装载存储数据，是不是？那么我们可以暂且的把这个sious当成是一个一维的数组，OK吧？当成是一个一维的一个数组。OK吧啊，当然它本质意义上来讲。

并不是一个一维的数组，只不过和一维数组存储数据的格式很相似。所以说咱们暂且可以把它当成一个一维的数组仅仅可以是一维，不可以是多维OK吧？OK啊，那么sious暂且把它理解成是一个一维的数组。

那么这个一维的数组是由两部分组成的。第一部分叫做vol，第二部分叫做index。

![](img/383d1ef72f2613f3059f728c0a0ae780_9.png)

OK吧那毫有疑问vols指的是说我们s这样的一个类似于一维的数组结构存储的数组元素叫做vols吧，对吧？index指的是我们每一个数组元素所对应的一个索引。OK吧，对应的一个索引啊。

那接下来咱们就首先来学习一下如何去创建咱们的s吧。那么在创新之前，在这儿我们先要导入一下我们的这个s对应的一个类吧，对吧？怎么导呢？首先我们从pandas当中。



![](img/383d1ef72f2613f3059f728c0a0ae780_11.png)

import导一下我们的这个s这样的一个类就可以了。OK吧fromda input series将s进行一导入。导完之后，我们就可以基于s去创建一个类似于一维数组的一个数据结构了吧。好，怎么创建呢？

在这的话就是基于我们ser的构造方法进行一个重建。OK吧，首先s是一个类，那括号表示的是调用这个类的构造方法吧，对吧？那构造方法有哪些参数呢？首先我们会用到这么几个参数。第一个叫做data。



![](img/383d1ef72f2613f3059f728c0a0ae780_13.png)

data指的是我们的数据源。那就是说我们需要往s这样的一个一维的数据结构当中存储的数据是什么，对不对？index毫无疑问，指的是我们存储数据的一个缩引吧。de type指的是存储数据的数据类型，是不是？

那么首先首先咱先用一下这个data版。那谁可以充当data呢，那在这儿的话，首先我们可以使用列表充当我们的数据源。比如说123是吧？这再写一个呃for。

OK吧那么现在啊这块的话我们就创建好了一个serv，咱们在这儿呢用S去接收一下，并且将s打印一下。整理会发现现在这块所返回的这样的一个数据结构，就是咱们创建好的一个servO吧。

你看这个serv首先第一列是不是我们每一个元素的索引是吧？默认的索引是不是从零开始的呀。第二列指的是我们这个s当中存储的每一个元素吧，分别是123跟f是不是跟for吧，ok吧啊。



![](img/383d1ef72f2613f3059f728c0a0ae780_15.png)

那所以说你看这块我们就创建了一个啊这个se看上去就像是一个异味的数组吧。OK吧当然它跟数组是有不同的。因为我们说数组哈数组的话，它是什么呢？它是需要存储的数据元素的类型也是统一的吧，对吧？

别统一的那现在在这块的话，你看我们的这个s创建好了之后，这块所存储的是123跟啊，对吧？那123f这几个数值它的类型是什么呢？O吧？那是统一的还是可以为不统一的呢？我们逐步的往后去看O吧。

逐步的往后去看啊，那现在我们使用了我们的列表充当了我们的数据源是吧？那除了用列表充当数据源，我们还可以用什么呢？用我们的nike充当数据源，我们来看一下啊。

首先将我们的这个n模块呢进行一个导入是不是就可以了。然后呢在这儿啊我们来创建一个，然后再次使用它的购物的方贝等于什么等于我们的这个NP点。rananddom点 randomdom对吧？

从0到100size给它一个三行四列，你会发现现在我这个数据源对应的是一个三行四列二维的一个nP数组啊，那么二维的n数组可以充当咱们一维这样的一个数据结构的数据源嘛？我们来试一下S打印一下走。

那这块给我们报了一个异常，是不是为啥呢？是因为我们说s它仅仅是一个一维形式的数据结构，那一维形式的数据结构，怎么可以去存储一个二维的数据源呢，不可以吧？那怎么办呢？好。

我们把这个什么呢n啊给它更换成一维的形状，再看一下走是不可以了，对吧？可以了啊，那么从这个案例当中也可以更加充分的体现出我们的s仅仅是一个一维的数据结构吧，对吧？仅仅是一个一维的数据结构OK啊那。



![](img/383d1ef72f2613f3059f728c0a0ae780_17.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_18.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_19.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_20.png)

接下来我们来看一下，那现在我们是不是只用了data呀，对吧？只用了data这样的一个这样的一个这个呃构造方法的参数。除此之，我们再来看一下什么的参数二叫做index吧。index指的是它的索引。

那就是说我们可以通过index这样的一个参数，动态的显示的去声明它的索引。比如说我这儿写一个A写一个B，写一个C，再次看结果，嗯，应该有4个元素是吧？



![](img/383d1ef72f2613f3059f728c0a0ae780_22.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_23.png)

对到会发现现在这块所打印的se123four这几个值，它的索引就不再是0123了吧，而变成了ABCD是不是？那么就意味着这块我们来解一下啊，index啊，这个参数是用来啊用来这个指定什么呢？显示索引的。

啊，那么这个显示索引就是我们的index可以表示的吧，对吧？那如果没有index，我们默认的0123，它被称之为隐视索引啊，隐藏的隐隐视索引。而我们使用index可以给我们构建显示索引吧。OK吧。

那这块我们来想一个问题哈，就是说这个为什么。

![](img/383d1ef72f2613f3059f728c0a0ae780_25.png)

为什么？需要啊需要有显示索引呢，知有隐示，所以的话是够了吧，为啥还需要有显示索引呢？对吧？为啥呢？这块我们来思考一下啊，那么原因就在于是不是意味着我们使用显示索引，那就是说显示索引可以。可以增强这个。

C而斯的。可读性啊，对吧？你比如说啊我们这我们这儿想存的是什么呀？1234这么四个值吧，那么1234各表示的含义是什么呢？如果用默认的隐视缩引的话，是用0123来表示1234的索引啊，对吧？

那0123表示的是什么含义呢？对吧？那可读性不强。那如果我这可以用什么，可以用这个语文啊，用语文数学英语理综，那么这几个值来表示1234各自的索引的话。

那么意味着就可以通过显示索引增加直白的来表示我们1234这四个数所对应的含义吧。所以说我们可以使用显示索引增加sers的一个可读性O吧啊，增加s的可读性。



![](img/383d1ef72f2613f3059f728c0a0ae780_27.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_28.png)

好，那这块的话我们就使用了这个这个nike啊nike作为了我们serious的一个数据源吧。那除此之外啊，这块还可以使用我们的字典充当ser的数据源。比如说我这有个字典DSA。好，那这块有一个什么呢？

叫做。语文啊后边是1个100分啊，还有一个是数学。好，这个是99分。还有一个就说李总。250分OK吧，现在这有一个字典，然后的话我们来看一下SS等于。



![](img/383d1ef72f2613f3059f728c0a0ae780_30.png)

sious好，这块的话data我们来指定一下数据源数据源就是我们的字典，可以吧？好，打印一下s轴会发现现在我们就创建了一个s这个s当中所存储的数据来源于我们的字典吧。

会发现字典当中的K作为了s的显示索引吧。字典当中的wall值作为了s当中存储的元素是不是O吧？那么基于这三种方式，我们就可以创建s吧，对吧？啊。

使用我们的列表充当数据源使用nike充当数据使用字典充当数据源O吧那这个是我们s的一个基本的创建形式，O吧？那sious我们会创建了。那么接下来我们就来看一下sious的索引和切片。

那其实s的索引跟切片很简单，因为它是一个类似于一维的数组啊，那么它的索引跟切片就跟我们一维数组的索引和切片是一模一样的。你比如说我S是这样的一个吧，对吧？那我在这中括号，我取的是谁呢？取的是不是。



![](img/383d1ef72f2613f3059f728c0a0ae780_32.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_33.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_34.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_35.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_36.png)

元素啊取的是语文的成绩是100啊，对吧？那除此之外，我还可以sS可以怎么着？可以点一个什么呢？点一个语文造返回的是不是也是100。对不对？也是100万，这就意味着如果我们的sors有显示缩影的话。

我们可以通过打点儿啊打点儿掉显示缩引来返回显示缩影所对应的一个内容吧。OK吧，这个是我们的索引，那切片呢S中号，比如说零冒号2走是不是切出了前两个啊？



![](img/383d1ef72f2613f3059f728c0a0ae780_38.png)

对吧记住这两个啊。那这个就是我们的索引的截表很简单，这个我们就不说了是吧？跟一维数族很类似吧，对吧？很类似啊。好，那么接下来看一下我们所用的常用的属性。那常用的属性哪些呢？

首先S点shipship返回的不就是s形状吗？对吧？S点size sizeize返回的不就是什么的？这个sious元素的个数嘛，对吧？还是什么呢？S点 indexdex轴。

那么这个index所返回的是不是我们的索引的，对吧？这个是返回这个s的索引返回索引O吧？然后的话还有S点vol走返回的是是指啊，对吧？这是返回vol值，返回的是我们s当所存储的每一个元素值，对不对啊。

这个是它所常用的这四个属性，很简单吧，我们就一带而过了，O吧？一带而过啊。

![](img/383d1ef72f2613f3059f728c0a0ae780_40.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_41.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_42.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_43.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_44.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_45.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_46.png)

好，那然后的话还有一个S点2S点2de type看一下类型。

![](img/383d1ef72f2613f3059f728c0a0ae780_48.png)

看这块所返回的是int64啊，那么意味着de type可以返回啊返回我们serious元素的类型吧，对吧？返回元素类型好，那这块的话我们就来做一个测试。

比如说咱们之前说我如果通过这种形式去创建一个sious的话，这个sious当中啊，这个sious里边既有啊整数值，也有字符串值。那么最终它的类型是什么呢？



![](img/383d1ef72f2613f3059f728c0a0ae780_50.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_51.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_52.png)

看一下他的一个de type。看O这个O表示什么呢？啊，这个数据数据类型O啊表示的是ofject的意思。object表示的就是字符串类型，O吧。那所以说你看现在我们原始的数据是一23跟 four吧。

对吧？最终都给我强转成了字符串类型，对不对啊，那么意味着在sious当中也只能存储同类型的数据吧，是吧？只能存储同类型的数据啊，好，这个是我们sious相关的属性的一系个操作，那么接下来还有什么呢？

sious常用的方法，这四个方法的话，就逐一的来看一下吧啊，其实也不多啊也不多。首先那在这的话，我先去创建一个s吧。S等于s。好，在这的话，我的data数据源就是由n创建吧。

random点random好，还是从这个60到100吧。

![](img/383d1ef72f2613f3059f728c0a0ae780_54.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_55.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_56.png)

s的话给他一个长度是10可以吧？是10啊，现在看一下我们的se有了吧，对吧？那首先看一下第一个方块第二head干嘛写的thehead就是说显示什么呢？显示这个s当中的前N个什么呢？数据吧。

默认的这个N是5okK吧，默认N是5。那如果这写一个三的，只显示前三点数据吧，对不对？好，那除此之外，还有t，那t是不是后几个呀？



![](img/383d1ef72f2613f3059f728c0a0ae780_58.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_59.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_60.png)

对吧tail就是后几个，比如说我这几个三，你显示后几个元素啊，对吧？然后显示后N个元素吧，OK吧。

![](img/383d1ef72f2613f3059f728c0a0ae780_62.png)

好，那还有啥呢？还有我们的这个unicq啊，unicq的话它的功能就更强大了。比如说啊现在我S点S点儿。unic好，这块返回的是什么呢？返回的，你看这元素各数几个2468是不是9个了，为啥是9个呢？

原来的数组是不是原来的这个里面存的是不是10个值啊，为啥这返回是9个呢？是因为我原始的数据当中一定有重复的元素吧，对吧？unic表示的是什么呀？去重啊，去除重复的元素是去重的意思？OK吧？un啊。

然后下边的话什么is思呢not这些是什么意思呢？好，在这去看一下啊，它SS点is呢啥意思？走返回的都为for返回的10个for吧，啥意思？is我们这写一下is是用于啊用于判断。



![](img/383d1ef72f2613f3059f728c0a0ae780_64.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_65.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_66.png)

判断每一个元素是否为什么呢？是否为空OK吧，是为空。如果为空。返回。处否则返回什么呢？f吧，这意思呢是不是那有意思呢？还有什么呢？有一个叫做not呢S点not呢那not呢跟it呢是不是刚好呃相反的。

对吧？它是用来判定元素是否为飞空吧，为非空返回处，否则返回for吧，所以这返回的是10个处啊，对外10个处啊，你再想那我的s里边怎么可能会产生空制呢？



![](img/383d1ef72f2613f3059f728c0a0ae780_68.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_69.png)

对吧怎么会产生控值呢？咱们在这去试一下。比如说哈现在我有S1S一等于s。好，它里边所存储的值是123，可以吧？好，这块的话，我给它设定一个显示索引吧，显示索引分别是AE。



![](img/383d1ef72f2613f3059f728c0a0ae780_71.png)

B。C可以吧？好，还有一个呢是S2啊，看一下S2。S2的话存的也是123，只不过索引变成了ABC可以吧？现在我有S等于S1加上S2。你看现在我是不是让两个sious相加了。

然后现在我去执行看一下相加之后的结果是什么？走看一下这返回的是什么呀？二n6那啥意思呢？会发现那sious如果进行算术运算的话，那么它的一个运算的法则是什么呢？法则法则根据我们这儿所看到的一个样式。

会发现法则一定是索引。

![](img/383d1ef72f2613f3059f728c0a0ae780_73.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_74.png)

都。索引啊索引一致的元素进行算术。运算否则不空。你会发现首先看这儿啊，我们这的话，那S一里边的123分别对应的所是ABC吧，是吧？S2的123对应的所以是不是ADC呀，会发现。

那如果啊现在我让S一加S2意味着只有A和C这两个索引对应的一和3能相加，分别得到了26这两个值吧，那么二和2能加吗？不能加。

因为S一当中的二对应的所以是BSS一对应的是B是不是S2当中的2对应的所以是不是D啊，这个B和D这两个值，它的索引不一样，那就不能相加，不能加怎么办这补空啊。你看B跟D就以的形式给它补空了吧。

这块用的是一个NAN并不是我们的NONE吧，对吧？那么这两种形式，那是有区别的，区别是什么？我们后边会说的啊，会说到那所以说现在会发现我这块的话，我的S里边就产生空制了吧，对吧？

那么就S点A那看整理返回的既有又处吧。那这个for表示AA这一块啊A这个索引所对应的。

![](img/383d1ef72f2613f3059f728c0a0ae780_76.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_77.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_78.png)

值是一个废空吧，是吧？B，所以你对的值是不个空啊，这个空是不是？所以说这个是is呢跟not那这两个函数，它所对应的含义，可以监测我们serious当中的每个元素到底为废空或者是空吧。



![](img/383d1ef72f2613f3059f728c0a0ae780_80.png)

OK吧啊，那么后边还有什么呢？还有我们的这个艾s mealDIV这是不是加减乘除对应的意思呀，对吧？你可以使用什么？可以使用我们的这个运算符来进行加减乘除。

当然也能去调用上边已经给我们封装好的这些个方法吧，对吧？那能用运算符，我们就不用方法了吧，你要只需要知道这些方法是什么意思，是不就可以了，对吧？表示的是加减乘除对应操作吧，O吧？

那这个就是我们sious的一个基本使用，对吧？会发现在sious当中并没有学到过多的东西吧，只是我们掌握了如何创建serious，对吧？然后sious的常用属性，包括常用的方法有哪些，对吧？

并且serious在进行算术运算的时候，它有一个法则，就是索引一致的元素才能够进行算术运算，否则的话就补空呗，这个否则指的是与之进行算术运算的索引不一样，才会补空，是不是？



![](img/383d1ef72f2613f3059f728c0a0ae780_82.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_83.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_84.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_85.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_86.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_87.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_88.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_89.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_90.png)

ok吧好，这个就是我们s。所以说s我们会发现它就是一个类似于一维数组的数据结构吧。O吧。那么这个数据结构哈，它如果创建好了之后所显示的样式是这样的吧。对？那么在这个s中有示索引，也有显示索引吧，对吧？

那为啥会需要有显示索引呢，是因为显示索引可以增加我们s存储数据的一个可求性，是不是ok吧？好，那么这个就是我们的s那么s完事之后呢，下一小节咱们就来看一下这个date frame怎么来用O吧？

那么首先先铺垫一下我们的seious啊是date frame的一个组成元素，那就是说我们的date frame是由是由多个se组成的O吧？那所以说你看s是一个一维的数据结构。

而我的d frame是由多个se组成的那你就来试想一下d frame到底是一个怎样的，是怎样的一个维度的数据结构呢？



![](img/383d1ef72f2613f3059f728c0a0ae780_92.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_93.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_94.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_95.png)

![](img/383d1ef72f2613f3059f728c0a0ae780_96.png)

各位可以思考一下啊。好，那么这一小节就先到这里。

![](img/383d1ef72f2613f3059f728c0a0ae780_98.png)