# 讲的太好了！2024最系统完整Python金融分析与量化交易实战教程，完整63个小节，附带配套代码数据集分享！ - P42：3-获取因子指标数据 - 默默无闻你路哥 - BV1izmqYZEMU

这里啊咱们现在已经啊就是把所有工具包全部给它导进来了。接下来呢咱们就这个工具啊帮我们去完成。哎，我们因此分析任务就行了。啊，这里就是你看这个阿当中啊，然后导建几个模块是一会帮我们处理数据的。

是帮我们去画图的。然后下面俩是帮我们一会儿做分析的啊，这是一会儿咱用到的。然后因分析咱名字改过来了。了，在这里咱们写吧。那我来想一想这个哎跟之前咱的一个回测框架不太一样吧，回测框当中啊。

有一个handle bar，要是每天都可以去执行一件事，但是呢你看这里咱们现在这个模块当中啊，有每天去执行那一说吗？好像没有到吧，那我要干什么？我是不是现在啊得把很多天数据取出来啊，它没法每一天帮我取。

每一天再帮我取吧，那咱们得怎么办？我得自己来去写了啊，咱们先写一下。第一步我们要选择一个日期数据。😊。



![](img/aae0ff188cb04396b4cfa594a964e3fe_1.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_2.png)

选择日期数据。什么叫选日日期数据呢？你接下来啊要取。哎，比如说一个从19年1月1号到20年1月1号的，你得把这部分日期取出来。因为一会儿啊咱们在查询的过程当中，你得把日期传进去。

咱才能查询出来相应的一个结果吧。好了，咱们来写一下啊第一个函数。

![](img/aae0ff188cb04396b4cfa594a964e3fe_4.png)

叫做我们去获取一下获取啊咱们的一个 trading定data啊，我们的一个所有的交易的哎，不是data，是一个day词，就是一个日期。日益当中啊有两个参数。第一个参数就是呃从哪年。

比如说从这个2019年吧，然后1月1号，然后呢接来第二参数到哪一年到这个2020年，然后它的一个1月1号，哎，这个完事儿了，然后给它指定一个防御值。呃，确定对，这是咱们现在要用到的所有的日期。

每选完一步啊，咱都来看一看啊，因为也不确定这个东西写对不对，来检查一下啊，没问题是吧？好了，这是咱们现在指定好了，我需要的呃一个时间段当中啊，都有哪些个交易日，咱们现在全拿出来了。

接下来呢我们是不是说呃要获取交易数据指标了？😊。

![](img/aae0ff188cb04396b4cfa594a964e3fe_6.png)

好了，获取啊获取呃因子指标吧，因子指标。今天指标怎么获取啊？是不是我们要做这样一个查询的操作了。好了，查询操作当中，你先告诉我，你要去查第个因子，它叫什么名字。这个到时候大家你们可以随便玩啊。

咱就拿这个P来当做我们的一个指标得了啊，随便选一个，然后接来，那你说我现在啊是不是说迪在所有的股票当中，哎，去把这个因子拿出来啊。那好了，咱们得把股票拿出来。这里啊我们也不做限制了，搜作A股。

咱就直接的全部拿出来，然后一会儿咱把这些因子哎都给它打印出来，然后咱们来分析分析啊，看看哪些因啊，看看这个因子在不同股票当中啊，它的一个指标怎么样。我们先把所有的哎000300给它全部先拿到手啊。



![](img/aae0ff188cb04396b4cfa594a964e3fe_8.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_9.png)

H了，这是我们现在怎么样把所有的股票咱现在都拿到手了，然后指定个名字吧，这就是我现在的一个股票池子啊，这是我现在有的一个股票然后呢有了股票之后，我们是不是要做一个查询操作啊。

查什么查基于 fundamental当中去查一下当前我这个指标来说，它的一个各种各样的一个情况吧。呃这块这块这个太长了，我直接的去复制吧。打开一下咱们的一个。

我们去对data或是吧点第一个然后呢这里哎它就是有所有的API咱来找啊，就是现在我要去这呢我们去查询一些它的数据，然后这块我也不用看字段了，我就图方便了，咱直接把这个东西复制过来就行了。

这就是我当前的query语句，我直接复制了。然后复制到哪看看，复制到这里就行，我要的所有的指标咱拿过了实在记不住这东西实太长了。好了，咱来指定一下这个就是我要查询指标，我说指定一个QQ呢等于一个que。

😊。

![](img/aae0ff188cb04396b4cfa594a964e3fe_11.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_12.png)

我到这里去查呃，去查它当前的1个PE指标。然后呢，对于这个PE指标啊，咱可以给它做一个filter，就是看一看它是不是啊在我的一个主标式当中，咱来写一下呃，这些鞋挺长，点filter一下。

fi当中啊还是得把当前的呃这个传进来，我把当前的这个东西直接的复制吧，太长了这个名字把它复制过来。然后呢看一下当中它的什么，它的一个代码的名字是吧？我看看它这个t code当中有没有一个杠啊，这呢是吧？

这是有一个杠的。

![](img/aae0ff188cb04396b4cfa594a964e3fe_14.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_15.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_16.png)

，把它给它复制过来，行了，把它的一个code啊，没有刚把它的一个code复制过来。然后呢去判断一下它的一个股票是否啊是在我当前的这个池子当中。我的池子刚才定义好名字了吧。好了，在这儿给它复制过来。

传进去，这就行了。这里给大家看了一下，就是当前我们的一个查询语句，那做完这个查询语句之后啊，接下来我们是不是说哎你得执行这样一个找的操作才行啊。好了，我们另起行。



![](img/aae0ff188cb04396b4cfa594a964e3fe_18.png)

在这里呃执行草的操作我直接复制了，这里直接get一下。

![](img/aae0ff188cb04396b4cfa594a964e3fe_20.png)

get一下咱们当前数据，然后我的一个查询，我说这是个Q，我给它传进来就行了。不光你要告诉我传来一个Q，你还要告诉我什么。哎，你的一个查询日期吧，日期咱刚才是不是指定了，好了，指定日期哎呦。

但是这个日期它是一个它是个去列是吧？咱得查询某一天，这样吧，咱就查询查询第六天吧，先试一试结果对不对啊，先把数据拿到手。然后呃指定个返回值。😊。



![](img/aae0ff188cb04396b4cfa594a964e3fe_22.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_23.png)

这个就是我们查询的结果，每一天的我们去查的一个feer。哎，它的一个电脑数据。行了，然后这样咱来执行一下呃呃，这唉执行完没问题是吧？不要看这个一些警告，警告跟咱没关系，是平台它的一些问题，咱们不用去管。

然后这里咱们拿到这个数据。拿到这个数据之后啊，嗯咱来看一看吧，这个数据当中也指标，我说点ILOC一下。😊。



![](img/aae0ff188cb04396b4cfa594a964e3fe_25.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_26.png)

看一下IOC当中哦IOC当中，我需要先看一下吧，它的一个ship值啊，这个需要给大家解释一下，它的ship值啊稍微的有一点不一样啊。你看什么，它是个三维的，但实际上来说只有最后一个维度，它是有数据的吧。

前两个没什么用啊，咱都不用去管这个事儿。好了，那我说前两个那默认就是002，然后接来最后一个维度。我说我看这么5条数据吧，来执行一下。😊。



![](img/aae0ff188cb04396b4cfa594a964e3fe_28.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_29.png)

现在有什么了？是不是说哎这是一个咱的股票数据，然后这个是它的一个就是具体指标，它是等于多少。咱们现在是拿到手了吧。大大家可能说哎，这怎么没有一个日期啊，因为这里边当你传的过程当中。

是不是你就只写了当前的某一天，第一天那天2019年的1月2号吧啊，这是当前对于特定的一天，咱把这个指标给拿出来了。



![](img/aae0ff188cb04396b4cfa594a964e3fe_31.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_32.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_33.png)

但是我们来想一想。现在我们要做什么？那现在我在这写一下，我们现在完成的，现在完成就是呃获取啊指定日期吧，指定日期的数据啊，咱们已就会了怎么样去做。那现在呢我们要做什么？

我要把这一段的时间全部的给它做出来吧。那这个东西咱们该怎么去做呀？

![](img/aae0ff188cb04396b4cfa594a964e3fe_35.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_36.png)

![](img/aae0ff188cb04396b4cfa594a964e3fe_37.png)