# 学完血赚！最强人工智能数据挖掘实战【Python金融量化分析】，非常适合新手！即练即会！！！ - P14：14-策略收益效果分析 - 迪哥小助手 - BV1URsfeqEQ5

行吧呃，先写一下吧，就是我们的一个收益吧。收益咱之前是不给大家说过了？就是当我们做这个收益的过程当中啊，这个咱们得用什么？因为我们要算啊，就是最终的就是最开始1块钱，相当于最终多少钱。

这是不是一个累加的一个过程啊啊，有这样一个累加过程，咱们别说了，累加的时候，你不能直接算，我们得引入什么，引入一个对数吧。好了，在我们的电脑当中。



![](img/b02fb2fae5a9a48db2455d3730732dd3_1.png)

对谁去算的，是不是说我这个算这个报酬率，我得对我这个股价把股价拿过来啊，这是我的一个股价。好了，然后对我这个股价，然后当前算什么，它比上一下当前哦我直接复制吧，比上它的结果怎么样去shift一下吧。

当前的比上前一天的啊这样的一个结果。然后呢，这块我点shift一下，shift当中传进来一个一是不是就可以了。好了，这块咱们执行一下，就是有一个returnren值啊。

return的结果就是呃什么都不管的时候，不是什么都不管吧，就是。

![](img/b02fb2fae5a9a48db2455d3730732dd3_3.png)

咱这个通过这个走势算出来了啊，我们的一个增长率它是等于多少的？那接来呢接来啊就是按照我们的一个策略来去算吧。我们的策略什么意思啊？那现在好像是这样一件事儿。哎呦，我们的策略当中啊，是不是你考虑什么了。

永远都是赚的了。好了，我写一下咱的这个策略当中大家可能觉着啊就是你这个策略啊有点像开挂似的，有点必不先知了。行，咱就假装是开挂吧。实际当中啊可能没有那么好去算啊。好了。

在这里我们来看得需要多加上一个什么东西。😊，多加什么？之前的我们这个就是我们这个增长率已经算出来了。但是现在呢我们要干一件什么事啊，是不是说现在这块我们之前算了一个position这个东西啊。

position代表什么有当前这个位置，要么是一，要么是-一是吧？那咱们来看一下，就是当前我们这个策略当中啊呃就是对于什么时候position会等于-一来看这个图。

position等于负一的时候有哪啥这两两个区域是吧？那对于这两个区域来说，咱之前来说我们是怎么办的？之前啊如果说原始的情况下，在这里它是由100变成80，它是亏了。

但是我们反而要给它反过来反成一个转了，是不是？就是这块我们应该把这个-一乘什么乘上我的一个returns吧，这没问题吧。因为这块我说了哎这两个地方是我在策略当中我观察到的。对于这样两个区间。

我得怎么样把它反转过来啊，相当于我倒着来跟直接它的走势正好相反了啊，我这么去玩啊，😊。

![](img/b02fb2fae5a9a48db2455d3730732dd3_5.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_6.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_7.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_8.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_9.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_10.png)

算收益是吧？所以这点咱们来算啊，就是我我的一个策略结果等于什么？肯定是用position乘上我的个res的。因为position当中啊等于一的表示是呃我原封不动，就是跟你正常走势一样。

然后position当中呢，如果它是等于一个负一的，代表我恰好跟你的一个收益，我应该是反过来的。咱是不是要做这样一个策略啊？好了，我把这个position给传进去。但是大家要注意点。



![](img/b02fb2fae5a9a48db2455d3730732dd3_12.png)

这个position当我们用的时候，应该怎么样？哎，你看这里我们是不是也应该去做一个shift操作啊啊，不要忘记这里咱对于这个position来说，也有这个shift操作跟之前要对应上吧。好了。

这一块我们做完了。做完之后呢，我可以把这个结果啊再展示给大家看一下。

![](img/b02fb2fae5a9a48db2455d3730732dd3_14.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_15.png)

好了，此时你看呃前几个看起来都一样的是吧？这样咱一会看整体吧，因为在这数据当中啊，可能前面大部分都是position啊，它都是一个为证的一个结果。那行了，那我们想看一个最终最后的结果怎么算？最后的结果。

哎，对于我们的一个增长率来说，我们可以做一个累加吧。好了，咱把这个所有结果加一起，挺烦人的一点是吧？这块又出现确实值了。我得于把这个确实值再给它照不掉一下。



![](img/b02fb2fae5a9a48db2455d3730732dd3_17.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_18.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_19.png)

好了，再把确实值给它照不掉一下。好，准没确实值了。没确认值完之没这个确实值之后啊，咱来看一下，就是我们的策略啊和什么都不做的情况下，咱的一个收益到底哪个高，是不是做还原了。之前做的那个对数是吧。

现在给它还原回去啊，还原回去的过程当中，第一个值啊就是data当中，我把这两列都得传进去，别复制名字吧，一个叫return。



![](img/b02fb2fae5a9a48db2455d3730732dd3_21.png)

啊，第一个叫这个return这个东西。然后呢，第二个就是我们自己所指定的这个策略。好了，这是我们自己所指定的一个策略。然后这里就是还原回集完之后，大家不要忘记一点什么，你要做的是一个加法吧啊。

把增长率每一天的全加进去，就相当于第一天跟最后一天的结果了吧。就是此时这还有什么？这还有一个点s的一个操作来执行一下。



![](img/b02fb2fae5a9a48db2455d3730732dd3_23.png)

呃，执行完这个操作之后，我怎么感觉这个值这么大呢？应该没这么大呀，不可能1块钱，相当于之前的1700多块钱了。检查之前没有什么问题啊，应该不会这么大的。因为苹果这个股价它实际值才相当于4块多啊。

我检查一下这里这个点操作加错位置了，我怎么给它加到外面，应该对什么应该对我里边的结果做这样一个点s操作，然后接下来在什么再把那个对数还回去吧，所以说这里应该这块加上一个点s操作啊，这完事了。

执行一下行了看一下吧，这个什么意思？就是呃正常情况下，你什么什么策略都不都不做啊，1块钱相当于现在在4块钱是吧？那现在呢如果说我加上了咱之前什么我们的双均线策略之后，怎么样了，1块钱相当于5。8块了吧。

是不是说赚的会怎么样更多一些了吧啊，这是给大家先说了一下这个双均线策略啊，咱能够达到的一个收益。😊。

![](img/b02fb2fae5a9a48db2455d3730732dd3_25.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_26.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_27.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_28.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_29.png)

![](img/b02fb2fae5a9a48db2455d3730732dd3_30.png)