# 【比刷剧还爽！】这太完整了！量化交易和python金融分析实战课程，全程干货无废话 入门到精通一步到位！（数据挖掘分析／大数据／可视化／投资／金融／股票／算法） - P29：31. 31.31.3Sigma方法实例(Av1302064773,P31) - AI算法-溜溜 - BV1iC411n7XN

![](img/f925739fbe32d3bc664d1122d9ad67ef_0.png)

最后啊咱们来说去，其实当中还有一个叫三词用法方法，它的原理非常简单啊，大家先来看这张图，这张图当中你看我们画了个什么，那大家可能一眼就看出来了，我画了一个正态分布吧，这样分布啊。

如果大家理解起来比较麻烦，你就当做是一个正常的分布，什么叫正常分布，我以前讲机器学习当中经常举举个例子，我说你啊现在上银行贷款，银行就是多借给你个三块五块的，那是不是挺正常啊，多借你10万8万的。

少借你10万8万的，是不是就不正常了呀，咱们来看这样一个走势啊，这里我说我先画一条线，那咱们就拿标准正态分布来说吧，标准化分布当中啊，这是什么，这里有个均值均值什么零，什么意思啊。

比如现在我要干一件事诶，我这一个误差吧，就让我去银行贷款，他可能多借钱，也可能少借钱吧，那多借钱，那往右边点少借钱，往左边点，但是但是大家来看哦，我们现在这个区间来说呀，比如说你看我现在画第一个区间。

红色，我现在阴影画出一个区间，你看它的面积怎么样，是不是相对来说会比较大一些呀，代表着这些个事发生的可能性会比较高吧，那你看当我把这个区间越往外放的时候，你说这个可能性发生的概率怎么样了。

是不是就越低了呀，那你想一想，我们现在要干什么，是不是要做一个去极值的问题啊，那极值他可能落到哪啊，我拿这个红色画落到这可能吗，这块落的，你说能是极值吗，在均值附近了，大概率发生一件事。

那就是正常的数据吧，均值一般落哪儿啊，落在比较偏远的地方吧，这一块这一块这一块这几个地方越远的，离均值越远的，偏差越大的，越有可能是一些离群点吧，唉这样一件事儿，那什么叫做一个三倍的西格玛。

它是这样一件事。

![](img/f925739fbe32d3bc664d1122d9ad67ef_2.png)

你看这里啊，我们画的这个东西当中有什么，哎这有一个X诶，它的均值是吧，加上一倍的减去一倍的，加上减去两倍的，加上两倍的，减去三倍的，加上三倍的，那你看从这个区间当中哎，我们能发现一件事。

你看啊一旦你这个区间选的越大了，你看加减三倍的，你得到数据它越往左右偏的可能性会怎么样，就越小了吧，那这个三起码意思是这样，我说我现在做这样一份数据啊，数据来了，然后假设吧就是可以对数据做一些变换。

使得它理论上服从这个高斯分布或者正态分布，诶咱们先不知道怎么变的，就假设它就是正态分布的一个规则，那你看当我指定一个正负的三倍数码的时候，你说这个当中包含了百分之多少数据，这个值已经给大家列出来了。

这是统计当中啊，咱们经常为另外指标9。7%多吧，那好了，我们现在发现一件事，哎哟如果我认为数据当中啊，我想取最正常的九十九十九。7%的诶，当做我的数据，剩下23%的，我当做一个极值给它规范一下。

是不是可以啊，这个就叫做一个三西格玛啊，相当于你的一个下限和你的一个上限是来定的，在高层分布当中啊，你要算两个值，告诉我一个均值是多少，诶告诉我你的一个标准差是多少，是不是就行了。

咱就能把这个上限和这个下限全部计算出来了。

![](img/f925739fbe32d3bc664d1122d9ad67ef_4.png)

好了，这个叫做一个3SA方法写一下吧，其实也很简单啊，在这里名字跟之前一样吧，还是做一个复制哦，在这里我们做个复制，然后把最后面那个值吧，改成一个三西格玛就行了。



![](img/f925739fbe32d3bc664d1122d9ad67ef_6.png)

然后这一块我们输入的值啊，这块NV等于三吧，既然你说三，咱就写个三得了。

![](img/f925739fbe32d3bc664d1122d9ad67ef_8.png)

然后这块咱来写吧，我们需要算什么唉，在整个数据当中，这一列数据我是不是得知道当前的均值是多少，当前这个S这个标准差是多少啊，所以说对比数据我可以算两个值，一个是点M。



![](img/f925739fbe32d3bc664d1122d9ad67ef_10.png)

第二呢就是一个啊，直接复制吧，直接第二个就它就是一个点STD，这个它是一个点STD算它的一个标准差行了，那我们指定两个变量吧，变量名字就是一个面，然后下面的它就是一个STD行了。



![](img/f925739fbe32d3bc664d1122d9ad67ef_12.png)

前两个指标算出来了，有两边两个指标之后，接下来大家都复制就行了。

![](img/f925739fbe32d3bc664d1122d9ad67ef_14.png)

这也不用自己写了，把这个东西给它复制过来好了，这复制过来了，那你看中间等于什么一个均值，加上我N倍的一个STD吧，那下面呢就是我的一个均值，减去咱N倍的一个STD是就行了，那返回值这是一个series。

然后我的一个下限，我的上限咱们指定出来是不是就完事了。

![](img/f925739fbe32d3bc664d1122d9ad67ef_16.png)

非常简单吧，咱就完成了这样一个3C嘛。

![](img/f925739fbe32d3bc664d1122d9ad67ef_18.png)

哎这个函数呃，执行一下就是得到这个CMA等于什么呢，等于我的这个数据当中，然后把我当前这个data啊。



![](img/f925739fbe32d3bc664d1122d9ad67ef_20.png)

我的这一列传进来，然后N值N值我不用写了，N值哦，这个数据再写一下吧。

![](img/f925739fbe32d3bc664d1122d9ad67ef_22.png)

这个数据你要画这个90。7%啊，画的太明显了。

![](img/f925739fbe32d3bc664d1122d9ad67ef_24.png)

咱画个稍微明显的，你看贼明显，68。3，这个挺明显，是不是咱取68。3%的。

![](img/f925739fbe32d3bc664d1122d9ad67ef_26.png)

等到正常的超出这个范围的，当不正常的，多写个一吧，假设N等于一。

![](img/f925739fbe32d3bc664d1122d9ad67ef_28.png)

然后我们执行一下，然后来画这个图，简单来看一看它的一个大概取值的一个位置。

![](img/f925739fbe32d3bc664d1122d9ad67ef_30.png)

这是一个这个码执行一下吧，你看这是大概这个位置。

![](img/f925739fbe32d3bc664d1122d9ad67ef_32.png)

我们是不是算出来了，可能通过啊，就是就是大家整体来看这个图就是绿色线啊。

![](img/f925739fbe32d3bc664d1122d9ad67ef_34.png)

都是不会去变的，然后这个蓝色线啊可能在不同任务当中，你看这里边可能等于60左右。

![](img/f925739fbe32d3bc664d1122d9ad67ef_36.png)

然后这个里边可能等于不到50，然后这种方法可能等于50多一点，可能不同方法咱得到的结果略微有些差异啊。



![](img/f925739fbe32d3bc664d1122d9ad67ef_38.png)

当然就是用两种方法都行，看你的一个实际任务需求吧，这也相当于是预处理方法当中的，不同的几种策略吧，到时候大家都可以我们自己来去做一些实验的。



![](img/f925739fbe32d3bc664d1122d9ad67ef_40.png)

主要就是三种吧，我给大家说完了，我们的第一步叫什么。

![](img/f925739fbe32d3bc664d1122d9ad67ef_42.png)

叫做一个诶一个去极值，注意点啊。

![](img/f925739fbe32d3bc664d1122d9ad67ef_44.png)

这个去极值不是给它丢掉，而是给它做一些规范，定义好一个下界和一个上界，然后呢，让所有数值保持在我们指定好的，下界和上界当中。



![](img/f925739fbe32d3bc664d1122d9ad67ef_46.png)

这就行了，这个是我们三步走当中啊。