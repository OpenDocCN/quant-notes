# 讲的太好了！2024最系统完整Python金融分析与量化交易实战教程，完整63个小节，附带配套代码数据集分享！ - P52：5-完成选股方法 - 默默无闻你路哥 - BV1izmqYZEMU

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_0.png)

接下来啊咱们来把这两张表给它做一个拼接操作。来我们写一下这块呢，我们要做一个拼接操作。拼接操作啊就是呃用一个data frame去转另外一个data frame就完事了。咱们把这个复制一下。

就是然我们这个当，然后呢我说它点啊，然后去转一下，转当中啊把我们第二d frame给它传进来，这就行了。好了，现在我们把两个da frame已经拼接起来了。那后我们给它起个新的名字了。

现在在这个daate frame当中啊，我们要做的其实上就是一个排名操作吧。好了，我们的指定名字叫做一个d状就可以。



![](img/3a408f2da7a23afc5ab9ec714b2e5f03_2.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_3.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_4.png)

好了，现在呢我们已经有了一个呃大表了，但是这个大表当中啊还没有咱们的一些排名的信息吧。在这块，我说我新建一个列啊，新建一个列，这个当中呢就叫做哎咱们现在排名的一个结果，我叫做一个得分值吧。

暂时先让这个得分值吧，它是一个都是零的。然后呢，我们把这个得分值实际啊给它计算出来。在这里我们就是哎这给我提示什么东西。😊。



![](img/3a408f2da7a23afc5ab9ec714b2e5f03_6.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_7.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_8.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_9.png)

这块我们传进来的就是呃指定好n派点接容当中，你矩阵的一个维度，我们指定成1个300乘1的就行了。这块就是一共有多少样本数据，然后接下来再写一个一，把这一列数据给它构建出来。那好了。

现在我们这一列已经构建出来了。但是这一列里边的数据啊全是一的。呃，我们得写一下这块呢，我们要去计算总分。



![](img/3a408f2da7a23afc5ab9ec714b2e5f03_11.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_12.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_13.png)

计算总分，然后并排序。现在呢我们每一个指标分都有了是吧？那接下来我要把这些指标的分啊给它合在一起了。好了，把它们计算一起计算一起啊，其实上我需要什么？就是哎我看一下当前比如说咱这六个指标嘛。

六个指标做一个加法算一个求和操作，这就完事儿了吧。好了，咱来写一下这块我看不上一下。

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_15.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_16.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_17.png)

然后呢，接下来我说把这个横着的，把它们其中一个一个的全部加到一起，行吧？加到一起。我说我取最后的一个总和，哎，这就完事儿了。然后呢，接下来我再对这个总和干什么，做一个排序的操作吧。好。

这里我说要做一个s values做一个排序。排序当中啊，现在哎你告诉我你要去败哪个指标了。那既然我们已经排序到一起了，那最后排序完之后，看们算完之后，咱得到什么score里边就是前面所有的累加吧。好了。

把这个score拿过来就行了。然后呢我们希望这个排序啊，它是升序还是降序，应该是一个降序吧。因为我们现在我们要找的什么排名最就是分数最高的哎，这些结果吧，所以说咱们指定成一个fo，我们要做一个降序。

好了，这就完事了。做完降序之后啊，现在我说呃给他一个返回值吧。

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_19.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_20.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_21.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_22.png)

这个就是我的一个date frame啊，把这个返回值咱们给它做出来了。行了，那现在我们已经得到了总分的一个结果。那接下来呃把这个东西直接叫做一个呃把这个其实我们不需要其他指标，我们只需要什么？

只需要它的一个s值就行了。把其中的一列拿过来。好了，这一列这是一个呃就是一个呃s。在这个serv当中，我们取了某一列。😊。



![](img/3a408f2da7a23afc5ab9ec714b2e5f03_24.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_25.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_26.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_27.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_28.png)

这个略达了之后接来，我说哦，你做一个返回吧，返回什么？哎，我们返回的是前十名那个得分啊，还是前十0名那个股票啊，我们要选的是前十名那个股票吧，就到这里。😊。



![](img/3a408f2da7a23afc5ab9ec714b2e5f03_30.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_31.png)

我们要把它的个inex，也就是股票给拿到手，并且呢给它to list一下。在这里我再取吧，取一个前十，那就是从0到10，哎，这就完事了。这样我们就完成了咱们当前啊就是呃get当中，咱们的基本操作了。

相当于啊第一步我们是去呃读我们的因子数据。短因子数据之后呢，对因子数据啊，我们做做一个打分操作，把最终啊打分结果，我说拼接起来，最终呢咱再完成一个排序。那现在啊它返回结果就是呃我ge当中你执行一次。

我们现在就你返回哎呀当前啊，就是当前某一天呢啊，当前的一些指标。然后它具体的前十是谁，我们就做完了吧。好了，这里我们的最关键的一个函数已经做完了，就是怎么样获取哎当前我的前十哎们的。



![](img/3a408f2da7a23afc5ab9ec714b2e5f03_33.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_34.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_35.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_36.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_37.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_38.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_39.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_40.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_41.png)

![](img/3a408f2da7a23afc5ab9ec714b2e5f03_42.png)