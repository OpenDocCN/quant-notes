# 【量化交易教程】全100集（完整版）清华大佬耗时一月讲完的系统python金融分析与量化交易实战课程，包含基础教程，进阶学习，项目实战案例讲解，存下吧，比啃书好 - P10：10.10.指标相关情况分析(Av1302064773,P10) - 萍乡树里女装 - BV1dx4y1q7iG

接下来啊咱们来看一下这个回率分析啊。说白了就是我现在要看一下变量之间啊有什么样的一个关系，或者说呢变量当中啊一些走势啊，一些呃我们刚才说的一些增长率之间啊有没有什么样的一个相互影响。

或者是相互的一些就是观点吧啊，咱们要做这样一件事儿。这里呢我给大家说一下我们这个流程。第一步咱们还是先选择两个指标啊，我们选一个FTS，还有一个VX一个标普，还有一个恐告系数啊。呃。

在这里我们第一步还是先把这两列给拿到手，就是我们现在啊有个data。之前我们不叫data2嘛，还是用这个data2吧，等于data2当中，把这两列的名字，我直接拿过来得了。😊。



![](img/242037812ac103a76366a2728ebec5f5_1.png)

啊，这两列是它的一个名字，然后这个名字，哎呀把这块稍微改一改，中间有逗号，然后名字我就给它引起来啊，这是第一个名字，然后后面这是第二个名字，然后这个名字啊还得多做一件事儿，他那个原始数据当中啊。

它是一个大写的，咱改一改，是一个大写的。然后这个它也是一个大写的，然后把数据啊打印下来看一看。

![](img/242037812ac103a76366a2728ebec5f5_3.png)

这样我只拿这两个数据来就行了。因为我们只观察它两个之间的一个关系，其他的我们就不用去看了。

![](img/242037812ac103a76366a2728ebec5f5_5.png)

![](img/242037812ac103a76366a2728ebec5f5_6.png)

好了，在这里我们就做完了，就是第一步先把数据给读过来。然后数据读完之后，然后这个索引目目前也都是没问题的。咱直接来往下去做。第一步啊，你说我要去展示他们之间的一个关系，做这个关系啊，其实还挺简单的吧。

最简单发什么？直接啊在图当中，我们把这个结果给它画出来，是不就完事了。好了，咱们来画图啊，在这个电影当中我们来看一下。



![](img/242037812ac103a76366a2728ebec5f5_8.png)

![](img/242037812ac103a76366a2728ebec5f5_9.png)

data里边，然后去proot一下pro当中啊去把当前两个结果传进去是不就行了，直接点proot一下。然后其实什么都不用写了，直接一画这个结果是不是出来了。但是这个结果出来之后啊，有一个小问题。

如果说你现在你说给它放到一个图当中，好像看不出来一个趋势吧。所以这块咱们还是得把这个东西啊给它s一下，当中放到我们两个图当中，咱们来指定一下，然后呢我们执行一下吧，这样当前结果我们就给它画出来了吧。

行了，这是我们第一步啊先把这个图，哎，我们已经给它画出来了。然后呢换图之后，其实我们以观察一下，那此时我们想看它这个指标好像挺难的。我唉正常情况下，我们不是看这个关系应该放到一个图当中嘛。

但是一个图我又给它描述不出来，那怎么办呢？之前啊咱们就给大家说一种方法可以干什么？在一张图当中，我可以哎既有一个左边的Y轴，我还可以再有右边的一个Y轴吧。这样我可以把它呀放到一个坐小系当中。而且。😊。



![](img/242037812ac103a76366a2728ebec5f5_11.png)

![](img/242037812ac103a76366a2728ebec5f5_12.png)

![](img/242037812ac103a76366a2728ebec5f5_13.png)

![](img/242037812ac103a76366a2728ebec5f5_14.png)

坐效界就放在一张图当中，但是呢它的结果哎会就是怎么说呢？给大家来画一下吧，画一下应该会更清晰一点。这样我们把这个数据啊重新来去指定一下。呃，还是我们data这个数据，然后我把这个多写个参数。



![](img/242037812ac103a76366a2728ebec5f5_16.png)

![](img/242037812ac103a76366a2728ebec5f5_17.png)

不光啊这回咱就不用这个soflo，然后直接指定我的一个呃坐标轴。咱们之前不说了嘛，在这里我可以去构建两个坐标轴。第二个我指定一个Y。然后呢，在这个Y当中啊，咱们来去写吧，咱们的Y指定成它的一个列的名字。

列的名字我们给拿第二个吧。我看第二谁啊，直接给它复制过来得了，指定好我的一个列的名字，然后呢，我再执行一下，咱来看结果，这个结果你是不是大概能看出一点趋势了。哦，这个结果可能看的趋势不是特别明显是吧？

再这样吧，咱为了使得这个结果太明显一些哎，再画一画。这个数据当中啊，你看它是从这个10年到18年，如果把8年数据画在一起，那这个东西里边的点太多了，是不是变化太多了，咱把它稍微选一选吧。

只选择其中的一部分数据，可以吧？比如说我只选择这么一年或者只选择这么两年的一个数据，那之前不是已经把这个日期当做一个缩引了嘛，我把这个数据读过来。😊。



![](img/242037812ac103a76366a2728ebec5f5_19.png)

![](img/242037812ac103a76366a2728ebec5f5_20.png)

![](img/242037812ac103a76366a2728ebec5f5_21.png)

![](img/242037812ac103a76366a2728ebec5f5_22.png)

![](img/242037812ac103a76366a2728ebec5f5_23.png)

啊，格式我来复制一下，然后把这个格式复制过来，我们自己来选。比如现在我只是想选择这个到这个12年德了，它是从这个10年开始，然后到这个12年年底吧，12月1个31号，然后呢，我们再画一下。

这个图看着有点小，呃，把这个图稍微画的再大一点。

![](img/242037812ac103a76366a2728ebec5f5_25.png)

或指定一个feer size。啊，指定一个别赛粉等于稍微大一点执行一下。

![](img/242037812ac103a76366a2728ebec5f5_27.png)

呃，看这儿它出现了一个报错啊，在这里哦点plot一下。

![](img/242037812ac103a76366a2728ebec5f5_29.png)

点完之后，还有报错，再来看一下什么问题啊。呃，他说当前这个label哎，这个当前这个东西它不是一个label啊哦，这块这块冒号完之后，它没有一个不是一个逗号，应该是它是一个区间啊，我们取这样一个数据。

不先写个逗号，然后再直接一下了，这回画出来了，那你看啊现在我们选了两年的一个数据，我们的一个变化幅度是不是就清晰一点了。哎观察一下吧，它们之间有什么结果，当这个SPS指标啊，我们来看一下。

当它变化的时候，如果在在在这个蓝色当中啊，SPX你看啊它发生下降的时候，这个BS怎么样上升了吧。你看这里它发生下降的时候，这里出现上升吧，这一块也是蓝色的下降，绿色的上升，蓝色的下降绿色的上升。

我们是不是可以通过画图啊，把这个结果观察出来啊啊，所以说最直接有效的方法直接去画画的过程当中啊，其实刚才我估意啊就是。



![](img/242037812ac103a76366a2728ebec5f5_31.png)

![](img/242037812ac103a76366a2728ebec5f5_32.png)

![](img/242037812ac103a76366a2728ebec5f5_33.png)

![](img/242037812ac103a76366a2728ebec5f5_34.png)

给大家多画了几步啊，其实正常我直接把这个一份代码写出来也行。但是呢我给大家说这样一件事，画图啊从来它都不是一蹴而就的啊，一般我们都先画一个最基本的，然后看一看有什么问题。有完问题之后，我们再想哎。

怎么去改进一下，再改进一下，能使得咱结果看起来更清晰一些吧啊，这是我们的第一种做法，直接。😊。

![](img/242037812ac103a76366a2728ebec5f5_36.png)

![](img/242037812ac103a76366a2728ebec5f5_37.png)

![](img/242037812ac103a76366a2728ebec5f5_38.png)

![](img/242037812ac103a76366a2728ebec5f5_39.png)

去画这样一个图，那还有没有一些其他方法能帮我去做呢？哎，刚才咱不是说了吗？我们要干什么，我们可以去画当前的哎一个回归分析吧。做回归分析之前，我们还得先把数据再处理一下。或者说呃先变数据数记了。

我们先把第二个图再给来画一画。其实这两不光可以画一个折线图，我们还可以画一个散点图是吧？画三点图的方法其实蛮多的，哎，再来带给大家来举一个例子。



![](img/242037812ac103a76366a2728ebec5f5_41.png)

比如这也这样呃，我说现在啊。我说现在咱指定一个结果，这个结果呢，咱们之前这个数据当中不有这两列吗？哎，记不记着咱之前说一种方法算什么？我说算那个增加率的时候啊啊，增长率的时候。

咱们用n派点 log的时候，然后用数据去做了一个除法吧。来，咱把那个再写一下nad点do一下。然后呢，我之前老说用这个data比上什么，比上一个data点shift是吧，shift当中哎给它。😊。



![](img/242037812ac103a76366a2728ebec5f5_43.png)

我给他那个往下滑一天手就得了。然后再把这个结果打印出来。

![](img/242037812ac103a76366a2728ebec5f5_45.png)

这是我们当前的结果，然后给它点head一下，打印出来啊，这个结果就有了。那有结果之后呢，咱接下来那你说该怎么样去把它的一个相关性给它描述出来呢？或者说怎么样通过画图。

能够说啊让我更清晰的去观察到当前的这个结果当中啊，它各自变量的关系，以及呢比如说变量的一个分布关系以及两两变量之间的关系呢？咱把这个图啊给大家来画一下。其实画的方法非常简单啊。呃。

咱用咱就直接用这个pada来去做了。其实还有一些其他额外工具包，像C本之类的，也能帮咱们去做啊，panda当中，我直接啊去pro一下。哦，只不过说它的API名字稍有变化啊。

prouting一下pro当中啊，我们要去选你要画什么样的图，这是两个数据吧，两两之间，我看它的变化情况不光折线图也可以，我用三点图是不是也行啊？这回咱把这个三点图给大家画出来啊，matres一下。

在这个三点图当中啊，它里边的一个参数相对来说比较多啊。第一个参数就是呃我们得写一下你把哪个数据给我传进去是吧？然后呢，第二个参数呃，因为三点图啊是这样，如果说你的数据点特别密集。

咱这个就属于数据点特别密集，那肯定很多点可能都会重叠在一起，咱得指定什么一个透明度啊，别让太多的点重叠在一起啊，你指定一个透明度，然后呢，接下来。



![](img/242037812ac103a76366a2728ebec5f5_47.png)

![](img/242037812ac103a76366a2728ebec5f5_48.png)

一会儿呢当咱们画图啊，它是一个2乘2的图啊，然后呢它会有对角线。在对角线当中啊，你可以去选啊，你是想画直方图，还是想画1个KTpl啊和密度估计？咱这里先拿这个直方图来给大家呃描述一下。

就是我们的一个在对角线当中，你去自己写一下，你要画什么图啊，现在大家可能说哎这个对角线是什么，不太了解，没关系啊，马上咱就给它画出来。



![](img/242037812ac103a76366a2728ebec5f5_50.png)

然后呢，这个直方图当中啊，呀，你也得指定它的一个QwordQword就是说啊我们都会涉及到哪些个参数，然后用字典的格式给传进来。对于直方图来说啊，你就得告诉我咱要做多少个bes。比如说啊做50个Bs吧。

平均的分成多少个块，分成多少个格，要做一个be词吧。最后咱指定一个ces，然后等于稍大的一个图啊，就行了。这个就是我们当前啊得到的一个几啊还没得到ze，这个就是我们当前啊把这个图我要去画一下。

然后来执行一下。

![](img/242037812ac103a76366a2728ebec5f5_52.png)

![](img/242037812ac103a76366a2728ebec5f5_53.png)

好了，折完之后来看下这个结果吧。刚才咱是不是对角线了，这是不是就对角线啊，对角线当中啊描述的就是呃一个图自己和自己，你看这里这是点SPSX吧，这是点SPS吧。所以说中间的这一块是谁呀？

就是SPS这个指标它的一个直方图，直方图啊，其实呃有两种画法，也不是两种画法吧，就是对角线当中啊，大家可能现在看的是一个直方图，哎，我知道什么意思。但是其实啊就是当我们画的过程当中还有一种图啊。

是一个就是怎么说，还有一种图画的更好看一点，给大家来看一看，我直接复制一下。😊。

![](img/242037812ac103a76366a2728ebec5f5_55.png)

你把这个参数啊稍微改一改，我改成1个KDpro KDE当中不需要这个参数了，然后再执行一下。

![](img/242037812ac103a76366a2728ebec5f5_57.png)

![](img/242037812ac103a76366a2728ebec5f5_58.png)

你看这个结果变成什么了？哎，变成了一个很平滑的一个曲线吧。这个叫合密度估计啊，它是怎么做的？呃，大概的做法就是呃其实它俩的一个趋势是一个类似的。你看当前这个趋势和这个直方图画出来结果是类似的吧。

其实它是这样。😊。

![](img/242037812ac103a76366a2728ebec5f5_60.png)

就是把你当前这个图啊啊这不是分成一个bins吗？那你想如果你能分成1万个bins，或者说分的bins越多，你当前得到的这个曲线就接近于这个曲线是不是会越光滑呀啊，大概就这样一件事。

所以说到时候画图的时候，呃，你愿意画这个KD也行，愿意画这个一个直方图也行啊，通过这个图咱可以去观察啊，什么？其实这两个三点图是类似的，观察谁啊，就是当前我们这两个指标，如果说在三点图当中。

它的一个趋势是什么，肯定是负相关的吧。咱之前哎在这张图当中，我刚才说给大家看了，你下降人也增加，你下降人也增加。咱通过这张图是我观察来的，但是散点图当中是不是会更清晰的帮我把这件事给它做出来啊。

所以说啊到时候大家来做分析或者观察的时候啊，至于具体用什么图，无所谓啊，选择一个看起来舒服的就行。哎，那你说这个图现在舒服吗？😊。



![](img/242037812ac103a76366a2728ebec5f5_62.png)

![](img/242037812ac103a76366a2728ebec5f5_63.png)

![](img/242037812ac103a76366a2728ebec5f5_64.png)

![](img/242037812ac103a76366a2728ebec5f5_65.png)

![](img/242037812ac103a76366a2728ebec5f5_66.png)

![](img/242037812ac103a76366a2728ebec5f5_67.png)

好像差点，你说还差了点啥呀？哎，这个图当中啊，如果说你说你画了一个这个三点图，你再给我画一个回归方程行不行？给我画一个回归方程往这一看，或者说你把这回归系数告诉我，我是不是一打眼儿，我就能知道。

哎呀这个当前他们之间的关系长什么样子啊。所以说接下来哎咱们周一说到了怎么样去构建我的一个回归方程。

![](img/242037812ac103a76366a2728ebec5f5_69.png)

![](img/242037812ac103a76366a2728ebec5f5_70.png)