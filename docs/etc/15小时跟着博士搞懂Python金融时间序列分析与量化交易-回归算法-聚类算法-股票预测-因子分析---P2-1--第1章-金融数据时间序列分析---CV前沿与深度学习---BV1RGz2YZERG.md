# 15小时跟着博士搞懂Python金融时间序列分析与量化交易！回归算法、聚类算法、股票预测、因子分析 - P2：1.第1章：金融数据时间序列分析 - CV前沿与深度学习 - BV1RGz2YZERG

这节课来给大家说一下怎么样用python去做金融时间序列的分析。先给大家看一下咱们的数据啊，来理解一下这个时间序列啊，它是长什么样子。好了，打开一下我们的数据啊，在数据当中啊，大家很明显能看到啊。

有很多个列。一个来说吧。第一点叫做一个我们的日期吧。那你说啊我们的时间序列，肯定随着时间，它要发生一些变化吧。这个时间啊可以是按天的按周的按月的按年的，按什么都行，只要我们的数据是随着时间发生变化的。

哎，我们就可以管它叫做一个时间序列。好了，这是我们的数据啊当中哎有某些天的一个指标，从这个10年啊一直往下去统计，统计了好多啊，一直到这个18年的一个中旬，统计什么呢？

都是啊各个股市当中一些指标给大家来看一看，有这个苹果的股价，还有这个微软的，还有亚马逊的啊，还有一些其他公司的股价。后面呢还有各种各样的一些其他指标。这指标可能啊比如说一些黄金价格啊。

还有一些就是交易的。😊，央指数，还有货币兑换的一个汇率之间的一个变换。这些指标如果大家不太熟悉，哎，没看我这些缩写也没关系啊，咱们主要是以前几个股价来给大家举例子啊。

看一看怎么样python去操作咱们的时间序列去做一些计算，还有统计的工作。这个啊是我们现在拿到的一份数据。然后呢接下来我们要对数据啊做很多种操作。在操作过程当中啊。

我们讲解的这样你看这块我已经把咱们每一个模块给大家列出来了，并且每个模块当中我列出来了这么1234，哎可能有几点，每一点啊都是我们一步一步要去完成的一些小任务。

那咱们啊也是按照我现在列出来这个啊就是一个步骤吧，或者说按照我们列出来的要完成一项一项小任务，咱把这件事啊给它做出来。好了，我们一个去写啊首先第一步导入这个工具包，这我都不用说了。

导入啊一些最基本工具包。咱之前讲的太多了。好了，第一步咱们要导数据，并且呢我们在导数据的过程当中啊要怎么样。



![](img/e4e44a45d00b773a4da1331957125503_1.png)

![](img/e4e44a45d00b773a4da1331957125503_2.png)

![](img/e4e44a45d00b773a4da1331957125503_3.png)

![](img/e4e44a45d00b773a4da1331957125503_4.png)

![](img/e4e44a45d00b773a4da1331957125503_5.png)

看这里写了，不光我们要导数据，你看第一点写个要求要什么以时间为索引吧。那这回那我们来写一下吧，首先我们去read一下这个CSV是吧？data第CSV。然后呢我们需要指定一个参数。

这个参数啊要帮我们去指定一下，就是当前你是以谁为索引吧。好了，我把这个参数啊写进去，就是我们的一个indexindex当中啊需要你去指定用哪个列当做我们的索引吧。那好，看一下我们的一个数据吧。

在我们当前这份数据当中啊，我们可以来观察一下这份数据里边，你看啊现在这个时间它是第几列啊，是不是恰好第一列啊，所以说咱现在直接啊拿这个第一列当做我们的索引是不是行了。好了。

指定好当前你要用谁当做索引的那接下来呢我还说了哎有咱们第二点，第二点说把这个时间啊转换成一个标准的格式。那你看在我们这个数据当中啊，可能这个时间的格式，哎，它就是用一些杠来表示的。

跟我们哎就是接下来要处理的一个时间数据格式，可能还不是特别一样啊。这里哎给大家说一下，有一个表方法的，比较简单的方法，在这块可以怎么样直接的加上一个参数去处理什么，处理一下我们的一个日期数据。

把它呢指定成一个处值啊，就可以了。这样咱们现在读建来数据，我把这个再稍微放大一点。

![](img/e4e44a45d00b773a4da1331957125503_7.png)

这样咱们现在再读建来这个数据啊，它就是一个标准的一个时间格式。我执行一下，咱们来看一看。好了，第一步我们读数据。那你看现在我们展示出来的一个结果怎么样，是不是按照我咱之前的一个要求来展示出来了啊。

1月1日这块它都是乱值啊，应务数据当中啊，1月1日当中啊，确实都是你看都是空值吧，只有个别几个指标有值。然后下面呢在这个1月4号、5号、6号，咱们结果全出来了吧，并且我们来观察一下。

你看这个daate它是不是当做是我们的一个索引的呀？好了，这里给大家啊完成了我们前两步，以时间为缩引，并且呢我们把这个格式转成了标准的格式，只用一个名字吧，叫做一个data。



![](img/e4e44a45d00b773a4da1331957125503_9.png)

![](img/e4e44a45d00b773a4da1331957125503_10.png)

![](img/e4e44a45d00b773a4da1331957125503_11.png)

啊，指令完data之后，然后为了让大家看舒服点，在这块还是点害一下啊，这是我们的一个数据。有数据之后呢，我们来看第三个问题，数据啊咱可以很轻松的我就给它做出来。那下面当我想去做一个展示的时候。

那你看他说了绘制一下，啊就是绘制展示各个指标的一个走势情况。哎，各个指标，丢哪哪些个指标，这是一个指标就是一股价，这个股价，这个股价，这个股价还有四个公司股价后面呢还有各种指标。

我们希望在图当中都给它描述出来，该怎么办呢？呃，先给大家说用最简单的方法啊，paas当中啊有一个内置的点plot一下。😊。



![](img/e4e44a45d00b773a4da1331957125503_13.png)

![](img/e4e44a45d00b773a4da1331957125503_14.png)

blo就我要画图了，然后呢你可以去指定当前咱这个图它的一个大小我也指定的稍微大一点。指另外它的大小之后，然后咱先来看一看吧，画完之后它的一个结果哦，你看这里把这个结果呃画出来了。

但是这个结果跟我们要求好像有点不太一样。你看我们刚才要求啊就是要展示各个指标走势情况啊，其实这里也是各个走势，但是我能不能把各个走势给它分出来呢？也可以吧，在这一块，你可以再加上一个参数。

如果说你想把它画到一个图里，那你什么参数都不用加了。如果说你想把它呀按照一个子图的形式做展示，你可以加上一个subose啊，给它指定成一个触值，我们来观察一下。😊。



![](img/e4e44a45d00b773a4da1331957125503_16.png)

![](img/e4e44a45d00b773a4da1331957125503_17.png)

![](img/e4e44a45d00b773a4da1331957125503_18.png)

![](img/e4e44a45d00b773a4da1331957125503_19.png)

![](img/e4e44a45d00b773a4da1331957125503_20.png)

指定完之后，你看这一回我们这个指标，第一个走势，第二个第三个第四个啊，第五个走势全部展示出来了吧。当然啊就是具体哎用哪种方法看大家自己的喜好，同一图当中你要做对比也行。你按照一条线一条线去画。

这也没问题啊。这个是我们现在把当前结果做了一个基本的展示。好了，看一下我们当前这份数据给大家先做了基本的一个演示的操作，导入数据啊，对我们来说没有什么太大的难点啊，画图啊。

你用pl用还是用das当中内置的这些都行啊，没有一些限制要求，喜欢用哪个再用哪个就得了。然后这一块就是我把数据当中啊一些指标给大家列出来了。你看有这个苹果的股价，微软的股价啊。

还有几个就是则数都是几个排在最前面的股价最高的一些公司啊。下面还有一些它实际的一些走势汇率的，还有黄金的指标，大家感兴趣简单参考就行。好，我们说第二个第二个呢我们要做一个。😊。



![](img/e4e44a45d00b773a4da1331957125503_22.png)

![](img/e4e44a45d00b773a4da1331957125503_23.png)

![](img/e4e44a45d00b773a4da1331957125503_24.png)

![](img/e4e44a45d00b773a4da1331957125503_25.png)

![](img/e4e44a45d00b773a4da1331957125503_26.png)

![](img/e4e44a45d00b773a4da1331957125503_27.png)

![](img/e4e44a45d00b773a4da1331957125503_28.png)

![](img/e4e44a45d00b773a4da1331957125503_29.png)

统计分析了做统计分析啊，其实最直接的我们可以先做什么。

![](img/e4e44a45d00b773a4da1331957125503_31.png)

拿到数据之后，你可以先看一下数据的一些基本信息吧。比如说数据当中啊有多少个样本啊，这里有2216个啊，116条也相当于2000多个样本。然后我们的索引是从这个呃10年的1月1号到这个18年的6月29。

可能不是每一天数据都有啊，这是咱们当前拿到的指标，然后客指标都是fflow64类型的啊，都有是吧？然后这块可能有些指标当中啊有一些缺失值。你看呃最多的是2138个。

然后最少的呃呃不是最多的可能是2200多个，最少的是2100多个啊，这个是咱们大部分数据当中都存在，那么几十个缺失值。



![](img/e4e44a45d00b773a4da1331957125503_33.png)

![](img/e4e44a45d00b773a4da1331957125503_34.png)

![](img/e4e44a45d00b773a4da1331957125503_35.png)

好了，我们再来看在这个任务当中啊我们来看一下吧，他又要我们做什么。我说第一步啊，我要在数据当中啊啊各项指标的一个统计结果。那各项指标都有什么统计结果啊，你可以去统计哎。

当前呃它那个就是不为零的一个样本有多少个，它的均值，它的一个标准差，它的中位数最大值最小值是不是都能统计啊，这个方法鼠标简单，咱之前给大家说过。

直接对我们的de frame啊进行一个什么点describe就可以了吧。在这样点describe过程当中，我们还可以设置啊不是设这参数可以对它加一个限制。你看这里如果我直接点describe完之后。

你看这里啊它这块小数点后都有多少位，那个123456哇，这个位数太多了。你说实际当中我们可能不固含注分以下的结果了吧。那怎么办呢？你看这里我要求了小数点后，我说只保留两位数不就行了。

在这一块如果说你想对小数点哎做一些操作。😊。

![](img/e4e44a45d00b773a4da1331957125503_37.png)

![](img/e4e44a45d00b773a4da1331957125503_38.png)

![](img/e4e44a45d00b773a4da1331957125503_39.png)

![](img/e4e44a45d00b773a4da1331957125503_40.png)

![](img/e4e44a45d00b773a4da1331957125503_41.png)

咱怎么办？你加一个round啊，指定一个小点后几位，我看这个要求是几，这里要求它是一个呃这里后两位即可是吧？所以这块咱指定一个2就行了。你看我指定完二之后再来执行一下。



![](img/e4e44a45d00b773a4da1331957125503_43.png)

![](img/e4e44a45d00b773a4da1331957125503_44.png)

![](img/e4e44a45d00b773a4da1331957125503_45.png)

现在这个结果怎么样，是不是看着比刚才清晰一点了？因为小数点后嘛，咱这个结果没有那么多了，是不是啊？这个是当前打印出来了啊，我们各个维度的一个统计指标值，你看有它的一个个数啊，有它的一个均值。

有这个标准差，然后最小值，然后最大值，然后这个四分啊4分之1然后2分之14分之3的这些结果咱是不是全有了，这个是我们做了一个基本的统计的操作。然后呢，我看这块接第二个要求啊，第二个要求就是用聚合的方法。

将多种的统计指标汇总，那给大家看看吧，都有哪些种统计的方法。

![](img/e4e44a45d00b773a4da1331957125503_47.png)

![](img/e4e44a45d00b773a4da1331957125503_48.png)

![](img/e4e44a45d00b773a4da1331957125503_49.png)

![](img/e4e44a45d00b773a4da1331957125503_50.png)

最常见的或者说大家最能想到的就是对数据点密一下，点密完之后，你可以打印出来。哎当前各个维度，它的一个什么什么就是当前这个维度，找各个指标的一个结果吧。不管点密，然后点STD。

然后点那个最大max mean是不是都可以啊，那怎么样把这些指标我展示到一起啊，你看这块给大家列了，哎，有一个函数是吧？其实呃你方法有挺多的那既然这块也列出来了。

咱用当前的哎这个最个的方法去做一个指标的汇总，那来直接指定一下吧，对于我们的data你要只用什么操作，把各个你统计的指标给我汇总起来，那汇总的过程当中啊，你就要去在这里写进来了，你希望有哪些个指标。

你是不得告诉我啊，咱写些常见的吧，那最小值啊是各最常见的，然后呢最大值也是比较常见的吧，最小值啊，然后最大值然后还有什么？😊。



![](img/e4e44a45d00b773a4da1331957125503_52.png)

![](img/e4e44a45d00b773a4da1331957125503_53.png)

![](img/e4e44a45d00b773a4da1331957125503_54.png)

![](img/e4e44a45d00b773a4da1331957125503_55.png)

![](img/e4e44a45d00b773a4da1331957125503_56.png)

还有这个n当中的，我可以计算各种各样指标啊，一个均值，然后再来一个n点一个标准差。然后我看还有什么，还有一个呃中位数是吧？把这几个指标，咱先展示出来，然后我执行一下执行完之后呢。

你看这里是不是列都是我刚才选出来的各种各样指标吧，然后呢这一块你看统计出来的最小值最大值均值STD啊，还有一个周位数是不是咱结果全都有了啊，我们可以用当前这个最位函数，把你想要统计哪些个指标。

你全放到一起，是不是也行啊，你可以不用啊参照这个describe当中，可能有些指标你不要你只想选择其中一部分是不是也行啊，自己来写自己来列啊，想选什么，咱就选什么，是不是就可以了。好了。

这个就是我们的一个基本的统计的操作啊，还是比较简单的。在参当中啊，基本上很多操作吧，一两行代码咱就全给它解决掉了。



![](img/e4e44a45d00b773a4da1331957125503_58.png)

![](img/e4e44a45d00b773a4da1331957125503_59.png)

![](img/e4e44a45d00b773a4da1331957125503_60.png)

![](img/e4e44a45d00b773a4da1331957125503_61.png)

![](img/e4e44a45d00b773a4da1331957125503_62.png)

![](img/e4e44a45d00b773a4da1331957125503_63.png)

![](img/e4e44a45d00b773a4da1331957125503_64.png)

![](img/e4e44a45d00b773a4da1331957125503_65.png)