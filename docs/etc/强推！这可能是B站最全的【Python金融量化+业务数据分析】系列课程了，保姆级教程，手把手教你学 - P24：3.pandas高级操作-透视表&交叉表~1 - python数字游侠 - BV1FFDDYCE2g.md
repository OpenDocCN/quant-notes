# 强推！这可能是B站最全的【Python金融量化+业务数据分析】系列课程了，保姆级教程，手把手教你学 - P24：3.pandas高级操作-透视表&交叉表~1 - python数字游侠 - BV1FFDDYCE2g

那么这一小节的话，咱们就把pandas高级操作的内容呢，给它进行这个讲解哈，那么这一小节我们就能够讲完啊，然后这一小节咱们主要讲解的内容呢，就是我们所谓的交叉表跟我们的透视表。

但是呢在交叉表跟透视表之前呢。

![](img/b7f33f58209d17ec807b3239942d5aff_1.png)

我们把这个数据加载啊，我们再过一遍啊，再过一下，因为在这块的话需要有那么几个小点。

![](img/b7f33f58209d17ec807b3239942d5aff_3.png)

需要我们单独的去注意一下，OK吧，那首先在这的话我们看一下啊。

![](img/b7f33f58209d17ec807b3239942d5aff_5.png)

在这个data文件夹当中，它有一个文本文件叫做type杠点TXT。

![](img/b7f33f58209d17ec807b3239942d5aff_7.png)

看见了吗，这里边的话有三，你看一下有三行数据。

![](img/b7f33f58209d17ec807b3239942d5aff_9.png)

是不是我们在这的话，首先第一个需求，我们需要将数据呢给它进行一个读取，那咱们读取一下呗对吧，pd点read杠CSV好，在data文件夹下边有一个type，是不是t y p e type杠点TXTY好。



![](img/b7f33f58209d17ec807b3239942d5aff_11.png)

把它进行一个读取走，你看读完之后，各位看一下，那么读取出来的这样的一个data frame。

![](img/b7f33f58209d17ec807b3239942d5aff_13.png)

它是有几行几列呢，几行几列，有同学说有两行三列是吧，那这到底是怎样的一个形状呢，这看一下吧。

![](img/b7f33f58209d17ec807b3239942d5aff_15.png)

会发现这是不是两行一列呀对吧，并且你会发现，看一下是不是我们文本文件当中的第一行。

![](img/b7f33f58209d17ec807b3239942d5aff_17.png)

作为了咱们的这个data frame的列索引。

![](img/b7f33f58209d17ec807b3239942d5aff_19.png)

这样显然是不对的，对不对，那我们遇到这样的情况怎么去办呢，对吧，那接下来我们就来给它进行一个处理，怎么处理呢，首先将我们的这个是我们的第一行，不要让它作为我们的列索引吧，并且我们想把每一个词。

作为我们data frame当中的一个元素，那就是说需要把data frame变成一个三行，三列的一个形状，是不是这怎么去玩呢，好，那在这的话你会发现每个词中间的一个分隔符，是一个减号，而不是空格。

也不是逗号，是不是对吧，那在这的话我们就可以这样p DDR read杠CSV，在这的话我们需要添加这么几个参数啊，首先是路径是吧，路径type杠点TXT，然后哈在这的话我们先加一个header。



![](img/b7f33f58209d17ec807b3239942d5aff_21.png)

等于一个什么呢，now走。

![](img/b7f33f58209d17ec807b3239942d5aff_23.png)

你看一下header等于now，那么意味着我们原始的这个你好我好，他也好，就不再是我们的列索引了是吧，而变成了我们的一个元素是吧，但是呢你看这块的话还是什么呢，还是我们的三行一列。

是不是怎么给它进行一个，三行三列的一个拆分呢，那在这的话，想把每个词作为我们的一个元素的话，那么词跟词之间的分隔啊，风格是谁呢，分格是不是减号啊，SEP让它等于减号就可以了。

走Y现在这块是不是就变成了三行三列呀，它的行列索引都是默认的吧，默认的隐式索引都是012，是不是OK吧，那在这的话你需要记着这个header跟我们的sap，这两个参数的作用，OK吧好。



![](img/b7f33f58209d17ec807b3239942d5aff_25.png)

那下边的话咱们就来看一下，如何从数据库当中加载数据吧。

![](img/b7f33f58209d17ec807b3239942d5aff_27.png)

OK吧，那首先在我的这个什么呢，data文件夹当中有一个啊，有一个这个数据仓库啊，叫做weather杠，2012点circle net。



![](img/b7f33f58209d17ec807b3239942d5aff_29.png)

可以吧对吧，我们就想把这个数据仓库当中的一张表的数据，读取加载到我们的data frame当中，OK吧，那怎么去玩呢，那首先在这儿我们得先去创建一个链接对象吧，对吧。

那这块我用的是circle light数据库，你也可以加载读取别的类型的数据库吧，比如说MYSQL对吧，oracle都是可以的吧对吧，那第一步你首先你得需要创建一个连接对象吧，好。

那我这加载一下另一个对象就创建好了吧对吧，那接下来我就pd点read杠SQL是不是就可以了对吧，那它需要传两个参数参数，一是C口句分数。



![](img/b7f33f58209d17ec807b3239942d5aff_31.png)

二是我们的链接对象，是不是OK吧，那在这传完之后，我们去执行走，你那是不是读取出来。

![](img/b7f33f58209d17ec807b3239942d5aff_33.png)

我们数据仓库当中的一张表啊对吧，将这个表当中所有的数据是不是都读出来了。

![](img/b7f33f58209d17ec807b3239942d5aff_35.png)

OK吧好不光能读数据，我们还可以把我们data frame当中数据啊。

![](img/b7f33f58209d17ec807b3239942d5aff_37.png)

写到这个数据库里边，那怎么写呢，你看一下前边这块有一个data frame。

![](img/b7f33f58209d17ec807b3239942d5aff_39.png)

是不是叫DF啊。

![](img/b7f33f58209d17ec807b3239942d5aff_41.png)

DF是吧，我们就把我们刚刚读取出来的这个data frame，是不是写到数据库里边。

![](img/b7f33f58209d17ec807b3239942d5aff_43.png)

怎么写呢啊这就是DF点to SQL，是不是把它写到哪啊对吧，我们数据库的库表起个名叫456，可以吧，那就是说将这个DF啊所对应的数据，是不是写入到这个链接对象，所表示的数据库里边对吧。

那库表的名字就叫做SQL杠data456走，你那这样就写入了，同样你也可以通过这个read跟SQL的方式，把它读出来，看一下有没有写入成功吧对吧，这一定是可以写入成功的，那这块的话就是演示了。



![](img/b7f33f58209d17ec807b3239942d5aff_45.png)

如何从数据库当中读取加载数据吧，OK吧好。

![](img/b7f33f58209d17ec807b3239942d5aff_47.png)

那这个唯一需要我们注意的地方，就是说这块的你的链接对象的创建方式，不同的数据库，创建链接对象的创新方式是不一样的，是不是OK吧，那如果是MYSQL，我们是不是用那个PYMYSQL这样的一个模块。

去创建我们的内容对象啊。

![](img/b7f33f58209d17ec807b3239942d5aff_49.png)

OK吧好，那么还有一点就是说，如果你这块哈这块，如果你这个创建的是一个MYSQL的链接对象，那你如果想把我们的一个date frame，写到MYSQL当中的话。

那这块你所用的数据库的引擎P得是surf orgmy，否则你的这个表是写不进去的，OK吧这块你单独注意一下就可以了啊。



![](img/b7f33f58209d17ec807b3239942d5aff_51.png)

好那么数据加载完事之后呢。

![](img/b7f33f58209d17ec807b3239942d5aff_53.png)

下边的话就是咱们的透视表了啊，透视表是咱们今天的一个重点，OK吧是今天的重点。

![](img/b7f33f58209d17ec807b3239942d5aff_55.png)

那这个透视表呢，各位啊，你用过excel啊，用过excel，那你会知道excel，可以很便捷的帮我们去实现透视表的功能，是不是在excel中是可以实现透视表的，那么这个透视表是什么呢。

透视表是我们做报表的一个神器吧对吧，做报表的一个神器啊，那么这个透视表，它其实是一种可以对数据动态排布，并且分类汇总的一个技术对吧，他主要是做分类汇总的吧对吧，这个分类汇总啊。

就跟我们之前所学的那个group by分组是差不多的，分组完了之后也需要做汇总，需要做聚合是吧，那我们的透视表是一样的，它是做分类汇总啊，它是这样的一个技术，OK吧，那这个透视表它有很多优点啊。

优点的话我们就不一一的去讲解了啊，这个我们在excel里边一定是用过透视表的，是不是OK吧。

![](img/b7f33f58209d17ec807b3239942d5aff_57.png)

那这样我们就来看一下在我们的pandas当中，怎么去实现我们的透视表吧对吧，在pandas当中如果想实现透视表的话。



![](img/b7f33f58209d17ec807b3239942d5aff_59.png)

我们需要调用一个方法叫做pivot gtable，那么调用它就是表示我们可以去使用，pandas当中给我们封装好的透视表相关的操作，OK吧，那咱们就去试一下吧。



![](img/b7f33f58209d17ec807b3239942d5aff_61.png)

首先在这的话我先去读取一组数据啊，你看这一组数据的话，它大概一共有25行吧对吧。

![](img/b7f33f58209d17ec807b3239942d5aff_63.png)

25行，这么这么这么2468十列数据吧对吧，然后每一列各位看一下它的一个含义。

![](img/b7f33f58209d17ec807b3239942d5aff_65.png)

能够自己理解哈，自己理解，那现在这一组原始数据有了，那下边的话我们就来看一下。

![](img/b7f33f58209d17ec807b3239942d5aff_67.png)

那使用我们的透视表对应的技术，如何对我们这一组原始的数据实现分类汇总吧。

![](img/b7f33f58209d17ec807b3239942d5aff_69.png)

对吧，如何对它实现分类汇总好，那这样的话我们就重点来看一下，这个PVOTGTABLE这样的一个方法怎么去用，OK吧。



![](img/b7f33f58209d17ec807b3239942d5aff_71.png)

那首先在这的话我们可以使用我们的什么呢，这个data frame叫什么。

![](img/b7f33f58209d17ec807b3239942d5aff_73.png)

是不是叫DF啊对吧，d f d r put杠table。

![](img/b7f33f58209d17ec807b3239942d5aff_75.png)

OK吧，那这里边的话看一下它有四个重要的参数需要，我们必须得理解，第一个是VOLUES，第二个index，第三个columns，第四个a j j funk，这四个参数我们理解了。

那么这个透视表我们就能用了啊，就会用了，OK吧，那怎么理解呢，首先先看我们的第一个参数叫做index，对不对，看index啊，这个index是我们分类汇总的一个条件，OK吧。

index是我们分类汇总的条件，那么分类汇总需要条件，那么我们之前所讲的分组聚合，是不是也需要条件啊，对吧好，那这的话我们就知道啊，index它是分类汇总条件，那么我们的PVOT杠table。

在使用的时候必须要有一个什么呢，index就是必须要有一个分类汇总的条件吧，OK吧好，那这我们就来看一个需求吧，我们现在想看一下什么呢，对阵同一对手在不同主客场下的数据啊。

那这个分类条件为对手和主客场看这啊。

![](img/b7f33f58209d17ec807b3239942d5aff_77.png)

比如说哈现在这组原始的数据当中。

![](img/b7f33f58209d17ec807b3239942d5aff_79.png)

它有很多队，对不对，一共大概有这个十几个对吧对吧，十个有十几个队啊。

![](img/b7f33f58209d17ec807b3239942d5aff_81.png)

那现在我们想干嘛呢，现在我们就想看一下这个哈登，哈登这个队的话是不在我们原始数据当中的吧。

![](img/b7f33f58209d17ec807b3239942d5aff_83.png)

你看对手里边没有哈登吧，如果哈登想跟我们这一组数据当中的。

![](img/b7f33f58209d17ec807b3239942d5aff_85.png)

这些个队需要比赛的话，那么在这我们就想看一下什么。

![](img/b7f33f58209d17ec807b3239942d5aff_87.png)

看一下这个哈登对症啊，对症不同对手在不同主客场下的数据，那这块的话我们就想看一下什么呢，看一下我们分类汇总的话。



![](img/b7f33f58209d17ec807b3239942d5aff_89.png)

是不是需要对我们的这个对手做分类汇总啊，对吧，分类汇总完了之后，我们分类是对我们的这个对手做分类汇总呢，是不是我们想要汇总这个什么呀。



![](img/b7f33f58209d17ec807b3239942d5aff_91.png)

汇总我们的这个分数啊，你看除了对手之外，你看这块是不是有他的投篮数啊，三分的命中率啊，篮板助攻得分是不是有各种各样不同的分数啊。



![](img/b7f33f58209d17ec807b3239942d5aff_93.png)

我们就想看一下，那如果哈登啊在这儿，如果我们的哈登，想哈登这个对阵每一个队伍的得分啊，如果想看哈登对阵每一个队伍得分的一个，详细情况的话，那这块我们就可以在这去实现一下，首先index index。

那这块的话，我们的分类条件就是我们的对手跟主客场吧，因为我们这看一下需求啊。

![](img/b7f33f58209d17ec807b3239942d5aff_95.png)

想看看对阵就是想看看我们的哈登是不是啊，想看看哈登哈登这个队啊，哈登这个队对阵同一对手，在不同主客场下的数据啊。



![](img/b7f33f58209d17ec807b3239942d5aff_97.png)

这个数据是什么呢，这个数据是各种的分值吧对吧，比如说我们这的这个什么的篮，这投篮数的三分命中率了，什么助攻篮板了，是不是还要得分。



![](img/b7f33f58209d17ec807b3239942d5aff_99.png)

这些是我们对应的数据吧对吧，就想看哈登对阵同一对手，在不同主客场下的数据，那么这块我们分类汇总，那么分类的条件应该是，我们的对手跟主客场是两个条件啊对吧，那这咱们就写一下呗，首先第一个条件应该是什么呢。

应该是我们的这个对手是吧，这首好，那么第二个条件啊，第二个条件的话应该是我们的什么主客场吧。

![](img/b7f33f58209d17ec807b3239942d5aff_101.png)

不是主客场啊对吧，看一下这有主客场这一列吧对吧，对手跟主卧长这两类是不是都有啊。

![](img/b7f33f58209d17ec807b3239942d5aff_103.png)

那这我们的这个分类条件是不是可以是什么呀，是不是可以是两个呀对吧，那我们想一下之前我们在分组的时候，那么我们分组条件能不能是两个呢，也可以吧，也是可以的啊，好那在这的话我们就来执行看下结果吧。



![](img/b7f33f58209d17ec807b3239942d5aff_105.png)

走看一下现在这块的汇总的数据有了是吧。

![](img/b7f33f58209d17ec807b3239942d5aff_107.png)

如果哈登想对阵七六人的话，那么这个七六人在主场的数据是这些数据吧，对不对，在客场的数据是不是这些个啊对吧，如果对阵勇士的话。



![](img/b7f33f58209d17ec807b3239942d5aff_109.png)

勇士他是没有主场的数据，是不是只有客场数据啊，对不对啊，小牛只有主场的没有客场了，对不对啊，那这个开拓者是不是只有客场没有主场啊对吧。



![](img/b7f33f58209d17ec807b3239942d5aff_111.png)

那在这的话我们就知道参数一，它是我们分类汇总的一个什么呢。

![](img/b7f33f58209d17ec807b3239942d5aff_113.png)

分类的条件吧对吧，分类条件可以是一个，也可以是多个吧对吧。

![](img/b7f33f58209d17ec807b3239942d5aff_115.png)

那么这个是我们的参数一，叫做index所表示的含义吧，OK吧好那么再看我们的第二个参数叫做values。



![](img/b7f33f58209d17ec807b3239942d5aff_117.png)

它所表示的含义是什么，那这我们来看一个需求。

![](img/b7f33f58209d17ec807b3239942d5aff_119.png)

如果我们只需要看哈登在主客场合，不同胜负情况下的得分篮板，助攻这三项数据很明确，我们看的是得分篮板助攻这三项数据吧。



![](img/b7f33f58209d17ec807b3239942d5aff_121.png)

那刚才我们得到的是不是三分命中率。

![](img/b7f33f58209d17ec807b3239942d5aff_123.png)

助攻命中得分等等这么多个数据啊对吧，那现在我们想看的数据啊，值有三个得分篮板跟助攻吧，那这个怎么去实现呢，就用我们的values就可以了，DF点什么呢，pivot table好。

那这块我们先看一下分类的条件是什么呢，分类条件是说，只需要看哈登在主客场和不同胜负吧，对不对，那就是主客场和谁呢。



![](img/b7f33f58209d17ec807b3239942d5aff_125.png)

不同胜负，那胜负是哪一列呢。

![](img/b7f33f58209d17ec807b3239942d5aff_127.png)

看一下啊，那这块的话有没有胜负呢，是不是有啊，对吧好，它也作为我们的一个分类的条件啊。

![](img/b7f33f58209d17ec807b3239942d5aff_129.png)

现在如果执行的话，我们拿到的是不是三分命中率，助攻命中得分等等这么多项数据啊，那现在我们只特定想要的是得分篮板和助攻嘛，那怎么办呢，在这就需要加上我们的values，OK吧。

你看values是需要对计算的数据进行筛选对吧，那我们只需要得到什么数据啊，不是只需要得到得分对吧，还有什么呢，这个篮板对吧。



![](img/b7f33f58209d17ec807b3239942d5aff_131.png)

还有我们的这个助攻嘛，别的是不是就不要了走。

![](img/b7f33f58209d17ec807b3239942d5aff_133.png)

你看下现在是不是只有得分，助攻篮板这么三项数据啊对吧，那么这个就是我们values所对应的一个呃，参数的一个作用是不是OK吧。



![](img/b7f33f58209d17ec807b3239942d5aff_135.png)

那你会发现那在这的话我们进行分类汇总的话，那我们分类条件有了对吧，分类完了之后做汇总做的是怎样形式的汇总啊，那这块的分值是怎么算出来的，算的是均值呢还是最大值呢。



![](img/b7f33f58209d17ec807b3239942d5aff_137.png)

还是最小值呢，还是和呢，你知道吗，不知道是不是，那怎么办，看下边的这个参数叫做a j j funk。

![](img/b7f33f58209d17ec807b3239942d5aff_139.png)

OK吧，A j j funk，看一下A直接funk，这个参数是用来设置我们对数据聚合时，所对应的一个操作对吧，我们说了，默认情况下它的a j j funk等于min，那么意味着计算的是不是均值啊对吧。



![](img/b7f33f58209d17ec807b3239942d5aff_141.png)

那么意味着在这儿，我们所求出的这些个得分数据不都是均值啊，是吧啊，那么这个是胜利情况下。

![](img/b7f33f58209d17ec807b3239942d5aff_143.png)

助攻得分篮板所对应的一个均值吧，对不对，OK吧好这是均值。

![](img/b7f33f58209d17ec807b3239942d5aff_145.png)

如果你不想用均值的话，怎么办，也可以改吧，看一下这种需求，我们还想计算这个哈登，在主客场和不同胜负情况下的总得分，总篮板跟总助攻对吧，这不是平均得分，平均篮板跟平均入功能吧，看上边我们求的是平均得分。

平均来办平均入工啊对吧，那这怎么去玩呢，DFDR还是PVOT对吧，好index，我们分类的条件是啥呢，分类条件是不是还是主客场跟生物啊对吧，给他整下来主客场胜负好，然后的话。

那我们想要的数据values是不是还是我们的得分，篮板助攻啊，只不过哈只不过如果你这样去执行，我们得到的是平均篮板，平均助攻跟平均得分吧，我们现在要的是总得分，总篮板总分是不是怎么办，加上我们的什么呢。

a j j funk吧，看见了吗，A直接funk more，是不main，现在我们要的是不是和呀，a j j funk就等于什么呢，SU走你就完事了吧。



![](img/b7f33f58209d17ec807b3239942d5aff_147.png)

对不对，这样就完事了啊，那现在我们就知道了，A j j funk。

![](img/b7f33f58209d17ec807b3239942d5aff_149.png)

它的自用是啥了吧对吧，这个是我们A直接放靠所对应的一个含义，OK吧好。

![](img/b7f33f58209d17ec807b3239942d5aff_151.png)

那最后一个参数就是我们的COLUMENTS啊，COLUM它可以设置列哎层次字段，这个是啥意思呢。

![](img/b7f33f58209d17ec807b3239942d5aff_153.png)

我们在这看案例啊，看我们的案例就可以了，那首先看这啊，我们想要获取所有队主客场的总得分，是不是所有对主客场的总得分呢，那这块首先我们分类的条件应该是主客场吧，对不对，然后我们想要算的是不是总得分对吧。

那我们是不是可以values就指定下得分，我们要的是得分呢总得分，那我们的这个聚合所对应的应该是sum吧对吧。



![](img/b7f33f58209d17ec807b3239942d5aff_155.png)

那现在我们是不是就拿到了，这个所有队主场的总得分是379，客场的总得分是不是404啊对吧，这个好说对不对。



![](img/b7f33f58209d17ec807b3239942d5aff_157.png)

看在当前的基础之上，我们又加了一个条件看一下啊，获取每个队主客场的总得分，听见了吗，我们第一个需求是不是所有对主客场的总得分，下边是获取每个队主客场的总得分吧对吧，那就是在总得分的基础上。

又进行了什么对手分类吧，你看如果在这我们把这个主场跟客场啊，比如说把主场再给它进行一个什么呢，队伍的分类，客场再进行一个队伍的分类，那我们会看到是每一个队，主场的得分和客场的得分。

那么每个队主场得分加起来是不是379，每个队客场的得分加起来是不是404啊对吧，那这怎么去玩呢，首先在这个原始的基础之上，我们只需要给它加上一个什么呀，column等于对手就可以了。

free value不需要加啊，只需要加上一个column studior，对手看见了吗，这两个操作你对比一下。



![](img/b7f33f58209d17ec807b3239942d5aff_159.png)

是不是只多了一个叫做columns的对手啊，走你看一下。

![](img/b7f33f58209d17ec807b3239942d5aff_161.png)

那现在我们看一下这个主场是吧，主场每个队的得分情况是不是有了客场，每个队的得分情况是不是也有了对吧，然后每个队的得分情况加起来，不就是我们的379和404吗对吧，那这个NN啥意思啊。

那就是说勇士是没有主场得分的吧对吧，你不想用NN怎么办，看一下这块，我们可以加一个few word是填充的值啊，不等于零就没用闹了吧，用的是不是就是零啊对吧。



![](img/b7f33f58209d17ec807b3239942d5aff_163.png)

这个是我们columns所对应的作用，那就是说COLUMENTS的作用。

![](img/b7f33f58209d17ec807b3239942d5aff_165.png)

就是说我们可以在已有分类基础之上，对什么呢。

![](img/b7f33f58209d17ec807b3239942d5aff_167.png)

对我们的这个value再次进行一个细致的分类吧，对吧，那也就是说它的作用，我们简单点来说就是说对values段进行分类对吧，原始你看values不就是得分吗对吧，那下边是不是columns加上之后。

就是说在得分的基础之上再对对手进行分类啊。

![](img/b7f33f58209d17ec807b3239942d5aff_169.png)

对不对，OK吧，这个就是我们一个这个透视表的一个使用。

![](img/b7f33f58209d17ec807b3239942d5aff_171.png)

那这里边的话，只需要我们掌握这四个参数就可以了吧，index分类的条件是不是OK吧，volumes显示的是计算对应的列吧对吧，a j funk是我们汇总的一个方式对吧。

columns是对我们的这个values。

![](img/b7f33f58209d17ec807b3239942d5aff_173.png)

再进行一个细致的分类，是不是OK吧，这四个参数各位掌握了就可以了啊。

![](img/b7f33f58209d17ec807b3239942d5aff_175.png)

好这个是我们透视表下边的交叉表啊。

![](img/b7f33f58209d17ec807b3239942d5aff_177.png)

交叉表的话就简单了哈，这个交叉表适用于计算分组的特殊的透视表，那其实它跟我们透视表有些类似啊，它也是对我们的数据做分类汇总的。



![](img/b7f33f58209d17ec807b3239942d5aff_179.png)

OK吧，那只不过在这我们调用的是这个cross type，这样的一个方法，OK吧，在这我们就简单去试一下吧。



![](img/b7f33f58209d17ec807b3239942d5aff_181.png)

首先这有一个DF，看见了吗对吧，首先第一列性别，第二列年龄。

![](img/b7f33f58209d17ec807b3239942d5aff_183.png)

第三列是否抽烟，第四列它的一个什么呢，身高是不是啊，有这么几列数据。

![](img/b7f33f58209d17ec807b3239942d5aff_185.png)

接下来我们来看一下，我们想要计算各个性别抽烟的人数，就需要对我们的这个什么呢，呃相关的条件进行分类，并且需要做汇总的人数啊对吧，那这块的话我们想要去算什么，各个性别的抽烟人数。

那这样的话我们就可以把我们的这个什么呢，性别跟是否抽烟作为我们分类的一个条件，最终汇总一下人数是不是就可以了对吧，现在我们就算出来。



![](img/b7f33f58209d17ec807b3239942d5aff_187.png)

那么这个男性啊，男性的话他不抽烟的对吧，然后有两个抽烟的，有两个吧对吧，女性不抽烟的，三个抽烟的是不是两个呀对吧。



![](img/b7f33f58209d17ec807b3239942d5aff_189.png)

那这块cross type它的参数，你知道前两个所表示的含义是什么，就可以了对吧，前两个是我们的index columns，index就是说什么呢。

你看index smoke columns是不是我们的sex啊，看下我们所得到的这张表对吧，那index是谁，是不是smoke啊对吧，index应该是我们的什么呢，这个这个这个这个行索引吧是吧。

sex数列索引CODEMOS，看一下我们的行是不是smoke对吧。

![](img/b7f33f58209d17ec807b3239942d5aff_191.png)

列是不是sex对吧，下边求出各个年龄抽烟人的，各个年龄抽烟的人数吧对吧，那这块的话，我们就把这个年龄跟是否抽烟，作为我们的分类条件，是不是就可以了对吧。



![](img/b7f33f58209d17ec807b3239942d5aff_193.png)

整理OK了吧，那这个A值和smoke的位置能换吗，能换的对吧，AH如果到我后边的话，那么意味着我们的列索引就是AH了吧，行损就是什么回了吧。



![](img/b7f33f58209d17ec807b3239942d5aff_195.png)

对不对，这个是我们的一个什么呢，交叉表OK吧。

![](img/b7f33f58209d17ec807b3239942d5aff_197.png)

交叉表，那在pandas高级操作当中，我们一定一定务必要掌握的。

![](img/b7f33f58209d17ec807b3239942d5aff_199.png)

就是我们的分类汇总，OK吧，这是我们的这个透视表。

![](img/b7f33f58209d17ec807b3239942d5aff_201.png)

还有我们的什么呀，分组聚合，这是我们的group by，还有我们的map映射。

![](img/b7f33f58209d17ec807b3239942d5aff_203.png)

那么这三点各位一定一定要给他掌握了，因为这个是我们pandas as高级操作的一个重点。

![](img/b7f33f58209d17ec807b3239942d5aff_205.png)

OK吧好，那么至此的话，咱们整个pandas的操作就结束了，OK吧，那么下一小节，咱们通过一个实际的项目来巩固一下，咱们这个pandas as高级操作对应的内容。



![](img/b7f33f58209d17ec807b3239942d5aff_207.png)