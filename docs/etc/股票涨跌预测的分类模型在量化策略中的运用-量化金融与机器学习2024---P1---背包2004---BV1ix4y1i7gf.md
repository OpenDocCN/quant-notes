# 股票涨跌预测的分类模型在量化策略中的运用-量化金融与机器学习2024 - P1 - 背包2004 - BV1ix4y1i7gf

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_0.png)

前面一个部分我们通过预测股票的涨跌。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_2.png)

得到了一个预测股票涨跌的一个模型啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_4.png)

那么现在的问题呢是，我们怎么利用这个模型来做量化策略，就怎么用这个模型来做我们的股票投资啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_6.png)

呃首先呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_8.png)

我们的思想是这样的，当然肯定是要利用我们以前的一些东西啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_10.png)

就是我们把模型训练好，这个模型是有能力去预测什么呢，预测呃30天后股票的涨跌的是不是，那我们在实际操作中其实是呃是很容易的，大家能能想通这一点吗，就是你看我到了某一天，到了某一天，我要在这一天去买股票。

是不是，那我是不是可以把这个模型拿过来，模型可以拿过来的啊，把这个模型把我们训练好的模型拿过来，然后把我们在这一天我们能拿到的股票，对应的一些特征塞给这个模型，那这个模型是不是就能够把在这一天。

通过这一天的数据，能够预测出各个股票在30天之后的一个，涨跌情况，能理解吗，然后呢我们就干嘛，我们显然就肯定是买30天后涨的股票，不就行了吗，能理解这个这样一个逻辑吧，就是怎么把我们的模型运用过来的话。

其实就是这么一个简单的逻辑，但这样一个简单的逻辑呢，它会带来一个问题，他才会预测涨跌，我们是买全部所有都涨的股票吗，这是一种方法，就是你你你你你用那个模型预测出来之后，有些股票它是会涨的。

它预测出来会涨，有些股票预测出来会跌，那我们是买全部的吗。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_12.png)

其实也可以，但是坦率的说，我们这个这个black trade。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_14.png)

这个框架不太适合买很多股票，他把很多股票一塞进去，他就有点慢啊，当然现实中也很少这么干，也很少这么干，那么我们。



![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_16.png)

怎么买股票呢，怎么买股票呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_18.png)

一种最简单的解决方式是这个，就是我们上节课其实老师谈到的呃。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_20.png)

谈到的这样一个函数。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_22.png)

什么函数呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_24.png)

这个函数我们有了一个模型。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_26.png)

那么我们有了我们当前的特征。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_28.png)

然后通过这个方法我们能得到一个这个东西啊，这个东西是啥呢，是它处于哪一个分类的概率，还记得吗，是它是它是有两两个的啊，这是取了其中的一列啊，它是有两个，因为我们是二分类嘛啊，有零分类和一分类。

他这里呃通过这个和这个得到了什么呢，得到了所有股票，处于能够得到所有股票处于一分类，一分类就是会涨的那个分类的这个概率，那么我们最稳妥的方法是不是很简单，就是选取概率最大的股票，能理解吗。

就不不选所有那个能涨的，就所有能涨的，我们选在涨会涨的股票里面，概率最大的前面几个来进行交易，是不是就可以了啊，是不是就可以了，这就是我们现在的一个要运行的，一个一个一个思想啊。



![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_30.png)

一个思想好了，有了这个思想。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_32.png)

我们来来做一下，好像还没运行，这个我把我把这些代码都运行一下啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_34.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_35.png)

再运行一下。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_37.png)

这是我们上节课的内容啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_39.png)

昨天的内容。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_41.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_42.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_43.png)

啊这好像还要这样子这样子。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_45.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_46.png)

把上面的都运行一下。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_48.png)

然后就可以了啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_50.png)

这里这里这里也弄好了，弄好了之后呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_52.png)

我们先把这个模型搞出来啊，把这个模型搞出来呃，注意一下。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_54.png)

我们上节课拿到了做了那个模型，但是这节课的话我们在做模型的时候，有一个稍稍的不一样，一个是什么不一样的呃。



![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_56.png)

我们上节课是获取到特征之后呃，在做的一个标准化，但是在这里的话，我们一开始要就应该对全量的数据做标准化，这点大家能理解吗，就是上节课我们是把这个呃特征提取出来。



![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_58.png)

就是我们我们先先先做的抽样。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_60.png)

还记得吗，先做的抽样，然后再做的标准化呃，如果仅仅是为了训练某一个模型，这个是没问题的，但是现在我们的问题是什么呢。



![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_62.png)

我们要用这个数据训练一些训练模型，然后呢，我们还要把这个模型用到这个数据的。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_64.png)

其他数据里面去，能理解吧，所以这个时候就意味着我们要做标准化，就应该做所有数据的标准化。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_66.png)

就不能只做我们参与训练的数据的标准化，这个这个能理解了吗啊，因为你只做参与训练的数据标准化，就会导致那个啊就是你就是两个不同的标准化，它是它同一个数值，在两个不同的数据范围的标准的话。

它会得到不同的值啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_68.png)

能理解吧，因为因为标准化的时候，它减去这个均值始终是你在标准化的时候，那个数据的均值啊，和那个数据值的标准差，但是一旦你到了到了所有的就不一样了，所以说显然我们既然要用到，我们要把这个模型要用到啊。

要用到所有的数据里面去，那么我们肯定先要对所有的数据标准化啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_70.png)

所以呢我们得运行这个，然后呢我们先对全量的数据做标准化，就是什么呢，因为我们这里啊我们不搞换手率吧，我们先搞市盈率和总市值换手率，有时候总容易能触碰到那种停盘的那些东西啊，我们先不管。

我们先最简单的方式先搞这两个啊，所以说我们通过这个代码来实现，所有的我们的我们的那个5年的数据里面，所有的数据都做一个统一的做标准化，好统一的做标准化，这样的话大家看一下，无非就是原始的。

你看见没有原始的值拿过来，然后做一个标准化，然后把这个值给替代掉，就这么一个事情啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_72.png)

这么一个事情啊，替代掉我们的那个啊，我们的那个目标销量就不太需要了，因为目标销量反正他就是一个比例嘛，他本来就是一个收益率，他本来就是一个呃，差不多已经标准化的啊，我们就对那个就不搞了，因为哦不对。

他本来就是零一啊，零一就不需要搞。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_74.png)

不要搞好，这是这个标准化了之后，我们的总市值就变成这样的值了啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_76.png)

然后呢我们再把，啊，对应的东西给拿进去啊，这个时候还有一个问题，还有一个问题是不一样的，我们肯定是要用过去的数据来做模型，然后来预测未来，能理解吗，我们理论上是不应该拿呃未来的数据。

所以这个模型必须是过去的，然后我们用这个模型呢，我们应该这么想，我们应该只有5年的数据，我们用前面4年的数据来做模型呃，来然后再用把这个模型呢，再再再最后一年用上去，看效果怎么样，能理解吗。

当然这并不真实，因为其实真实的投资的时候，你肯定是在每个月都会更新你的模型，数据的，能理解吗，通常是用最近的这几年，包含了你最近的这个月，这个月的数据来做模型来做啊，做出模型，做出模型之后呢。

呃你在当前就用这个模型去预测下，近未来30天的一个情况，然后基于他来买股票，然后到了等你又过了一个月之后，你显然是要更新模型的，能理解吗，真实情况肯定是要滚动的去训练训练模型，但是我们作为呃简单起见。

我们就因为这里有5年的数据，我们用4年的数据来训练模型，然后把这个模型用到接下来这一年里面去啊，就不做模型的滚动更新了啊，虽然说真实情况可能会是滚滚动更新的，那这意味着什么呢。

因为是我们要要那个要把时间范围限定好啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_78.png)

时间范围限定好呃。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_80.png)

这个数据的话应该是最最晚到2月17号。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_82.png)

我们我们前面是有一个按时间进行那个的啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_84.png)

在这里看到没有，我们我们通过时间来，这之前我们用过一个对来来时间来。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_86.png)

对他进行。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_88.png)

啊，这个end和start上我们就用这个就用就用这个吧。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_90.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_91.png)

那用这个格式来写可能会好一点。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_93.png)

我们还要大于这个18年1月2号，我们到，怎么了，到，22012，是不是我们用这个时间的数据。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_95.png)

来做做这个事情啊，这个时间段，然后我们再多一点吧，我们取零点取50%的数据吧，取50%的数据。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_97.png)

然后剩下的其实就很简单。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_99.png)

既然是做这样的事情，然后再放进去。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_101.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_102.png)

做训练。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_104.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_105.png)

因为已经已经做过标准化了，所以说我们这里不再做了。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_107.png)

我们看一下它的效果哈，效果。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_109.png)

稍差一点他都行啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_111.png)

0。550。0。56啊，它的准确度就这么回事啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_113.png)

然后呢我们实际上我们就是要预测，用这个看到没有啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_115.png)

这个这应该对应的是诶，啊你看啊，这个东西它是能给出两个分类的概率值，他认为在这个分类的概率是0。3，在这个分类是0。68，所以说他认为处在这个分类，所以说它是一分类啊，这边是一分类，而我们要干嘛呢。

我们要用这个，当我们把它给到等于Z的时候，当我们改等于Z的时候啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_117.png)

呃我们获取这一列啊，获取这啊，我们获取这一列也是通过这个东西方式来获取，来获取这一列呃，然后呢基于这一列进行排序，然后拿到啊，拿到概率最大的啊，拿到概率最大的，然后买这个涨会涨。

概率最大的会涨的股票进行购买就行了。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_119.png)

好模型我们弄好了。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_121.png)

现在我们要用上去啊，要用上用上去的话，我们依然套用我们之前的多因子的模板啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_123.png)

这这只是之前多因子模板。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_125.png)

我们把它拷贝过来吧，啊这个模板的话。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_127.png)

首先呢我们要做一些变化。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_129.png)

我们你看啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_131.png)

我们看一下我们得只搞一年的，只搞一年的啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_133.png)

只搞一年的话。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_135.png)

大概从什么时候开始呢，呃我看看他一年的话还有多少多少个。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_137.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_138.png)

300的话是是2029。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_140.png)

1000呢，1000是202022。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_142.png)

差不多了啊，我们从哪从哪一天开始呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_144.png)

从900。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_146.png)

这个大概是二零1月2号。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_148.png)

1月2号开始我们就可以，其实我们从1月3号开始就行了啊，我看看1月3号大概是九九百五十是多少。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_150.png)

这还太晚，太晚了，970，900。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_152.png)

我看一下他是训练到什么时候，训练到1月2号，22年1月2号，然后我们这个是13号，大概就这样吧，九百七十九百七十四是吧。



![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_154.png)

75了，是不是就这样吧。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_156.png)

就用这个吧，所以说我们从这个这个时候开始。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_158.png)

这就意味着什么呢，我们在循环的时候就，直接从这里开始了，前面的我们就不搞了啊，前面的我们就不搞了，直接从这个地方开始，只搞一年了啊，一年的只有一年的30天。



![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_160.png)

很短啊很短，然后呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_162.png)

我们这个时候他拿到的是当当天的数据。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_164.png)

然后呢我们要用当天的什么呢，我们要用当天的市盈率和。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_166.png)

我们要用当天的市盈率和市值。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_168.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_169.png)

是不是，就这样放到这里就行了，应该当天的市盈率和市值。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_171.png)

而且这个而且这个东西它已经是什么呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_173.png)

啊是这样的，我们我们肯定是要拿当天的市盈率和市值。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_175.png)

然后呢还得拿一个，还得拿股票代码，这样的话我们才能知道到底是哪个对应的，是我们的股票是吧。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_177.png)

这三个也要拿啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_179.png)

拿到了之后呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_181.png)

我们先把这个注释掉啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_183.png)

然后freak一下。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_185.png)

是不是，然后我们先看一下，我们拿到了这个东西。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_187.png)

拿到这个拿到这个之后，我们拿什么呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_189.png)

我们拿我们的市盈率和市值，来作为我们的特征矩阵。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_191.png)

是不是。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_193.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_194.png)

啊这个这个的什么呢，这个的values啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_196.png)

这个是我们的特征矩阵啊，但是注意一下啊，这个得得要drop a，看到没有点，啊要把空格去掉。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_198.png)

你看他有空子啊，这样不行啊，所以我们运行一下这个，然后应该就没有空子了。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_200.png)

这个是我们的特征矩阵，我们需要干嘛呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_202.png)

我们需要用我们的模型，就这个。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_204.png)

来。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_206.png)

预测这个东西。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_208.png)

用我们的模型来预测这个东西，预测好了之后呢，啊预测好了之后啊，我们可以看一下。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_210.png)

他会得到一个预测结果，预测好了，我们只拿什么呢，只拿他这个。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_212.png)

我看一下啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_214.png)

只拿它这边这一列啊，这边这一列，这边这一列是不是就是这么拿就行了。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_216.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_217.png)

是吧，应该这么拿就行了，这应该就是刚才那一列吧，我们对比一下，看看有没有搞错。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_219.png)

对052啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_221.png)

是的是的，就是刚才那一年，我们实际上只拿这一列就行了。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_223.png)

拿到这一列之后呢，我们要给到原来的这个东西，因为最终我们还是要干嘛呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_225.png)

最终我们是要拿这个股票代码。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_227.png)

所以说我们拿到这个东西之后啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_229.png)

我们让我们的呃。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_231.png)

我们把它给到这一列。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_233.png)

变成这一列，是不是变成这一列，变成这一列之后呢，我们接下来就可以对它进行排序，对按照这个排序。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_235.png)

是吧，按照这个东西排序。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_237.png)

拿这个东西是什么呢，尾部因为它是从小到大的，我们要拿极大值啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_239.png)

点tail0。5拿这个。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_241.png)

然后呢拿这个东西的什么呢，这个东西的股票代码。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_243.png)

然后把它变成list list。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_245.png)

这样的话就是我们的新的什么呢，新的STOCKLIST好。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_247.png)

我们把这些东西做了之后呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_249.png)

我们把它放到我们那个模板里面去，就这个啊这个程序模板应该就可以了啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_251.png)

就可以了，所以我们看看我们这个拿这里是拿的这个东西。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_253.png)

然后，我们用这个这个也放上去是吧。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_255.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_256.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_257.png)

这个放上去。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_259.png)

然后呢，我们的这个要上去。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_261.png)

这个时候这个东西就是什么呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_263.png)

就是我们的STOCKLIST，是不是其实就这两行啊，就这两行。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_265.png)

当然这边这边稍微有点有点修改啊，稍微有点修改。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_267.png)

就这里稍微稍微有点修改好这里就行了啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_269.png)

这样可以的话。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_271.png)

我们把这个就去掉了，我们不需要再向多音质能量做这些事情了啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_273.png)

然后，那这样的话就应该是可以了啊，应该是可以了，下面都是一样的，因为一旦我们拿到了这个stop list，下面就是一样的流程，无非就是把它放进去啊，放进去。



![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_275.png)

好这个好了，我们运行一下。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_277.png)

啊这个没定义啊，应该是不是stock list，应该是stock list z啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_279.png)

它始终是一个中间的中间量重力这个东西啊，所以这个要改一改，好快啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_281.png)

什么秒秒秒走了，我看下有没有有没有。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_283.png)

啊是有的。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_285.png)

二零1月6号就开始买了，好有这个的话。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_287.png)

我们看一下他在这一年能搞多少钱，这一年就用这个这个训练好的模型。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_289.png)

在这一年能赚多少钱。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_291.png)

我们试一下。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_293.png)

应该这个代码在这边啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_295.png)

代码在这边，我们不太需要改这些东西啊，因为。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_297.png)

代码在这里，这个是要去掉的。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_299.png)

然后呢。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_301.png)

这个这个代码拿过来。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_303.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_304.png)

就是把东西放到这个这个里面的啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_306.png)

啊这些拿过来，这个就不用改了，无所谓啊，反正我by历史里面，他始终是从2012年2022年开始的。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_308.png)

所以说你这个东西从什么时候开始，其实没有那么重要啊，没有那么重要，运行一下。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_310.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_311.png)

98万不行啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_313.png)

怎么还亏了。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_315.png)

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_316.png)

结果这个结果居然还亏了啊，我们。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_318.png)

好吧，这个肯定就是会亏啊，这个没办法。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_320.png)

我这不是我能决定的啊，就是用前面几年的数据做模型，然后最后一年来用它啊啊套路就是这个套路，当然更合理的是，我们每一次用每一次更新，这个是最合理的，因为毕竟你一年前的模型的话，它随着时间的推移。

它肯定是越来越不准啊，但是这个就太麻烦了。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_322.png)

我们就把这个流程走一走啊，流程走一走，看看这个呃。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_324.png)

了解一下这个效果就行了啊，大概就是这样子。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_326.png)

这就是一个整怎么把这样一个机器学习的模型，怎么样用到我们的具体策略的一个。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_328.png)

实现的方法啊，这样实现的效果不好。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_330.png)

但是我们把这个流程走好了啊，做好了啊。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_332.png)

就是这里效果并不好啊，并不好好吧。

![](img/a2de46b8ab4cd5e6a4a779f31fa3f777_334.png)