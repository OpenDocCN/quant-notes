# 【2024版金融量化】AI结合金融如何做落地项目？迪哥手把手教你3天从入门到项目实战，学完即可做项目，少走99%的弯路，学量化交易看这套！人工智能／计算机视觉 - P14：4-均线调参实例 - 迪哥谈AI - BV1NW421R7d7

![](img/20b7518b090a70617b79d00021516564_0.png)

行了，说完这个双键测略之后，然后接下来我们看第二个。第二问题什么呢？就是现在有个问题啊。

![](img/20b7518b090a70617b79d00021516564_2.png)

哎呀，你这个结果你说跟哪些因素有关系，大家可能会告诉我，那跟很多因素都会有关系的。那这里咱们该怎么办？咱们可以这样，你说现在啊我能不能去找一些参数。比如说我们的一个短线和一个长线。

那你不是短线长短期和长期，我能不能设置一些不同的值来去看一看短期究竟是5天合适呢，还是10天合适呢？长期是20天合适呢，还是4天合适呢？我可以算一算这样的组合吧，在判断当中啊。

我们可以很轻松的做这样一个迭代。好了，把迭代工具先导进来。

![](img/20b7518b090a70617b79d00021516564_4.png)

我们先把这个D代工具啊给它拿到手from咱DI工具当中part。part product这个东西他就是能帮呃就给大家解释一下他是做什么的。其实很简单啊，就是他需要让我们啊。啊，写反了SMA1。

还有一个SMA2，他需要让我们啊分别去指定好两个参数空间。参数空间啊，你可以自己随便指定。比如说从20，然后到这个61页，只要取不到61页，最多取到60，然后这么4个1家是吧？

然后这里你也可以指定一个rangerange当中从多少长线再稍微大一点，180，然后到这个280吧，然后取不到28，取到281页，然后10个1家行吧。然后这样然后再指定一下当前我这个结果。呃。

这个参数空间的意思就是它这个组合的意思啊是这样，就是呃得能去帮我们去计算出来所有的一个组合。比如这里你看这个20变180行吧，20就是有这样一些组合，一会算完之后，20180，这是一种组合是吧？

然后20，然后这个11呃20190，然后2320200，然后20210是吧，点点，然后20万多少，24180，然后呢，24190啊，这个便利操作能帮助我们把所有的一个结果全部给它便利掉啊，是这个意思。



![](img/20b7518b090a70617b79d00021516564_6.png)

然后呢呃一会儿把咱在这里就是风印上当中候去写吧。就这一块就是我们可以写一下。复件当中我要做遍利了呃，编例当中我要拿到咱当前的两个参数，就是一个长线和一个短线。因什么？因这个pro大当中。

然后我把这个结果给把当前两个参数空间传进去，这是第一个参数空间。然后这是第二个参数空间，能把所有结果全拿到手，然后在这里做遍利。然后便利过程当中呢，我会把。当前我们的每一个数据全部给它指定出来吧啊。

就是一个datadata，我看一看啊，之前哎呀这个data当中我得重新算了，在这一块这样吧，把咱数据重导一下吧。然后之前那份数据可能让我做乱了。我我为了保险还是重导一下，在这里。



![](img/20b7518b090a70617b79d00021516564_8.png)

![](img/20b7518b090a70617b79d00021516564_9.png)

![](img/20b7518b090a70617b79d00021516564_10.png)

![](img/20b7518b090a70617b79d00021516564_11.png)

好，这咱把这个数据在这里重导一下呃，这里也重导吧，导一下咱这个数据data就是等于我们刚才啊传进来数据当中的只需要我们的一个苹果股价啊，咱们再把它复制过来。苹果的股价啊，把名字指定出来就可以了。

然后现在就是我们拿到数据了，拿出据之后不要忘记对数据还要做这样一个去确失值的操作，我就全复制了，因为都是相同操作，这也给大家去写了，这里还是第一步去确失值确确认之后呢，然后下一步下一步就是我们要去算吧。

要去算三个值，一个是returns，一个是SMA1，还有SMA2是吧？哇，这三个结果也都复制过来啊，这是一个returns方法都是一样的，这是把returns给它复制过来。

然后呢接下来SMA1还有SMA2我也复制一下。

![](img/20b7518b090a70617b79d00021516564_13.png)

![](img/20b7518b090a70617b79d00021516564_14.png)

![](img/20b7518b090a70617b79d00021516564_15.png)

![](img/20b7518b090a70617b79d00021516564_16.png)

![](img/20b7518b090a70617b79d00021516564_17.png)

![](img/20b7518b090a70617b79d00021516564_18.png)

![](img/20b7518b090a70617b79d00021516564_19.png)

![](img/20b7518b090a70617b79d00021516564_20.png)

![](img/20b7518b090a70617b79d00021516564_21.png)

再往上啊，这块把它拿过来。

![](img/20b7518b090a70617b79d00021516564_23.png)

好了，这是一个SMAE。然后我把这个改一改，这是一个SMA2，然后这块分别用一个2就可以了。然后看一下对于当前的数据，然后这块也加上一下，刚才咱们就忘了，这里我需要加上就是当前是对谁做这个操作的。

然后对我的股价，这个也是对我的股价来执行这样一个操作。直接操作完之后啊，然后肯定哎呦这块我估计又会有确失值，再把这个确确日值的东西加一遍。那接下来就是。我们再去把上面的呃判断给复制过来。

就是一个position的一个东西啊，找一下，相当于啊把我们之前所有结果咱要做一个汇总了。正常写代码其实也就是把上面的结果都写到一个函数当中，只不过说在给大家讲解过程当中啊，可能为了方便。

我就给大家一行样去写到方便咱去展示每一行它的一个结果嘛，其实实际上它就是一个函数而已。然后这块我看一看，这块再看一下我们的一个策略。好了，然后一个我看有一个position，咱有了return有了。

我们的一个策略也有了，这步转完之后再去掉一个确失值，每一步都会有确失值啊，去完确失值之后，然后。

![](img/20b7518b090a70617b79d00021516564_25.png)

![](img/20b7518b090a70617b79d00021516564_26.png)

![](img/20b7518b090a70617b79d00021516564_27.png)

![](img/20b7518b090a70617b79d00021516564_28.png)

最终我会有一个结果，把这个结果也拿过来啊，结果就是复制这个。

![](img/20b7518b090a70617b79d00021516564_30.png)

把这个结果给拿过来，这是当前结果吧。好了，有结果之后，我说我对这个结果做一个展示吧，展示就是一个result，这个results咱家写好看一点，给它写成一个呃表格的一个形式吧。

就是ressourceult。这样一开始的时候我先创建一个表格吧。

![](img/20b7518b090a70617b79d00021516564_32.png)

![](img/20b7518b090a70617b79d00021516564_33.png)

resourceult等于我的一个paas调。呃，创建d frame先是空的吧，然后一会儿再往你去传在这个result当中，result等于我这个resourceult里边。然后呢，我看了一下。

把它当前啊，但凡我需要的东西全加进来，呃，还是加一个d frame把它做成一个表格的形式。在这个d frame当中啊，我用一个key value的形式，把我的一个列名和它实际的值给传进去。呃。

第一个名字就是一个SMA1是吧？好了，SMA1，然后它的值呃，就是这个SMA1然后第二个我直接复制了。第二个就是我的1个SMAA2把它都复制过来。



![](img/20b7518b090a70617b79d00021516564_35.png)

然后逗号也复制一下，有好几个，这是SMA2，这也是SMA2。然后第三个第三个就是呃我的一个return。这个returns。把这个returns复格复制过来，这也是个returnnce。

然后下一个下一个就是咱的一个策略。我的这个策略啊策略拿过来策略哎，好像复制错了。在这里这是我我找一找，这是名字，这是value名字value名字value，该复制这个了。这是我的一个策略。

然后再复制一个就行了。最后一个最后一个咱们写一个吧，就是我的一个输出结果输入结果相当于就是呃我当前的一个预测值，然后比你的一个结果值，就是咱用这个策略的结果和不用这个策略能好多少。哎呦。

我不是把它放到当前这个里当中了吧。那行了，这块我稍微改一改。等于我的一个策略值，我把这个策略值拿到手，这个是我的一个策略值是吧？用我当前策略值，然后我要去减法啊，减去一下当前我什么都不做的时候。

它的一个结果，这个returns这里咱还得改一改，这块直接return不行，我这块不是把这个returns都放到这里了吗？得给它列一下哦，我看一下，这是呃returns。

然后returns它的一个结果呃，这块稍微改一改这块我看一下，就是写乱了SMA2然后这returns得把它改一下。



![](img/20b7518b090a70617b79d00021516564_37.png)

在这个当中，它是取retturns这个结果吧。然后策略策略当中也是一样的，我把这个也复制过来，也复制过来之后，然后他取我策略的一个结果，指是就行了。呃，先在试看一下吧，看看结果能不能出来。

就是新需要写这么多，看一下。

![](img/20b7518b090a70617b79d00021516564_39.png)

![](img/20b7518b090a70617b79d00021516564_40.png)

他说呀在我算这个returns过程当中啊，然后就没有了这个key啊，这怎么改啊？现在看一下吧，看一下啊，就是最简单的一个找错方法，就是它到哪儿遇到问题。然后在前面咱给它打印一下，行吧。

我说我看一下当前这个结果，它到底咋地了。这个data行不行？好了，重新执行一下，我们来看一看。

![](img/20b7518b090a70617b79d00021516564_42.png)

![](img/20b7518b090a70617b79d00021516564_43.png)

![](img/20b7518b090a70617b79d00021516564_44.png)

呃，我看一看打印出来的结果会是什么，打印出来这个数据，数据当中啊，这有个date啊，只有我的一个缩引。但是呢你看它像是把这个数据当中啊，像是没有这个列了是吧？这源于什么？我们当前取完之后。

咱前我们得到的是一列数据，一列数据当中啊没有给我带这个名字。所以此时我们得稍微改一改，我得把这个东西啊再加上点东西，你得让它呀接着成为一个dta frame才行吧。

所以这块咱这样咱把它呀给它加上一个d framed frame给它包起来这就行了，应该。

![](img/20b7518b090a70617b79d00021516564_46.png)

![](img/20b7518b090a70617b79d00021516564_47.png)

再来执行一下。好了，果然不出所料，又报错了。看一下哦，这块我得再再重新执行一下。因为刚才改了东西之后都从头来执行来看看啊，这回又报错了，但是报错不太一样，看一下是哪里。最后一行。

我做这个reult table的时候构建我这一个数据啊数据表的时候，然后他说了数据表当中啊呃哦你必须指定一个缩引。那我不需要缩引啊。



![](img/20b7518b090a70617b79d00021516564_49.png)

![](img/20b7518b090a70617b79d00021516564_50.png)

![](img/20b7518b090a70617b79d00021516564_51.png)

![](img/20b7518b090a70617b79d00021516564_52.png)

![](img/20b7518b090a70617b79d00021516564_53.png)

不需要索引也没招啊，就是人家说了里边是必须去指定索引的怎么办呢？那人家说指定索引，那自己指定呗，index随便指定成一个值得了，然后来执行一下吧。



![](img/20b7518b090a70617b79d00021516564_55.png)

![](img/20b7518b090a70617b79d00021516564_56.png)

好了，执行完了来看一看，先看一看这个结果怎么样。我该随便指定个缩引哦，看一看，你看我随便指定个零的缩引，但是感觉有点奇怪，这么对吧？咱便是随便指定零了，我先给它指定出来缩引。然后呢。

我说我再给它约弄一下，用原始的缩引，就是按那个数值012345678再标吧。这个缩引我给它忽略掉吧，然后再执行一下。😊。



![](img/20b7518b090a70617b79d00021516564_58.png)

![](img/20b7518b090a70617b79d00021516564_59.png)

![](img/20b7518b090a70617b79d00021516564_60.png)

哦，来执行执行执行。在咱们传建这个索引，传这个索引的时候，那应该是给这个data frame传索引是吧？然后呢，一个or的时候应该是对于这个end来说，我不需要再给加缩引了，是不是应该这样一件事吧？

所以说咱就把这个括号给对应上，咱想怎么改啊。在这里这个index应该是对于daate frame当中，我要加上括号，我看对不对应上当前怎么加中文逗号。加上一个逗号，你看现在对应了这个d frame吧。

你看这个d frame这亮了。所以说现在一个我对应了啊，不是这些在指定index，对应d frame当中有索引了，然后再看最后一个我这个一个 indexex它说是对我这个判来说，我不需要再加索引了。

来看一看当前我这个括号这括号好像多了一个再去掉一个哎，对应上了吧，对应是有判的行了，咱再执行一下。这回没问题了吧，展示一下结果，这回我们的索引当中，你看01234，咱全有了吧。

SMA1SMA2就是对于不同的结果，我展示10个吧。😊。

![](img/20b7518b090a70617b79d00021516564_62.png)

![](img/20b7518b090a70617b79d00021516564_63.png)

![](img/20b7518b090a70617b79d00021516564_64.png)

对于不同的一个就是那个什么不同的一个参数选择吧，咱得到结果retance，还有我们策略，得到结果。那你看对于不同的结果来说。第一第个挺有意思啊。

就是看咱们这个out out相当于就是我们这个策略比那个啥也不做的时候，那强多少。那第一个你看如果说你选的这个窗口不太合适，那反而还不如只啥也不管了。是不是？但是大部分条件下还是比之前要强一些吧。

然后甚至有的还是一个处于持平的一个状态。行了，这个大家看了一下，就是呃咱们又给大家对比了一下，就是怎么样去基于我们不同的参数去选择一下什么样的一个结果才是一个合适的。这给大家说了一下，在判断当中啊。

怎么样借助这些工具包来完成我们的一个双金线策略，哎给大家做了一个分析，还有操作的一个实例。😊。

![](img/20b7518b090a70617b79d00021516564_66.png)

![](img/20b7518b090a70617b79d00021516564_67.png)

![](img/20b7518b090a70617b79d00021516564_68.png)

![](img/20b7518b090a70617b79d00021516564_69.png)

![](img/20b7518b090a70617b79d00021516564_70.png)