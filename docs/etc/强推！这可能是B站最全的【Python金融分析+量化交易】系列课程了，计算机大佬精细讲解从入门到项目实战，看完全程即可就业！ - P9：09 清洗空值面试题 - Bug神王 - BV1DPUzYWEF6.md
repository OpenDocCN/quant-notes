# 强推！这可能是B站最全的【Python金融分析+量化交易】系列课程了，计算机大佬精细讲解从入门到项目实战，看完全程即可就业！ - P9：09 清洗空值面试题 - Bug神王 - BV1DPUzYWEF6

那么这一小节的话。

![](img/23b1d4b3002ac969bd5307f88799f798_1.png)

咱们就来看一个真实的面试题，通过这个面试题呢，我们来看一下这个趋势值如何进行一个处理，OK吧好，那么这个题目是这样的，他说现在呢有一个冷库的温度数据啊，这个温度数据呢我们可以先给它加载出来。

先看一下它是长什么样子的对吧，先把数据加载出来啊，那这个温度数据呢，它所对应的是一个excel的一个表格，我们把excel表格当中数据给它读取出来，pd第2read杠excel吧对吧。

这个表格呢在我本地有一个文件夹啊。

![](img/23b1d4b3002ac969bd5307f88799f798_3.png)

看叫什么叫做。

![](img/23b1d4b3002ac969bd5307f88799f798_5.png)

data啊叫data，在这个data下边呢，有一个叫做text data这样的一个excel文件啊，我们先把它读出来看一下。



![](img/23b1d4b3002ac969bd5307f88799f798_7.png)

那么这个excel表格里边的数据哈，它所对应的是什么呢。

![](img/23b1d4b3002ac969bd5307f88799f798_9.png)

是1~7对应的是七个温度采集的设备啊。

![](img/23b1d4b3002ac969bd5307f88799f798_11.png)

那么这个温度采集设备呢，每一分钟所采集一次温度，你比如说这啊一二它的类似于1234567，对应的是七个温度采集设备。



![](img/23b1d4b3002ac969bd5307f88799f798_13.png)

然后呢航速是每隔一分钟所采集的一组温度吧，对吧，比如说这个负的20。5，它是3号设备在这个15点啊。

![](img/23b1d4b3002ac969bd5307f88799f798_15.png)

17：01分的时候所采集到的一组数据吧，对吧。

![](img/23b1d4b3002ac969bd5307f88799f798_17.png)

这个是我们对应的一组数据啊，那然后他说我们数据处理的目标是说，我们想要使用什么呢，1~4对应的四个必要的设备，通过建立一个这个冷库的温度场关系模型，预估出5~7所对应的这三个设备的温度。

他的意思就是说原来有七个设备啊，那可能就是说我需要使用四个设备。

![](img/23b1d4b3002ac969bd5307f88799f798_19.png)

采集四组温度，然后基于这四组温度就可以预测出啊，评估预测出这个后三个设备所对应的温度，那这块的话，我们的温度关系差模型，是需要通过咱们的机器学习，进行一个数据的处理，采集数据之后呢。

进行这个后三个设备的一个呃预测，那这块的话，温度场的关系模型所对应的机器学习呀，咱们是做不了的，因为咱目前没有学过是吧，但是咱们的数据处理的是可以做的，那就是说我们需要干什么呢。

看他说原始的数据当中有丢帧的现象，那就是说丢帧只就是说会存在空值吧对吧，我们需要将原始数据当中的空值，给它进行一个处理，OK吧，那首先这一步咱们是可以做的，OK吧，这一步咱们可以做啊。

将原始数据当中丢帧的数据进行一个预处理，就是说把丢帧的数据给它清洗掉，是不是怎么清洗呢，要么把DIO帧所对应的行数据给它删掉。



![](img/23b1d4b3002ac969bd5307f88799f798_21.png)

要么给它覆盖掉对吧，那么这两种形式呢咱们都可以去试一下啊，都可以去试一下。

![](img/23b1d4b3002ac969bd5307f88799f798_23.png)

那首先啊在这的话我们就给它保存一下，我们叫做DF，可以吧啊存在一个DF当中。

![](img/23b1d4b3002ac969bd5307f88799f798_25.png)

那首先这一组原始数据的话，我们重点是对1234这四组啊。

![](img/23b1d4b3002ac969bd5307f88799f798_27.png)

这四组数据当中的空值进行一个清洗吧。

![](img/23b1d4b3002ac969bd5307f88799f798_29.png)

那么咱们在这是不是可以把1234，这四组数据先取出来啊对吧，DF就等于什么呢，就等于DF，咱们怎么取列呢，是中括号，再加上中号。



![](img/23b1d4b3002ac969bd5307f88799f798_31.png)

我这取的是什么呀，1234这四列是不是看下咱们DF搜。

![](img/23b1d4b3002ac969bd5307f88799f798_33.png)

那首先这四列数据出来了吧，这里边是不是有缺失的数据啊。

![](img/23b1d4b3002ac969bd5307f88799f798_35.png)

对吧，咱们就把缺失的数据呢给它进行一个处理，OK吧，处理啊，那这块怎么处理呢，首先第一步咱们就可以跟上，我们的将空值对应的行数据不删除啊，是不是删除啊。



![](img/23b1d4b3002ac969bd5307f88799f798_37.png)

删除那删除的话好说DF点点什么呢，d lp job n是不是就可以了，装不到，然后的话呢，是不是就OK了对吧，那这块的话看一下DRAMON啊，dram down当中的一是谁啊，一是谁。

一它指的是行还是列呢，首先我们说在job这个函数当中，一是我们的列零是行吧对吧，那在job now，反正就是说在job系列或job，开头的这些个函数当中，那么我们的轴向一对应的就是列，零对应的就是行。

OK吧。

![](img/23b1d4b3002ac969bd5307f88799f798_39.png)

那这我们要删的是不是行啊，看013为什么没有二啊，二是不是空锁定的函数不直接给他删掉了对吧。

![](img/23b1d4b3002ac969bd5307f88799f798_41.png)

就删除了吧，OK吧，这是一种形式，那么咱们能不能使用我们的is not not not any ding，or进行处理呢，也可以吧对吧，怎么做呢，DF点，我们首先先做一个什么呢，Not none。

可以吧是吧。

![](img/23b1d4b3002ac969bd5307f88799f798_43.png)

noon走，你返回一组布尔值吧，Not now，我们说要跟我们的这个all是不是结合呀是吧，xis等于什么，是不是等于一呀，一在这块是不行对吧，一是行啊，那我们用来监测某些某些行当中，是否存在空值吧。

走现在这里边是有true false啊对吧，我们知道false对应的就是我们的缺失值，所对应的行数据吧，那怎么办，是把这组word值作为原数据的行索引就可以了，点儿，lock好将它放进去吧，走。

那现在拿到的结果跟我们捉不到，所拿到的结果是不一样啊，就将空所对的函数它删掉了吧，对吧好。

![](img/23b1d4b3002ac969bd5307f88799f798_45.png)

我们来看一下原始数据哈，看一下我们这的DF原始数据一共有多少行啊。

![](img/23b1d4b3002ac969bd5307f88799f798_47.png)

看一下啊，一共有1060行吧对吧。

![](img/23b1d4b3002ac969bd5307f88799f798_49.png)

那我们删完之后啊，删完之后还剩多少行呢，删完之后还剩下这个982行。

![](img/23b1d4b3002ac969bd5307f88799f798_51.png)

对不对，那么意味着我们的删除成本不高吧不高。

![](img/23b1d4b3002ac969bd5307f88799f798_53.png)

那我们就可以删，是不是啊，那除了删我们这的话是不是还可以做覆盖啊。

![](img/23b1d4b3002ac969bd5307f88799f798_55.png)

是吧，还可以做覆盖啊，这样的话我们可以去填充啊，填充控制。

![](img/23b1d4b3002ac969bd5307f88799f798_57.png)

填充控制我们就使用DF点FIONA吧，FILA是不是好，那这块的话我们是啊，这个method是填充方式吧是吧，我们这向前或向后填充是都可以啊对吧，重点就是我知道xis那个轴向我选的什么呢。



![](img/23b1d4b3002ac969bd5307f88799f798_59.png)

是用竖直方向的近邻值填充它呢，还是用水平方向的近邻值填充它呢对吧，那这块我们应该会想到，是不是用竖直方向进一值填充啊，为什么呢，因为一列表示的是一个温度采集设备，每间隔一分钟所采集的温度吧。

你比如说这是一个空值，我们要把控制填充，是不是可以用上边的，或用下边的这个值去填充它呀，因为同一个设备在前一分钟和后一分钟，所采集的无温度数据应该是变化不大吧，那这我们放的是不是列列是不是零对吧。

走看那么在这填充完了之后啊。

![](img/23b1d4b3002ac969bd5307f88799f798_61.png)

这里边还会不会存在空值呢，看一下啊。

![](img/23b1d4b3002ac969bd5307f88799f798_63.png)

会不会有呢，可能还会有，为啥呢，因为你看我这块是不是向前填充啊，不用前边的直线的话，你比如说啊，比如说这是一个空值，那这空值有前边的值吗，是没有啊，那没有的话，那就说如果它是空，如果用来向前填充的话。

那么前半是没有值的，那么空就没有办法用前边的是填充吧，算是不是还是空值啊，对不对，还是空值啊，那所以说可能会填充不完整，那怎么办，那在这向前填充完了之后，返回的是一个新的data frame吧。

我可以再向后填充一下，dr fiona method等于什么呢，等于我们的BFOK吧，xx xx不还是等于零对吧，那这样你像前填充一次，向后再填充一次，那么总而言之所有的空值都会被我填充干净吧。

OK吧好，那这样的话我就保存一下啊，这个是我们的data好。

![](img/23b1d4b3002ac969bd5307f88799f798_65.png)

那data现在就是我们清洗之后的结果吧，那在这我们可以去检测啊，检测下是否填充完整。

![](img/23b1d4b3002ac969bd5307f88799f798_67.png)

就是是否还有空值，是不是，那这怎么去检测是否填充完整了呢，我们可以这么去做data点第2is now是吧，然后再点儿any，你一下，OK吧，那这块xis等于什么呢，等于一个啊，一一表示是我们的行。

让any any去监测我们原始数据当中，是否有什么呀，是否有这个false吧，如果有的话，就返回false，否则返回true是不是对吧。



![](img/23b1d4b3002ac969bd5307f88799f798_69.png)

那现在你看这块是不是都是大部分NO false啊是吧。

![](img/23b1d4b3002ac969bd5307f88799f798_71.png)

false就表示没有空了吧，对不对，那这我也看不完整啊，那怎么办，那这我就把轴向呢换成什么，换成020，再看一下，你看现在有1234都是false。



![](img/23b1d4b3002ac969bd5307f88799f798_73.png)

什么意思啊，就是说一列二列三列四列是不是一共有四列啊，就这四列当中是不是都没有什么呀，都没有我们的这个处啊，那么意味着是不是都没有控制啊是吧，那么意味着通过这样的方式。

咱们就可以监测出我们到底有没有给它填充。

![](img/23b1d4b3002ac969bd5307f88799f798_75.png)

完整吧，OK吧，那所以说在这啊就使用了我们的这个什么呢，删除空所对应的行数据，或者使用近临时填充，我们就可以将我们原始数据当中，所对应的这些个空值，给它进行了一个过滤和清洗吧。



![](img/23b1d4b3002ac969bd5307f88799f798_77.png)

OK吧好那么下一小节的话，咱们就来看一下如何去处理。

![](img/23b1d4b3002ac969bd5307f88799f798_79.png)

重复值和我们的异常值。

![](img/23b1d4b3002ac969bd5307f88799f798_81.png)