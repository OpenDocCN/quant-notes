# 【量化交易】Python入门之数据分析【2／4】｜ 金融工程 量化金融 - P6：2-5. Python数据分析：Module2-Pandas Dataframe基础 - Devils-Advocate - BV1RdHAemERq

各位好，这节课我们仍然来讲data frame。首先我们import一下penas SPD，然后我们import一下ttanic这个CSB。

如果这个CSV file跟你的jupyter notebook，也就是这个文件，它在一个文件夹里，一般来说我们可以直接使用这个方法。但是它可能放在别的地方。那我建议你把所有的这个文件名都打上。

所有的路径都打上，这样子也能读取。

![](img/9297cc73d7277b29dabde1c81c50b853_1.png)

所以这取决于你的文件名在哪儿。然后我们来看一下这个da frame，这是一个泰坦尼克号，它的。

![](img/9297cc73d7277b29dabde1c81c50b853_3.png)

一个统计表。那么我们有passenger IDD，这是乘客的ID信息，它是否存活了。那么我们知道泰坦尼克号这个悲剧，它有很多人去世遇难。那么一代表是他最终活下来了。零代表他去世了。

P class这边也说了，是他的classt class有一是一等舱，22等舱，33等舱。

![](img/9297cc73d7277b29dabde1c81c50b853_5.png)

然后我们有他们的性别，H，他们的年龄，sep SP他们是否有sibling和ssp，就是他是否有兄弟姐妹以及alle。pch是他嗯。是到的parents或者children。

他们的父母和孩子ticket是他的票务信息，fes是他的。票价 cabin是对应它的这个仓的它的。房间号，然后inbro。在最后面。



![](img/9297cc73d7277b29dabde1c81c50b853_7.png)

嗯，burg它是表示SCS这种是表示ch嗯cherburgquestown、sampampton，他们上传的地方，嗯们inbar embar对吧？



![](img/9297cc73d7277b29dabde1c81c50b853_9.png)

嗯。然后呢，我们就来开始讲一下这个咱的呃咱data frame。前面我们讲了呃，data frame呢可以用。啊，可以直接来选择。



![](img/9297cc73d7277b29dabde1c81c50b853_11.png)

这种虽然比较常用，但是后后面可很可能被deprecate掉啊，所以我们会使用lock。

![](img/9297cc73d7277b29dabde1c81c50b853_13.png)

![](img/9297cc73d7277b29dabde1c81c50b853_14.png)

因为它是从行开始选择，我们先选择row，然后再选择它的列名称。如果你直接给列，如果你用lock再用列名称的话，这很可能报错的。所以要么如果你这个版本的这呃这个pen啊。



![](img/9297cc73d7277b29dabde1c81c50b853_16.png)

![](img/9297cc73d7277b29dabde1c81c50b853_17.png)

![](img/9297cc73d7277b29dabde1c81c50b853_18.png)

python我用的是python3。1。3，如果他没给出warning或者没给出其他信息的话，这样的方案方案是可以的。但是呃我仍建议使用lockuck。



![](img/9297cc73d7277b29dabde1c81c50b853_20.png)

![](img/9297cc73d7277b29dabde1c81c50b853_21.png)

![](img/9297cc73d7277b29dabde1c81c50b853_22.png)

呃，不存在这种未来被取消掉这种使用方法的情况，然后你也可以一直使用。呃，如果我想把fare都整个加2。



![](img/9297cc73d7277b29dabde1c81c50b853_24.png)

那我们可以这样做。那这样子的话就是把这一列菲尔这一列都加上了2，那原来的变了没？

![](img/9297cc73d7277b29dabde1c81c50b853_26.png)

![](img/9297cc73d7277b29dabde1c81c50b853_27.png)

原来并没变，因为我们并没有给它再赋值回去，我们只是加了2，然后它只是当时加上了，但其实并没有赋值。如果想赋值的话，我们要再用DF等于log fair加2。



![](img/9297cc73d7277b29dabde1c81c50b853_29.png)

![](img/9297cc73d7277b29dabde1c81c50b853_30.png)

呃，我这个之前也是讲过的，大家应该应该应该有印象。然后我们来做选择，我们来选下它的。

![](img/9297cc73d7277b29dabde1c81c50b853_32.png)

年龄。H我们如果想选择他这个年龄啊呃所有25岁以上的人，大家想想应该怎么学。那么我选择年龄大于25，对不对？呃，那我这样敲回去会得到什么呢？



![](img/9297cc73d7277b29dabde1c81c50b853_34.png)

我会得到一个true force的东西，它其实是一个蒙版，就是。呃，他是否比如说第一个人。

![](img/9297cc73d7277b29dabde1c81c50b853_36.png)

第0个人，他是否是大于25，他明显不是。我们看一下。

![](img/9297cc73d7277b29dabde1c81c50b853_38.png)

20对它不是它是22。第二个是否大于25呢？它是38，那是大于25的。那所以第二呃第一个就是true。



![](img/9297cc73d7277b29dabde1c81c50b853_40.png)

![](img/9297cc73d7277b29dabde1c81c50b853_41.png)

那我如何做选择呢？就是我想我需要选择所有处e的，嗯，然然后这这些force的不要，对不对？呃，那我就要就相当于一个我们把里面东西叫一个mask或者叫一个遮罩。然后我们在外面再打上一个框。

然后再用DF来选择它，就相当于这个true false和这个DF来做选择。那么我们就会保留一下true嗯，然后丢弃foalse的呃fse的这些信息。那么可以看到我们剩下的人应该都是大于2025的。



![](img/9297cc73d7277b29dabde1c81c50b853_43.png)

![](img/9297cc73d7277b29dabde1c81c50b853_44.png)

这样应该没有什么问题。但是。我们可以看到这边 cabinbin，它是不是有些nonvalue吧。如果我们既想保留。大于25的人。然后我们又想啊这个cabin我们是有数字的，就是不是非NANvalue的。

应该怎么做啊？

![](img/9297cc73d7277b29dabde1c81c50b853_46.png)

Age。

![](img/9297cc73d7277b29dabde1c81c50b853_48.png)

我们先把它给付个值好吧，这样子我们就能保存下来这个信息。然后我如果想。比如说我们想把en的东西给d掉，我们叫drop。



![](img/9297cc73d7277b29dabde1c81c50b853_50.png)

这样子我们是不是就保持下来所有的。cabinbin的就是所有的有 cabinbin呃有 cabinbin number的这个乘客。对吧但是。还有一个问题啊，那我真的drop不掉它了吗？



![](img/9297cc73d7277b29dabde1c81c50b853_52.png)

我们看这样其实没有，因为我没有赋值，对吧？那我们可以用H等于H dropping in a。其实还有一个办法，就比如说drop A in place等于two。



![](img/9297cc73d7277b29dabde1c81c50b853_54.png)

就是这份内自带的一个函数，你只要写上in place，呃，跟上面的方案是一样的。嗯，这两种方法你都可以选吧，都比较常见。



![](img/9297cc73d7277b29dabde1c81c50b853_56.png)

然后。除了这种除了我们刚才使用。

![](img/9297cc73d7277b29dabde1c81c50b853_58.png)

mask遮照的方式来选择。大于35的人，我们还可以用。D F dot where。这种方案来选择大于25的人。得到结果是一样的哈。



![](img/9297cc73d7277b29dabde1c81c50b853_60.png)

可以看到这边。它都是大于25的啊，但是有一个问题哈，它age里面甚至会包括NAN的信息，就是我们foals啊，他直接把这项这个信息删掉了，它仍然是891个人。但是呢。



![](img/9297cc73d7277b29dabde1c81c50b853_62.png)

因为它的圆我来看一下原点。

![](img/9297cc73d7277b29dabde1c81c50b853_64.png)

它就是891，对吧？但是我们如果用where H大于25，那相当于就是把它所有的an value啊，就是所有的不是25以上的人他都给删掉了，变成 anN value，然后我们要做一个drop。

但最终结果其实还是一样的。在你选择和drop之后，呃，我们都能得到一样的答案。

![](img/9297cc73d7277b29dabde1c81c50b853_66.png)

![](img/9297cc73d7277b29dabde1c81c50b853_67.png)

![](img/9297cc73d7277b29dabde1c81c50b853_68.png)

![](img/9297cc73d7277b29dabde1c81c50b853_69.png)

![](img/9297cc73d7277b29dabde1c81c50b853_70.png)

那么除了我们刚才的。这种选择其实大家常比较常见的是这种这样的选择方案。我如果要做双双选择呢，它既大于25，也要比如说。



![](img/9297cc73d7277b29dabde1c81c50b853_72.png)

嗯。他survivd他他仍然存活下来了，我应该怎么办呢？呃，我们先看一下，我们选择出来大于25的这些人有多少，有413个人。那么我再加一个条件，货的概念就要用到这一个这个等于or。

但是在这里面我必须要用。呃，必须要用这个一个。一个竖杠。然后我们要做什么呢？我们需要再给他一个条件。Yes。Yeah。Survived。等于一对吧？



![](img/9297cc73d7277b29dabde1c81c50b853_74.png)

那这样子的话，他可能有点问题哈。

![](img/9297cc73d7277b29dabde1c81c50b853_76.png)

要打一个圆括号在外面。

![](img/9297cc73d7277b29dabde1c81c50b853_78.png)

ok。😊，有一些小问题哈，其实呃这个我刚才说是or，那么这个代表的意思就是它大于25或者它surve了。我们如果想用end的话，呃，那就要用这个emp percent这个符号。呃，那除此之外呢。

我们可能先得把这个这个DF大于25，外面这个mask之外的选择给去掉，呃后我们先把这个len给去掉吧，然后我们把每一个条件打上一个原括号。然后在最外面再打上一个方括号。

然后给到给就里面相当于这个条件已经做好了，这里面应该是一个true force的东西，在方括号里面，然后再给到DF，这样就能选择出来了。那么呃GH大于25以上存活下来的人，那么有110166个。



![](img/9297cc73d7277b29dabde1c81c50b853_80.png)

对吧这个或者是我们再拿len再来看一下。

![](img/9297cc73d7277b29dabde1c81c50b853_82.png)

就是le就是这个data frame它有多长。

![](img/9297cc73d7277b29dabde1c81c50b853_84.png)

或者你直接从我们的pay charm里面也能看得到。

![](img/9297cc73d7277b29dabde1c81c50b853_86.png)

![](img/9297cc73d7277b29dabde1c81c50b853_87.png)

所以这就是我们的。pandas的一个选择的方法。

![](img/9297cc73d7277b29dabde1c81c50b853_89.png)