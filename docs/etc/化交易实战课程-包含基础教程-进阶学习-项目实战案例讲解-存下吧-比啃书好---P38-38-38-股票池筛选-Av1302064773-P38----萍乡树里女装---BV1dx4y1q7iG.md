# 【量化交易教程】全100集（完整版）清华大佬耗时一月讲完的系统python金融分析与量化交易实战课程，包含基础教程，进阶学习，项目实战案例讲解，存下吧，比啃书好 - P38：38.38.股票池筛选(Av1302064773,P38) - 萍乡树里女装 - BV1dx4y1q7iG

![](img/59d16f2acc8eb89f97002a9588ef7d9d_0.png)

好了，那咱们现在啊就是这个中性化操作，我们也写完了。那这里回头来看一下吧，现在我们是不是在这块就可以去执行。哎，咱们刚才写了几个操作了。好了，一个来执行吧。😊。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_2.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_3.png)

啊，在在在这里啊，改写了预除以操作。预除理操作当中啊，咱们一个来写。第一个第一个啊就是咱们去啊做一个3西ig玛。3西玛当中啊，我们要传进来什么？哎，对谁做呀？哎，对我的设值做，还有对我因子做呀。

对因子做吧。好了，把我们的因子拿到手。呃，这里边哦这里边咱的一个结果还没有个返回值，我给它个返回值吧。😊。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_5.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_6.png)

在这块哦，我说咱们现在得到一个返回值，呃，把它复制过来，把它复制过来。fuamental。呃，fuamental当中它指定一个名字吧，fuamental，然后做date frame就行了。

然后在这个d frame当中，就有我们需要的啊，我们想要的这个指标了。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_8.png)

好了，把它拿过来fundamental。然后对其中谁操作呀，是不是咱们之前写好的，我们当前的一个实镜实镜这个东西啊。好了，把它传进来。然后这样咱们做的第一步就是我的一个呃去我们的一个离群值。

去了离均值之后啊，然后咱们写一下吧，就是现在。😊。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_10.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_11.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_12.png)

呃，现在我这个指标就是没有什么没有我的一个呃及值了啊，咱们现在做了一个没有及值的，虽然没有及值之后啊还没完，我们还得再做什么？是不是说再做下一个操作，做一个标准化的一个操作呀。好了。

把咱们当前这个结果传进去。下面我做了一个标准化的操作，相当于。😊。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_14.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_15.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_16.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_17.png)

呃，相当于一个标准化操作，就是这个东西吧，直接把拿过来，然后再点上一个stander。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_19.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_20.png)

呃，der等于我当前的结果行了，这是我做了一个标准化的一个操作。做完咱们的一个标准化操作之后，接下来还有什么？还有一个中性化操作吧。好了，再给它复制过来。😊。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_22.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_23.png)

再他复制快之后，我说哎呀，他就就就叫这个名字得了，他就就叫做预处理完之后，然后杠上这个东西。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_25.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_26.png)

然后等于咱的这个结果好了，等于我们这个结果，然后把上面这个值再传进来是不就可以了。那现在我们就完成了咱们所需要的所有的与处理操作了。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_28.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_29.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_30.png)

那接下来呢哎接下来是不是说我现在啊哎呦我要对这个因子做一些筛选呢？好了，咱们指定一下呃，对因子啊，不是对因子。基于因子啊对池子对咱们的股票池子做做一个筛选或者做一个调仓做筛选吧。😊。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_32.png)

做一个筛选操作。筛选操作咱来想一想怎么去做啊，是不是这里哎你得给我指定一个指标啊，比如说我这个QQ当中呢呃，你说是小于这个因子是小点好还是大点好啊，咱们之前不是说小点好吗？所以说我对大于这个指标。😊。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_34.png)

我看一下吧，它的呃比如说从小到大啊，就是20%的时候，它是等于多少？就是我们希望选出来前20%最小的可以吧。好，这里我们来指定一下。切一下吧，咱们来选多少个，那我就选这么呃0。2个吧，相当于选了20%。

然后呢，这里这是我做了一个因子策略。然后接来接下来是不是说我要去选股了？那好了，现在我们要选股，在这个选股过程当中。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_36.png)

我需要在怎么样？我们看一下当前。当前我得到这个结果，这个是我的一个因子。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_38.png)

对我的因子当中，我要做一个。所有的股票当中啊都有这个因子是吧？那所以说我现在可以做判断吧，做一个筛选吧。在这里哎，我说现在啊如果说啊它的一些值啊，如果说它的一些指标怎么样，没有满足我的要求。

没有满足什么？咱刚才不是说了吗？我们自己哎指定一个范围。通常啊就是我们这个市净率啊，我希望它不是小一点的时候能怎么样，能使得咱的一个收益，或者说我们那一个期望收益吧，可能会更大一点吧。

就这里哎咱们说小于等于一个零小于等于一个20%那个值啊，是不是行了，我们现在先来选小一点的那一些然后呢我需要把这些股票找到手，点d一下，这是不是呃这个东西判断是基于值去判断的居值判断完之后。

咱们现在相当于传进来，所引我得到什么？做的股票吧？好了，那这这这这是什么股票。😊。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_40.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_41.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_42.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_43.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_44.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_45.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_46.png)

这是不是说我这是我现在想要的这个股票啊判断完的，我想要的这批股票。好了，我们拿到这股票。呃，一会儿咱要对这股票做一些做一些交易操作。我们先把它传到这个contest当中，contest当中呃。

stocklist等于一下我当前的一个结果呃，这块不改了，直接把它传过来就行。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_48.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_49.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_50.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_51.png)

好了，这我们现在呃有了一个starlist。然后接下来呢就是我们要干什么？我们要执行一些调仓，还有买进买出的一些操作了。呃，在这里就是我们要做买进买出啊，那你是不是说你得知道哎呀买什么。

或者说你把哪些要删除出去啊，然后剩下的是在股票池当中去选吧。那首先我们得看一看一会儿啊有哪些不在这个池子。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_53.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_54.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_55.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_56.png)

好，我就写一下呃，删掉删掉不在当前呃当前那个呃因此选中的池子中的股票啊，咱们要做一个删除，删除怎么写呢？来写一下吧。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_58.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_59.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_60.png)

呃，删除我是不是说你把这些股票呃给它删一下，删完之后呢，我也知道你删了什么东西啊。好了，这是一个返回值，返回值啊不当中就包括了所有我要删的那来想一想吧，哪些哎是我要去删的那肯定是之前咱有的啊。

并且跟我当前池子是不一样的这个是我当前的我的一个池子吧。好了，我把它复制过来，这是我当前的一个池子，我先给它括括起来，那我们要看的那肯定就是哎呀现在手里有的股票，跟我们当前池子，那不一样的。

我就有一个difference操作。😊。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_62.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_63.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_64.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_65.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_66.png)

呃，DFFRENC。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_68.png)

different操作。好了，这是对谁啊？是不是说现在我手里有的这些啊？那好了，那我们先拿到手里有的吧啊，这块呃咱们还再写一下，就是拿到。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_70.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_71.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_72.png)

拿到手里有的拿到手里有的，咱们也指定一下，在这个contest当中。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_74.png)

把这个哦不用复制上面的，咱这也有在这个contest当中啊，我们要找谁呀，是不是找我们现在哎我的一些账户的一些信息啊，在账户信息当中，我要看什么，我持有什么东西吧，position哎，没有啊。

这是position找一下呃，看一下，在我持有这是1个IO是吧？

![](img/59d16f2acc8eb89f97002a9588ef7d9d_76.png)

哎，没什么问题啊，他怎么没没有这个东西啊position咱试一下吧，一会儿看一看这个API有没有问题，有问题要改。我记着了它是一个positions。好了，这是我现在手里用，对吧？咱先也拿到手啊，然后。

😊。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_78.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_79.png)

指定个名字，这个就是我的一个contex点R呃，咱们最后一次手里有的啊，咱指定一下我们最后一次手里有的这些个股票吧啊，就叫做这个股票得了。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_81.png)

好了，然后呢，我是不是用现在手里有这个东西啊，跟我当前池子的对跟我当前这个池子的做一个判断。判断完之后，difference什么意思啊？那就是说当前你手里有这些股票，不在你池子里边的，哎。

这是difference吧。咱把这些股票给它拿到手吧啊，是这个意思。然后这个这个我把这个前面就得给它复制一下。



![](img/59d16f2acc8eb89f97002a9588ef7d9d_83.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_84.png)

![](img/59d16f2acc8eb89f97002a9588ef7d9d_85.png)

好了，就完事儿了。这个就是咱们当前啊完成的一件事儿。好了，呃点set一下吧，做集合。😊。

![](img/59d16f2acc8eb89f97002a9588ef7d9d_87.png)