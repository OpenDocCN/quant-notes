# 【比刷剧还爽！】Python量化交易+机器学习大数据全套教程，入门到精通 2024B站最好的量化交易课程！（数据挖掘分析／大数据／投资／金融／股票／算法） - P7：7.1-连续指标变化情况分析 - AI课程搬运工 - BV1ps421T7ez

![](img/081d9824cd90cedc37516f0241cd669f_0.png)

那我带一件事儿。哎，这个平均结果啊，我可不可以做一些加法的操作呢？你看这里现在我们观察什么啊，是一个平均结果，那相当于一个从整体上来看啊，这样一个结果是不是？那我能不能对一个连续时间算它的一个增长率呢？

什么叫一个连续时间算它的一个增长率啊，为大家举个例子？

![](img/081d9824cd90cedc37516f0241cd669f_2.png)

比如说这样。比如这样，现在我有一只呃，我我现在我有一只股票啊，现在这个股票是100块钱可以吧？啊，比如说是我我写个第一天价格是100块钱。然后呢，第二天第二天啊它这个跌了啊，跌成个50块钱行吧。

那你说啊对于这个两天来说，对于这两天来说啊，我的一个增长率是有多少？那是不是说用50哎减去1个100再比什么，再比上1个100是吧？那就是负的50啊，减去比上1个100是不是？那好。

第三天第三天这个东西啊，如果它涨了。涨到1个75，那你说第三天来说，那是不是用第三天减第二天的呀，那它就是1个75减去1个50，再比谁再比上1个50吧。那咱们来看一下，对于当前这个结果来说。哎。

你看啊之前我们大家想就是增长率这个东西。我能不能把各个指标增长率就是把咱整个这个序列啊，我算出来这个增长率，然后一个加到一起，我当做最终的一个总的增长率啊，哎，我能不能这么去算啊。

大家感觉好像没什么不行的呀，增长率加呗，加完之后算完就总的增长率，总的增长率反个整体行不行？好像来说够呛。啊，总总的价长率不是反应整体是反映第一天和最后一天他们的一个结果，那能加吗？再加试试吧。

你看这个加法一旦做完之后，咱等于什么？😊，这等于一个-0。25，是不是这等于什么？这等于一个正0。25，加一起怎么样？等于0。一旦看到0，咱们可能觉得哎呦从第一天啊到第三天中间隔了两天隔完之后呢。

我算了一个累加的一个增长率等于02，那就说明我这个股票那就是没跌它也没涨。但是呢我们来观察一下原始多少100现在多少，期数5跌没跌啊，跌了吧。所以说对于这个增长率来说能做加法吗？不能做吧。

那这回那大家可能想哎呦那我现在一个连续时间的序列，如果说我想做一些累加操作，我们该怎么办呢？那对于连续的计算，我们需要借助上一个数学公式啊，就是一个对数，给大家举例说明一下吧，咱们实际当中啊是怎么算的？

这里啊我们用对数，对数当中呢，比如说呃我们的后一天数据再比上前一天数据，那比如说刚才咱们不是说了，第一天是100，第二天是50，第三天是1个75嘛，那就是这里哎我们后一天那就是1个50比上1个。😊。



![](img/081d9824cd90cedc37516f0241cd669f_4.png)

100是吧，然后呢再加什么再加上一个第二天的对，不是第二天的，就是下一个序列的。下一个序列就是1个75，那比上1个50是不是就可以了。那这回咱们来看啊，之前咱不是说了吗？

我这样一个连续的一个增长率反了什么？那第一天和最后一天的结果之间做了什么样的一个差异吧。那怎么样描述出来这个指标呢？你看好这个对数当中，如果说咱都以一为底，可以吧？都一为底的时候，那对数的加法。

那等于什么等于对数当中里边的一个乘法吧，那就是50比上1个100，再乘上1个75比上1个50等于什么？等于对数当中75比上一个100相当于什么最后一天的跟第一天之间一比，它们之间的一个差异是有多大吧。

是不是这样一个指标，我们给它计算出来了。那其实这个指标你形象点是什么意思呢？😊，就比比如说股票股票一开始是10块钱，然后呢，10块钱完之后啊，然后它经过了好多次就是时间序列，然后有涨的有跌的。

有涨的有跌的。你把各个值把各个这个增长率哎给它用对数，然后累加一起，最后相当于什么？那不就相当于最后一天跟第一天的一个结果之间的一个差异了吗。

那这个的意思就相当于你第一天股价这个钱相当于最后一天它是多少钱啊，说白了就是一开始股价的1块钱，110年股价的1块钱，相当于最后一天股价是多少钱了啊，大概是这样一个意思啊。我大家写一下。

就是咱们的一个计算的方法。好了，这块我们计算一下连续时间啊。呃，在这块我们来计算一下吧，这个计算呃好像没有什么特别公式，我们自己去写一下，首先呢我们来写就是data比上什么，比上它的一个前一天的吧。

呃有这个前一天数据。😊。

![](img/081d9824cd90cedc37516f0241cd669f_6.png)

![](img/081d9824cd90cedc37516f0241cd669f_7.png)

咱怎么样能得到啊？哎，这个问题来了，前一点数据怎么得到？data当中，我说我把这个数据啊，要是你看这里。如果说这个数据要是每一天啊都能往前滚一下，就是这样。一开始是这个位置，我说给它都往上移这么一格。

把它移上去一下。那当前这一天的是不就变成前一天的了，是不是这样一个意思啊？我要把它往上移一格是不是就行了呀？那怎么移这一格呢？嘿，不用担心了，有这样一个函数来帮我去做，哎，点shift一下。

shift当中啊，你可以去选哦移几格，比如说这样吧，我先移一格给大家看一看。😊。

![](img/081d9824cd90cedc37516f0241cd669f_9.png)

你看啊这个1月5号来看看这个1月5号，它现在是呃30。572是吧？来看1月5号30。572，30。572其实是谁？其实是1月4号的吧。所以说我们现在这个1月5号的，是不是就表示的是前一天的数据了。

那比如说现在我们有一个data，我们还有一个data点shift完的。你看这个data点我这个鼠标有。data点shift完的shift就是一个一的那你说我怎么计算，我这两天之间的一个差异啊，哎。

这是正常的数据，这数据都往前回滚了一格。我做一个减法，是不就直接得到了数据两天之间的一个差异的结果啊啊，所以说我们的做法还是简单的这里。咱们只用data啊，我们的当天数据比上什么。

比上它前一天的数据是不是就行了。然后呢，咱们之前说了，哎，这块我们要怎么办，是不是你得给我引入一个对数啊来表示当前结果啊。好了，再指定个ret等于当前我做的这样一个结果。然后呢把这个结果展示一下吧。



![](img/081d9824cd90cedc37516f0241cd669f_11.png)

哦，这个结果先执行一下啊，执行完之后，然后给它点head一下。好了，这个结果已经显示出来了，哦，我还是点lo一下。😊。



![](img/081d9824cd90cedc37516f0241cd669f_13.png)

然后只保留其中几位。

![](img/081d9824cd90cedc37516f0241cd669f_15.png)

行，这我们是不是算出来了，当前我们的一个什么连续的啊一个增长率吧。说白了就是第一天跟后面每一天的我都能算出来。也有第一天的价格啊，就是第一天是1块钱，相当于第八天是多少钱呢？相当于第30天是多少钱呢？

各个指标值，咱是不是全全有了，那其实现在还没全有，现在我们只是算了一个中间结果是吧？我们还差一步，还差一步，差什么，我们没有把这个结果给还原回去吧，我们只算了一下这个连续的一个增长率，它的变化情况吧。

那你说怎么样给它还原回去啊？

![](img/081d9824cd90cedc37516f0241cd669f_17.png)

![](img/081d9824cd90cedc37516f0241cd669f_18.png)

![](img/081d9824cd90cedc37516f0241cd669f_19.png)

![](img/081d9824cd90cedc37516f0241cd669f_20.png)

![](img/081d9824cd90cedc37516f0241cd669f_21.png)

咱们实际上是不是在这里，哎我刚才还看了一下，我们有一个要求要干什么来着？我要统计啊，看各指标最初的1块钱，相当于比如说10年的1块钱，相当于1年多少钱，相当于12年多少钱。

相当于13年、14年、18年多少钱。对于某一个股票来说，我是不是要把这个结果给它算出来啊，那怎么样统计这样一个指标啊。那比如说这样，我要画一个图。



![](img/081d9824cd90cedc37516f0241cd669f_23.png)

![](img/081d9824cd90cedc37516f0241cd669f_24.png)

![](img/081d9824cd90cedc37516f0241cd669f_25.png)

我画一个图可能是这样啊呃就在这个图当中。那比如说呃这里我就画那个那个那个微软的股价吧，微软股价，那在这个10年的时候啊，它只1块钱是吧？就假设它是一个单位块钱。然后呢，我要知道这1块钱相当于11年的啊。

比如相当于11年的2。3块。然后相当于12年的4。2块，然后一直点点点点点一变化，相当于比如说19年或者是20年咱这数据没有20年咱数据就到18年，我想看一看它相当于18年的多少钱。

是不是也是股票的一个走势啊，或者相当于我手里有个股票，我这么多年翻了多少番吧，咱是要观察这样一个指标值啊，对实验学员来说，挺长统，就是经常有统计的一个值吧。😊。



![](img/081d9824cd90cedc37516f0241cd669f_27.png)

![](img/081d9824cd90cedc37516f0241cd669f_28.png)

![](img/081d9824cd90cedc37516f0241cd669f_29.png)

怎么做？怎么做这件事儿啊？第一步，那你说我现在哎在统计过程当中，那你说这个11年的时候。你看我现在我有这个10年11年12年13年，我就写14年得了。那对于10年来说呀。

它是不是得把前面的值都加在一起呀，是不是？那对于12年来说呢？12年来说，他得把1011和12的都加到一起了。哎，一个做一个加法操作吧，咱既前说了对数做加法，相当于我直接得到第一个和最后的一个关系吧。

是不是这样一件事儿。那13年呢13年这里我这是可颜色的快化没了。13年这里是不是要算他们的，然后最后一个红色的，14年要算这样一个值啊，这是什么？😊，累加吧，那这件事怎么去做呀，怎么做？

其实有个函数给大家简单来看一下，这个函数啊叫n派点com sum下。😊。

![](img/081d9824cd90cedc37516f0241cd669f_31.png)

com up当中给大家举个例子，比如说1234吧，咱先来看结果。

![](img/081d9824cd90cedc37516f0241cd669f_33.png)

我看这个总和它有不错了哦，对，type哦这块我先传一个序列啊，传一个list。

![](img/081d9824cd90cedc37516f0241cd669f_35.png)

意思当中1234可以吧，你看它给返回什么？136一是什么？第一个值二呢哎第二个位置为什么3啊？1加二等于3吧，第三个位置为什么是6啊，一加2加三等于6吧，第四个位置为什么11加2加3加4等于10吧。

好了，函数给大家列出来了。那你说咱一会儿在做的过程当中，是不是也是借借助于这种conum的方法来去做呀，那对谁做操作啊，这块给大家列出来了，这南派各个就是根据于时间序列，哎，我各个地方的值。

咱是不是全有啊，把它们干什么，做累加不就得了吗？好了，把这个结果拿过来。😊。

![](img/081d9824cd90cedc37516f0241cd669f_37.png)

![](img/081d9824cd90cedc37516f0241cd669f_38.png)

对这个结果做什么，做一个comp up操作，是不就行了，对它只用comp sum操作。但是呢。哎，你看之前我说这个结果，我为了咱能实际做计算啊，引入了数学上的一个公式，叫做一个对数，是不是？

那现在你是不是讲到底，你得给我还原回去了，还原回去怎么办？咱得给它怎么样做一个n派点多少亿的多少次幂吧，这是E叉P表示E啊，咱之前默认n pair log就是以为底的。所以说此时当我再执行的时候。

点op派操作，咱之前讲那个pa技术的时候，是不我说过了，对其中每一个都只行这样操作嘛，咱还原啊，还原之后呢，我顺便把这个图给大家画出来吧。😊。



![](img/081d9824cd90cedc37516f0241cd669f_40.png)

呃，这个图然后他等于个16的，然后再执行一下。

![](img/081d9824cd90cedc37516f0241cd669f_42.png)

看一下这个图的结果，你看是不是像我刚才说的，最开始相当于这块一也不是相当于1块钱，就当于一个单位吧。啊，其实对股票来说，你就当做1块钱吧，1块钱，相当于11年多少钱，相当于12年多少钱。

131415161718是不是全有了呀？我看我看最最猛的是谁啊？最猛的是啊亚马逊这个是吧？之前他10年的1块钱，现在已经能相当于什么了？10块钱了吧，咱是基于什么？连续的一个增长率来去做计算的吧。啊。

然后你看下面了，第二是么？第二个第二个是苹果的是吧？苹果的大概是呃4块多是吧？这是大概翻了多少番啊，这个意思，那你要拿拿那个茅台来说，可能翻的更多啊，行了，这是给大家看了一下。

就是对于我们的金融时间序液来说呀。😊。

![](img/081d9824cd90cedc37516f0241cd669f_44.png)

![](img/081d9824cd90cedc37516f0241cd669f_45.png)

![](img/081d9824cd90cedc37516f0241cd669f_46.png)

我们能统计值其实挺多的。在这里呢是给大家列出来了一些经典的，不是说经典吧，就是常用的一个操作啊，我们怎么样计算一个差异值点difference一下，非常容易吧，差异值我就算出来了。

第二点的增长率增长率好像我刚才说的一个差异值可能有很多时候都是没什么价值的，多了少了一块，对于不同任务来说，对于不同的指标来说，可能你衡量起来，那这个一代到底代表什么不好说吧。好了，我们提到一个增长率。

后一个值减前一个值再比上前一个值很简单吧。然后呢给大家绘图啊画了一下啊，也比较直接。然后呢，我又说了一下。😊。



![](img/081d9824cd90cedc37516f0241cd669f_48.png)

![](img/081d9824cd90cedc37516f0241cd669f_49.png)

增长率这个东西啊，你算平均的行，但是你不能给我算一个累加吧，因为累加在一起它是没有意义的吧。所给大家举了个例子啊。那如果说我想算这个累加呢，我想算就是第一天啊，相当于后面几天的多少倍。

再相对后面几天多少倍，怎么算呢？它是不是一个连续时间增长率啊，我们引入了数据这种方法做什么做一个对数吧，不要忘记啊对数这块你做完之后，如果你想还原到实际数值是不是得再给他还原回去呀啊，有这样一件事吧。

最初咱统计了一下，当初哎最早的1块钱，相当于现在多少块钱，数给大家做完了1块钱相于多少啊，有有有比较强的公司，相当于十来十几块钱，其他的那其实走势都挺高的。但是呢也有一些指标可能是下降的。

可能保持不变的吧啊，反正就是当初你要买这些股票人基本上都发了，是不是这个意思啊？好，现在大家看了一下，就是我们对这个金融实间序列当中啊，一些序列的啊，我们的计算操作。😊。



![](img/081d9824cd90cedc37516f0241cd669f_51.png)

![](img/081d9824cd90cedc37516f0241cd669f_52.png)

![](img/081d9824cd90cedc37516f0241cd669f_53.png)

![](img/081d9824cd90cedc37516f0241cd669f_54.png)

![](img/081d9824cd90cedc37516f0241cd669f_55.png)

都该啊怎么样去在pandas还有n排当中啊实现出来。其实说白了就是用这些工具包帮我们去做事情。

![](img/081d9824cd90cedc37516f0241cd669f_57.png)

![](img/081d9824cd90cedc37516f0241cd669f_58.png)