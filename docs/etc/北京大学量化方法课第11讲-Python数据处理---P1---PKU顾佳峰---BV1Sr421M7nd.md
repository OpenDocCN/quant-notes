# 北京大学量化方法课第11讲：Python数据处理 - P1 - PKU顾佳峰 - BV1Sr421M7nd

亲爱的同学们，大家好，我是北京大学顾佳峰老师，我们今天继续来讲，北京大学量化方法课的公开课，今天讲第11讲，那我们呢，北京大学在今年的9月20至22号，在北京大学举办量化研究方法研修班啊。

我们可以可以大家可以关注中国民生观察，这个可以具体了解这个项目的情况。

![](img/41db0d52ef050034885b2fe21384a024_1.png)

那这个研修班呢也有证书啊，我们可以发布，另外呢这个今天我们讲Python，来做量化分析的一些基础的准备嗯，这主要是关于数据库的一些操作啊。



![](img/41db0d52ef050034885b2fe21384a024_3.png)

我们额接着上节课讲。

![](img/41db0d52ef050034885b2fe21384a024_5.png)

比如说我们前面的数据库里面要找出这个。

![](img/41db0d52ef050034885b2fe21384a024_7.png)

![](img/41db0d52ef050034885b2fe21384a024_8.png)

找出里面关于数据数学的。

![](img/41db0d52ef050034885b2fe21384a024_10.png)

![](img/41db0d52ef050034885b2fe21384a024_11.png)

这个命令。

![](img/41db0d52ef050034885b2fe21384a024_13.png)

这我已经赚了很多。

![](img/41db0d52ef050034885b2fe21384a024_15.png)

![](img/41db0d52ef050034885b2fe21384a024_16.png)

运行这一步。

![](img/41db0d52ef050034885b2fe21384a024_18.png)

我们可以看到他这个数学嗯。

![](img/41db0d52ef050034885b2fe21384a024_20.png)

那一列的数据就出来了，然后呢我们也可以查看所有元素的数据嗯，里面我们可以看到姓名。

![](img/41db0d52ef050034885b2fe21384a024_22.png)

然后具体的每每个这个对应的科目的成绩。

![](img/41db0d52ef050034885b2fe21384a024_24.png)

另外我们可以选两列数学跟统计学。

![](img/41db0d52ef050034885b2fe21384a024_26.png)

我们可以看到这是数学的成绩，统计学的成绩。

![](img/41db0d52ef050034885b2fe21384a024_28.png)

另外我们也可以指定选第二行，第二行的数据呢就是这个同学的成绩。

![](img/41db0d52ef050034885b2fe21384a024_30.png)

另外我们也可以指定第三到第五行，用这个这是呃指定这个第二到第第二与第四行。

![](img/41db0d52ef050034885b2fe21384a024_32.png)

当然你也可以把它换成第一到第一跟第四诶。

![](img/41db0d52ef050034885b2fe21384a024_34.png)

也可以啊，然后呢比如说第一到第五这些都可以换。

![](img/41db0d52ef050034885b2fe21384a024_36.png)

就是你要是可以就D1到D4吧。

![](img/41db0d52ef050034885b2fe21384a024_38.png)

因为最高他只有四对吧，嗯嗯你前面还可以有零。

![](img/41db0d52ef050034885b2fe21384a024_40.png)

所以这些呢都可以换。

![](img/41db0d52ef050034885b2fe21384a024_42.png)

另外呢你也可以选择呃，第二到第四。

![](img/41db0d52ef050034885b2fe21384a024_44.png)

这个234或者是2is是指后的。

![](img/41db0d52ef050034885b2fe21384a024_46.png)

也可以也可以同时选择多行跟多列啊，数据里面的。

![](img/41db0d52ef050034885b2fe21384a024_48.png)

比如说一个三行，然后呢0243列。

![](img/41db0d52ef050034885b2fe21384a024_50.png)

123列，这些都可以做出来，这个一个字跟三呢实际上是第二行跟第四行，因为它的起始标题临时第一行啊。

![](img/41db0d52ef050034885b2fe21384a024_52.png)

另外呢我们还可以看一下第二第四行，还有呢134列这个选项啊。

![](img/41db0d52ef050034885b2fe21384a024_54.png)

基本上这个一三跟这个是一样的啊。

![](img/41db0d52ef050034885b2fe21384a024_56.png)

另外我们也可以选取第二行。

![](img/41db0d52ef050034885b2fe21384a024_58.png)

第二行以后的所有行，234嗯。

![](img/41db0d52ef050034885b2fe21384a024_60.png)

这个二其实是三啊，然后这个我们也可以选择第二行的所有前行。

![](img/41db0d52ef050034885b2fe21384a024_62.png)

012，然后每隔一行选一行。

![](img/41db0d52ef050034885b2fe21384a024_64.png)

这个用这个。

![](img/41db0d52ef050034885b2fe21384a024_66.png)

哦是就隔了一行学一行，另外呢可以把新的成绩插入到里面去。

![](img/41db0d52ef050034885b2fe21384a024_68.png)

这样我们可以看插入以后呢。

![](img/41db0d52ef050034885b2fe21384a024_70.png)

我们录入一个新的列，插入以后就多了一个会计学，所以这个数据又又增加了一些。

![](img/41db0d52ef050034885b2fe21384a024_72.png)

另外呢我们也可以跌看一下这个呃，统计数学这个也是一样的道理。

![](img/41db0d52ef050034885b2fe21384a024_74.png)

插进去也是一样的道理啊。

![](img/41db0d52ef050034885b2fe21384a024_76.png)

然后我们呃还可以读取数据以后直接插入。

![](img/41db0d52ef050034885b2fe21384a024_78.png)

这个是从原始数据里面读出以后直接插入对。

![](img/41db0d52ef050034885b2fe21384a024_80.png)

然后呢我们也可以删掉指定的行和列嗯。

![](img/41db0d52ef050034885b2fe21384a024_82.png)

删掉只是比如说我们把数学删掉，就叫这个。

![](img/41db0d52ef050034885b2fe21384a024_84.png)

然后我们也可以做其他的一些统计学。

![](img/41db0d52ef050034885b2fe21384a024_86.png)

经济学嗯，就是对于列进行处理。

![](img/41db0d52ef050034885b2fe21384a024_88.png)

这个也是一样。

![](img/41db0d52ef050034885b2fe21384a024_90.png)

统计学经济学我们另外得行也可以删掉，删掉第三行。

![](img/41db0d52ef050034885b2fe21384a024_92.png)

零一第三行其实标id编号为二，所以第三行就没了。

![](img/41db0d52ef050034885b2fe21384a024_94.png)

就是标号为二的这一行也没有了，另外我们可以把它的字段名进行修改啊。

![](img/41db0d52ef050034885b2fe21384a024_96.png)

经济学改成管理学，这些都修改过了。

![](img/41db0d52ef050034885b2fe21384a024_98.png)

另外我们可以修改里面的乘积，比如说某个同学的成绩，我们课的成绩我们都可以修改过来。

![](img/41db0d52ef050034885b2fe21384a024_100.png)

还有可以修改所有同学的统一成绩。

![](img/41db0d52ef050034885b2fe21384a024_102.png)

一次性修改，另外呢可以把制服数字型改变改变成字符型。

![](img/41db0d52ef050034885b2fe21384a024_104.png)

字符型，我们可以看到这些这个出来就是这样啊。

![](img/41db0d52ef050034885b2fe21384a024_106.png)

然后呢把姓姓名。

![](img/41db0d52ef050034885b2fe21384a024_108.png)

我们可以排序，按照拼音排序啊，性排序你看都可以出来。

![](img/41db0d52ef050034885b2fe21384a024_110.png)

另外可以也可以按照其他的排序，比如说笔画排序啊。

![](img/41db0d52ef050034885b2fe21384a024_112.png)

也可以，然后呢排序我们可以用index嗯。

![](img/41db0d52ef050034885b2fe21384a024_114.png)

这这个指标，另外呢按照统计成绩排序嗯。

![](img/41db0d52ef050034885b2fe21384a024_116.png)

统计从高到低排序排完了，然后也可以合并数据框。

![](img/41db0d52ef050034885b2fe21384a024_118.png)

两个数据进行合并啊，两个数据进行合并。

![](img/41db0d52ef050034885b2fe21384a024_120.png)

因为成绩差不多就多了很多，然后合并执行合并数据框。

![](img/41db0d52ef050034885b2fe21384a024_122.png)

我们把它两个合并嗯。

![](img/41db0d52ef050034885b2fe21384a024_124.png)

然后呢也可以把名称进行合并。

![](img/41db0d52ef050034885b2fe21384a024_126.png)

这个也可以定义关键词。

![](img/41db0d52ef050034885b2fe21384a024_128.png)

关键词就定义出来对吧，所以我们可以看，用用用Python可以做很多对于数据框的处理。

![](img/41db0d52ef050034885b2fe21384a024_130.png)

你其实语言也很简单。

![](img/41db0d52ef050034885b2fe21384a024_132.png)

你只要懂得语言，其实基本上诶他就非常简单的处理好。

![](img/41db0d52ef050034885b2fe21384a024_134.png)

我们今天的课就讲到这里。