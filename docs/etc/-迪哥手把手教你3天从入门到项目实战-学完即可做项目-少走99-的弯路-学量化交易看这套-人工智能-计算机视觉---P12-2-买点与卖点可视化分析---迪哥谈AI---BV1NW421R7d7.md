# 【2024版金融量化】AI结合金融如何做落地项目？迪哥手把手教你3天从入门到项目实战，学完即可做项目，少走99%的弯路，学量化交易看这套！人工智能／计算机视觉 - P12：2-买点与卖点可视化分析 - 迪哥谈AI - BV1NW421R7d7

![](img/7cccf2f879f6a99312c1e2cad0044ebd_0.png)

好了，我们第一步导进来咱们当前啊所需要的这些工具包，n排 map plot啊，这不用说了，咱把之前的全复制过来就行了。然后呢读数据啊，还是啊我们之前的那个data点CSV指定我们的索引第一列是什么。

第一列索引就是咱们当前选的哎那个时间是吧？然后把时间解析一下啊，然后把这个结果拿到手了。那会之后啊，一会儿我会选股票。



![](img/7cccf2f879f6a99312c1e2cad0044ebd_2.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_3.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_4.png)

啊，这里头有几个股票是吧？咱就拿这个苹果这个股票来当例子给大家做这样一个实验。然后这个iner咱也不用去看了，这是咱的一个数据。好了，我们完成这样几个事儿。



![](img/7cccf2f879f6a99312c1e2cad0044ebd_6.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_7.png)

来看一下吧，咱们要做一事儿啊。首先第一件事。

![](img/7cccf2f879f6a99312c1e2cad0044ebd_9.png)

啊，你说我们要去选择苹果的骨架，并且呢在咱之前在做例的时候，是不是说可能有问题，什么问题？数据当中可能会存在缺失值吧，一存缺失值。哎，你做一些实验窗口的时候，可能会有一些问题吧。

所以说咱们在预处理的第一个阶段，先干什么，把缺失值全部的给它去掉吧啊，这个是我们要去做的一件事。行，那在这会我们先把这个数据拿到手，我说这个data啊，我把这个data拿到手吧。



![](img/7cccf2f879f6a99312c1e2cad0044ebd_11.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_12.png)

等于什么呢？等于啊我把我当前的数据给传进来。呃，我只需要一列就行了。就是苹果的这一列吧。好了，把苹果这一列名字我给它复制过来。然后呢，接下来啊现在把这个列我有了，然后干什么呃，不要忘记。

我们要去去掉这个确认值吧，再做一个照片A呃，然后我打印一下这个data。

![](img/7cccf2f879f6a99312c1e2cad0044ebd_14.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_15.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_16.png)

data点head一下。行了，我们现在数据有了，这个不就是咱现在我想要的份数据吗啊，只有苹果这个股价了。第一个这儿咱做完了，非常简单吧啊，先做了一个取确失值。



![](img/7cccf2f879f6a99312c1e2cad0044ebd_18.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_19.png)

第二步，计算我短期和长期的一个均线。那短期和长期第一步，你是不是得先告诉我这个短期咱要多少天，这个长期咱要多少天吧。好，那我来写一下。一个短期，然后呢再来一个长期，这里这样啊就是短期和长期啊。

咱给它写的稍微的大一点。因为咱们这个数据啊，你看我这边看不出来这个数据咱一共多少条，有这么2000多条，大概是得有个78年的一个数据了。所以说在78年的数据当中啊，呃，如果你这两个值指定太小了。

在咱图当中画的那就太不清楚了。所以说我先把这两个指标值啊画的稍微的大一点啊，咱来看正常就是短期可能5天比较常见，长期是2天比较常见。但是我也刚才说了，咱们任务现来说数据量比较多。

我把这个数值啊稍微的设置那么大一点啊，咱好观察，行第一步，我先把这个短期和长期的一个时间设出来了。那接下来呢。



![](img/7cccf2f879f6a99312c1e2cad0044ebd_21.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_22.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_23.png)

接下来我们是不是要算这个均线了，或者说算这个走势了，这个该怎么算啊？在咱们当前的我的这个数据当中，我是不是要对这个数据做什么？



![](img/7cccf2f879f6a99312c1e2cad0044ebd_25.png)

做一个各种窗口吧，得把好多窗口全做出来吧。好了，把我当前的一个短期先传进去，这是我窗口这个大小吧。每个窗口算什么？哎，咱该说的，比如这都是收盘价，算收盘价什么值，是不是一个均值啊，在这里我再点密一下。

把这个均值拿到手是不是行了？然后这里我说我计算了一下。呃，然后计算完之后，我把这个结果回传到咱当前的dig frame当中，并且给它指定个名字，可以吧？好了，然后我来执行一下呃，执行完之后哦。

把下面也执行吧，下面就是第二个，然后这个改成一个二就得了，执行两次。

![](img/7cccf2f879f6a99312c1e2cad0044ebd_27.png)

呃，我看这块出现出现个小问题。呃，这个KR原因啊，是因为现在啊当我把这个数据就是加了一列之后，现在列数据当中不有两列嘛？有两列数据，然后我再做这个roing的时候哈，你就得去指定好了。

你对谁来去做这个roing这样一件事吧。因为现在我们数据当中它就不是有这么一列了。所以我得给它指定出来，就是在数据当中啊，我对呃我看的名字啊，对我的苹果的股价啊，这个多加一步。

其实正常情况下在上面多加一步也行啊。然后再执行一下啊，行，没问题了。然后呢看一下我们当前这个数据得一下。



![](img/7cccf2f879f6a99312c1e2cad0044ebd_29.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_30.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_31.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_32.png)

啊，这边会出现好多趋失值是吧？那也正常，因为前面几个窗口，你得最少得有42窗口才能有这样一个值吧。好了，点t一下吧。t当中我们是不是能把它的一个短期SMA1短期啊，这个A2它是一个长期是吧？好了。

这一步我完成了，就是分别咱计算了一下这个短期还有长期均线，我们的一个结果，然后若果是大家想画图啊也很简单，你可以画图展示一下对我们这个data当中啊你不是有这些指标嘛，对data。

我直接的我去点pl一下是不就行了。当中你就指定一下这个图它的一个大小啊，咱指定的稍微这么大一点，看结果吧。好了，这图是不是有了，你看这个图当中啊，是不是发现了一些事儿啊，咱可以来分析分析啊。

它是不是有几个焦点，你看我们先来看这个红色的就是原原始股价咱就不看了啊，咱就看这个短期和这个长期，然后有这个红色的，还有这个绿色的，然后呢找一找吧，我们当前这个红色的，哎，这里。😊。



![](img/7cccf2f879f6a99312c1e2cad0044ebd_34.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_35.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_36.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_37.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_38.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_39.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_40.png)

红色的和绿色当中啊会有一些点吧。那这些个点是不是都是我们需要考虑的一些对象了。来看第一个点，第一个点，绿色的我的短期均线跟长均线做交叉了，并且箭头往哪儿的，往下的，说明该什么了。你说此时哎。

咱们是该买还是该卖啊，这是什么，这是死亡，这是死亡交叉吧，该卖了这个东西，然后再看一看，我看有没有往上的哦，找一找在这里这个位置。这个位置可能不太明显，来看一看这个位置吧，这个位置挺明显的。

这个位置怎么样了，交叉完了怎么样是要涨了吧啊，这一块就是我们的一个黄金交叉。我们的一个买点吧。好了，跟大家看了一下，就是在这张图当中，我们已经能够啊显示出来了当前一些啊我们的一个结果了。

然后这个数据咱再处理处理吧，上面咱之前看的时候怎么样了，是不是有很多个缺失值啊，所以说咱就把确失值一会儿再去掉啊，我看第三问啊，第三问就是做一个标记。😊。



![](img/7cccf2f879f6a99312c1e2cad0044ebd_42.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_43.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_44.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_45.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_46.png)

标记啊一下这个短期和长期均的位置关系。其实说白了就是呃你给我指定个标志位有position表示的是这个短期均线是大于长期均线，还是一个小于那个长期均线。然后做这个之前，咱就把确失值去掉。

刚才是给大家看了，数据当中啊，我们的确失值还是挺多的。我不用就是要不然你写这个东西，然后等号等一个data，要不然在这块写上就是一个呃upplace等一个处相当于啊在原始数据当中执行这样一次修改的操作。

好了，去掉一个确失值。

![](img/7cccf2f879f6a99312c1e2cad0044ebd_48.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_49.png)

然后呢，在代当中，我们的问题啊，不是说你指定一个标志位嘛，然后通过这个标志位表示的是当前啊我们的一个位置，它是就是短期的是大于长期的，还是小于长期的。

安排点ve一下位置当中你去指定一下当前在我的这个代当中算一下吧。呃，我们的一个短期啊，把这个直接复制过来。



![](img/7cccf2f879f6a99312c1e2cad0044ebd_51.png)

我们这个短期的和长期的之间的关系，短期的是否是大于这个长期的V当中啊有三个参数。第一个参数就是判断第二个参数就是满足条件下返回什么。第三个参数不满足条件下，返回什么，指定一下属可以了。好了。

直验完之后来去点headt一下，看结果。

![](img/7cccf2f879f6a99312c1e2cad0044ebd_53.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_54.png)

点head下，你看这里咱们多了一个标志位吧。好了，我们短期的长期的标志位是不是都有了，标志位为一的代表什么？是不就是我们的一个短期是大于咱的一个长期。你看从数值上也是我们当前的这样一个结果吧。

然后这个图其实也能画出来啊，咱之前说全序列时候，我记得好像说过这个东西对我data，你可以去点pl一下。第二当中呢，然后呃咱之前说的时候，是不是说你得去画什么，得去画第二个轴吧，要不然这个结果啊。

secondary yseconaryY当中啊，然后你去指定一下这个Y轴呃，这两个Y这个Y轴，然后用谁来当做是比较合适的。我这个复制过来positions。啊，这就行了，然后指定图也是稍微大一点。

s等于个10逗号6来看一下吧。这个是不是咱们当前结果，咱之前瑞达画过了。那好了，那我现在咱们要做一个策略了，做什么策略呢？哎呀，你说这个股票啊，如果呃我就什么都不管。

就是从我从我这个最最早一个点买起来了，我就不管了。然后到最后这个18年18年中旬的时候吧，我说我把它卖掉，我看一下之前的1块钱，相相当于现在几块钱啊，这是什么都不管的前提下。

那现在啊你说我们还应该什么都不管吗？😊。

![](img/7cccf2f879f6a99312c1e2cad0044ebd_56.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_57.png)

![](img/7cccf2f879f6a99312c1e2cad0044ebd_58.png)

好像不应该了吧，为什么？因为我们之前是不是又设一种策略了，我可以怎么样？有的时候我可以卖掉，有的时候我可以再买进是吧？好了，那我们来想一想，如果在这个时候，我们能把这件事做出来。

是不是相当于咱能保证什么？始终我是一个盈利的状态啊，比如这时候这样。😊，这个时候到在这个点的时候，比如说现在你有这么100块，就是就假设吧你的总值是100块钱，然后你去给他这出来这时候咱应该怎么样。

你给他卖掉吧。然后呢，这块的时候，如果它变成80块钱，你再买进来。那什么意思？那是不是说这个时候里外跌你还是赚了20呀，是不是这样一件事啊？就是这里这个意思啊，不是说他现在这个往下走了，就是咱是稳赔的。

因为咱刚才设计策略了嘛，我可以怎么样，我可以在这个这里就给它卖掉，然后下一个点我再给买进是不就完事了，咱刚才不是说了嘛？能能计算出来哪个点该买，哪个点再卖。所以说啊就是呃永远都是什么。

按照咱们这个策略来说，相当于开挂式的，你事先能先知啊，按照咱这策来说，就是永远都是盈利的。因为正常情况下，你看什么都不管，这100变80应该是亏20吧。但是呢我们反而怎么样，我们在这点卖了。

咱这也再买进来，我们反而怎么样赚了20吧啊，是这个意思，所以说一会儿啊咱们会一直去赚下去啊，咱们来看一看，就是你什么都不管啊，的时候咱的最终的一个报酬率啊，或者说1块钱能等于现在多少钱。

以及我按照咱之前设计的我们的一个就是买点和卖点，咱都能通过这个双双均线。😊。

![](img/7cccf2f879f6a99312c1e2cad0044ebd_60.png)

算出来吧，然后来看一看我自己设计系头，哎，咱们能够1块钱，最终赚多钱啊这样一件事儿。

![](img/7cccf2f879f6a99312c1e2cad0044ebd_62.png)