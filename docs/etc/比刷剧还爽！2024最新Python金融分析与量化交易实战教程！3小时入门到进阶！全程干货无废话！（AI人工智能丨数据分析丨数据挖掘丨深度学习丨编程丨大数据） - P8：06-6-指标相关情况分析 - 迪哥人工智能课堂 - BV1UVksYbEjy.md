# 比刷剧还爽！2024最新Python金融分析与量化交易实战教程！3小时入门到进阶！全程干货无废话！（AI人工智能丨数据分析丨数据挖掘丨深度学习丨编程丨大数据） - P8：06-6-指标相关情况分析 - 迪哥人工智能课堂 - BV1UVksYbEjy

接下来啊咱们来看一下这个回归分析啊，说白了就是我现在要看一下，变量之间有什么样的一个关系，或者说呢变量当中啊一些走势啊，一些呃，我们刚说的一些增长率之间，有没有什么样的一个相互影响。

或者是相互的一些就是关联吧，啊咱们要做这样一件事，这里呢我给大家说一下，我们这个流程，第一步咱们还是先选择两个指标啊，我们选一个FTS，还有一个VX，一个标普，还有一个恐龙系数呃。

在这里我们第一步还是先把这两列给拿到手，就是我们现在啊有个data之前我们不叫data2吗，还是用这个data2吧，等于data2当中，把这两列的名字我直接拿过来得了啊，这两列是它的一个名字。

然后这个名字哎呀，把这块稍微改一改，中间用逗号，然后名字我得给它引起来啊，这是第一个名字，然后后面这是第二个名字，然后这个名字啊还得多做一件事，它那个原始数据当中啊，它是一个大写的。

咱改一改是一个大写的，然后这个它也是一个大写的。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_1.png)

然后把数据啊打印出来看一看，cf只拿这两个数据来就行了。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_3.png)

因为我们只观察它两个之间的一个关系，其他的我们就不用去看了。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_5.png)

好了，在这里我们就做完了，就是第一步先把数据给读过来，然后数据读完之后，然后这个索引目目前也都是没问题的，咱直接来往下去做第一步啊。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_7.png)

你说我要去展示它们之间的一个关系，做这个关系啊，其实还挺简单的吧，最简单方法是什么，直接啊，在图当中我们把这个结果给它画出来，是不是就完事了好了，咱们来画图啊，在这个电脑当中，我们来看一下data里边。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_9.png)

然后去plot at一下pro当中啊，我去把当前两个结果传进去，是不就行了，直接点float一下，然后呃其实什么都不用写了。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_11.png)

直接一画，这个结果是不是出来了，但是这个结果出来之后啊，有一个小问题。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_13.png)

如果说你现在你说给它放到一个图当中，好像看不出来一个趋势吧，所以这块咱们还是得把这个东西啊，给它sop close一下啊，SOFLOW当中放到我们两个图当中。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_15.png)

咱们来指定一下，然后呢我们执行一下吧，这样当前结果我们就给它画出来了吧。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_17.png)

行了，这是我们第一步，先把这个图哎我们已经给他画出来了，然后呢换完图之后，其实我们可以观察一下，那此时啊我们想看他这个指标好像挺难的，我一正常情况下，我们不是看这个关系，应该放到一个图当中吧。

但是一个图我又给它描述不出来，那怎么办呢，之前咱们是不是给大家说一种方法可以干什么，在一张图当中我可以诶既有一个左边的Y轴，我还可以再有右边的一个Y轴吧，这样我可以把它俩放到一个坐标系当中。

而且不是一个坐标系，就放在一张图当中，但是呢他们结果哎会就是怎么说呢，给大家来画一下吧，画一下应该会更清晰一点，这样我们把这个数据啊重新来去指定一下呃。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_19.png)

还是我们data这个数据，然后我把这个多写个参数。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_21.png)

不光啊，这回咱就不用这个sop close，然后直接指定我的一个呃坐标轴，咱们之前不是说了吗，在这里我可以去构建两个坐标轴，第二个我指定一个Y，然后呢在这个Y当中啊，咱们来去写吧。

咱们的Y指定成它的一个列的名字。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_23.png)

列的名字我就拿第二个吧，我看第二是谁啊，直接给他复制过来得了，指定好我的一个列的名字。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_25.png)

然后呢我再执行一下，再来看结果啊，这个结果你是不是大概能看出一点趋势了哦。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_27.png)

这个结果可能看着趋势不是特别明显是吧。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_29.png)

再这样吧，咱为了使得这个结果太明显一些诶，再画一画这个数据当中啊，你看他是从这个10年到18年，如果把8年数据化在一起，那这个东西里边的点太多了，是不是变化太多了，咱把它稍微选一选吧。

只选择其中的一部分数据可以吧，比如说我只选择这么一年，或者只选择这么两年的一个数据，他之前不是已经把这个日期当做一个索引了吗。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_31.png)

我把这个数据读过来啊，格式我来复制一下，然后把这个格式复制过来，我们自己来选，比如现在我只想选择这个到这个12年得了。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_33.png)

他是从这个10年开始，然后到这个12年年底吧，12月一个31号，然后呢我们再画一下这个图，看着有点小呃，把这个图稍微画的再大一点，或指定一个fire size啊，指定一个BESIZE等于稍微大一点。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_35.png)

执行一下呃，看这块它出现了一个报错啊，在这里哦，点float一下，点float完之后还给我报错。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_37.png)

再来看一下什么问题啊，他说当前这个label诶。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_39.png)

这个当前这个东西它不是一个label哦，这块这块冒号完之后，它没有一个不是一个逗号，应该是它是一个区间啊。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_41.png)

我们取这样一个数据，刚才不先写个逗号，然后再执行一下行了，这回画出来了，那你看啊，现在我们选了两年的一个数据，我们的一个变化幅度是不是就清晰一点了，来观察一下吧，他们之间有什么结果，当这个SPS指标啊。

我们来看一下，当它变化的时候，如果在在在这个蓝色当中啊，SSPX你看哦，它发生下降的时候，这个vs怎么样上升了吧，你看这里它发生下降的时候，这里出现上升吧，这一块也是蓝色的下降，绿色上升，蓝色的下降。

绿色的上升，我们是不是可以通过画图啊，把这个结果观察出来啊，啊所以说最直接有效的方法。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_43.png)

直接去画画的过程当中啊，其实啊刚才我故意啊就是给大家多画了几步啊。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_45.png)

其实正常我直接把这个一份代码写出来也行，但是呢我给大家说这样一件事。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_47.png)

画图啊从来他都不是一蹴而就的哦，一般我们都先画一个最基本的。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_49.png)

然后看一看有什么问题，有完问题之后，我们在想诶怎么去改进一下。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_51.png)

再改进一下，能使得咱结果看起来更清晰一些吧，啊这是我们的第一种做法，直接去画这样一个图，那还有没有一些其他方法能帮我去做呢，哎刚才咱不是说了吗，我们要干什么，我们可以去画当前的诶一个回归分析吧。

做回归分析之前，我们还得先把数据再处理一下。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_53.png)

或者说呃先别处理数据了，我们先把第二个图再来画一画，其实这里我们不光可以画一个折线图，我们还可以画一个散点图是吧，画散点图的方法其实蛮多的诶，再来带领大家来举个例子，比如这里这样啊，我说现在啊。

我说现在咱指定一个结果。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_55.png)

这个结果呢，咱们之前这个数据当中不有这两列吗，哎记不记得咱之前输过一种方法算什么，我说算那个增加率的时候啊啊增长率的时候，咱们用南派点log的时候，然后用数据去做了一个除法吧，来咱把那个再写一下。

南派点dog一下，然后呢我之前好像说用这个data比上什么，比上一个data点shift是吧，shift当中哎给它，我给他那个往下滑一天是不就得了，然后再把这个结果打印出来。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_57.png)

这是我们当前结果，然后给它点HIIT一下，打印出来啊，这个结果就有了，那有结果之后呢，咱接下来，那你说该怎么样去把它的一个相关性，给它描述出来呢，或者说怎么样通过画图能够说呀。

让我更清晰地去观察到当前的这个结果当中啊，它各自变量的关系以及呢，比如说变量的一个分布关系，以及两两变量之间的关系呢，咱把这个图啊给大家来画一下，其实画的方法非常简单啊。

呃咱用咱就直接用这个pandas as来去做了，其实还有一些其他额外工具包，像saber之类的也能帮咱们去做啊，panda当中，我直接啊去plot at一下哦，只不过说他的API名字稍有变化哦。

PROTE下pro当中啊，我们要去选你要画什么样的图，这是两个数据吧，两两之间我看它的变化情况，不光折线图也可以，我用散点图是不是也行啊，这回咱把这个散点图给大家画出来啊，mattress一下。

在这个散点图当中啊，它里边的一个参数相对来说比较多啊，第一个参数就是哦我们得写一下，你把哪个数据给我传进去是吧。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_59.png)

然后呢第二参数呃，因为散点图啊是这样，如果说你的数据点特别密集，咱这个就属于数据点特别密集。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_61.png)

那肯定很多点可能都会重叠在一起，咱得指定什么啊，一个透明度啊，别让太多的点重叠在一起啊，你指定一个透明度，然后呢接下来一会儿呢当咱们画的图啊，它是一个2×2的图啊，然后呢它会有对角线，在对角线当中啊。

你可以去选啊，你是想画直方图还是想画一个kt plot啊，和密度，估计咱这里先拿这个直方图来给大家呃，描述一下，就是我们的一个在对角线当中，你去自己写一下，你要画什么图啊。

现在大家可能说哎这个对角线是什么不太了解，没关系啊，马上咱就给它画出来，然后呢这个直方图当中啊，哎呀你也得指定它的一个keywords，Key words，就是说哦我们都会涉及到哪些个参数。

然后用字典的格式给传进来，对于直方图来说啊，你就得告诉我咱要做多少个bans，比如说啊做50个BS吧，平均的分成多少个块，分成多少个格，要做一个BS吧，最后咱指定一个feature size。

然后等于稍大的一个图啊就行了，这个就是我们当前啊得到的一个结啊。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_63.png)

还没得到结果，这个就是我们当前把这个图我要去画一下，然后来执行一下好了。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_65.png)

执行完之后来看这个结果吧，刚才咱是不是说对角线了，这是不是对角线啊，对角线当中啊描述的就是呃一个图自己和自己，你看这点这是点SPX吧，这是点SPS吧，所以说中间的这一块是谁啊。

就是LSPS这个指标它的一个直方图，直方图啊，其实呃有两种画法，不是两种画法吧，就是对角线当中啊，大家可能现在看的是一个直方图，哎我知道什么意思，但是其实啊就是当我们画过程当中，还有一种图啊。

是一个就是怎么说。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_67.png)

还有一种图画的更好看一点，给大家来看一看，我直接复制一下，你把这个参数啊稍微改一改。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_69.png)

我改成一个kd float，KDE当中不需要这个参数了，然后再执行一下。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_71.png)

你看这个结果变成什么了，哎变成了一个很平滑的一个曲线吧。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_73.png)

这个叫核密度估计啊，他是怎么做的，呃，大概的做法就是呃，其实他俩的一个趋势是一个类似的，你看当前这个趋势和这个直方图画出来，结果是类似的吧，其实他是这样，就是把你当前这个图啊。

啊这不是分成一个bans吗，那你想如果你能分成1万个BS，或者说分的bans越多，你当前得到的这个曲线就接近于这个曲线，是不是会越光滑呀啊大概就这样一件事。



![](img/9a71041b1d5bd34e88a194f2bf5dff0f_75.png)

所以说啊到时候画图的时候呃。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_77.png)

你愿意画这个KD也行，愿意画这个hist，一个直方图也行啊，通过这个图咱可以去观察啊什么。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_79.png)

其实这两个三角图是类似的，观察谁啊，就是当前我们这两个指标，如果说在散点图当中，它的一个趋势是什么。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_81.png)

肯定是和负相关的吧，咱之前哎在这张图当中，我刚才说给大家看了。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_83.png)

你下降人家增加，你下降人家增加，咱通过这张图是我观察来的。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_85.png)

但是散点图当中是不是会更清晰的，帮我把DNS设给它做出来啊，所以说啊，到时候大家来做分析或者观察的时候啊，至于具体用什么图无所谓啊，选择一个看起来舒服的就行，哎那你说这个图现在舒服吗，好像还差点。

你说还差了点啥呀，哎这个图当中啊，如果说你说你画了一个这个散点图，你再给我画一个回归方程行不行，给我画一个回归方程，往这一看，或者说你把这回归系数告诉我，我是不是一打眼我就能知道哎呀。

这个当前它们之间的关系长什么样子啊。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_87.png)

所以说接下来哎咱们终于说到了。

![](img/9a71041b1d5bd34e88a194f2bf5dff0f_89.png)