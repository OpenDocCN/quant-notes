# 强推！这可能是B站最全的【Python金融量化+业务数据分析】系列课程了，保姆级教程，手把手教你学 - P20：1.DataFrame的级联操作~1 - python数字游侠 - BV1FFDDYCE2g

这两个小节，咱们来看一下在我们的pandas模块当中的，基连跟合并对应的一个操作，OK吧，那么这个七连跟合并它相关的操作，我们讲了之后，我们就会，接下来会迎来咱们的一个纯数据分析的，一个案例。

叫做人口数据的分析，那么在人口数据的分析当中，咱们就会用到我们所谓的基点根合并，和咱们之前所讲解的data frame当中，常规的相关的操作，对其进行一个合并的巩固，OK吧，那么首先在这儿的话。



![](img/d41e59ef32942f2944ce5648ae3fb70a_1.png)

我们先来看一下几点啊，那么看到吉连这个词的话，咱们并不陌生，是不是因为咱们之前在这个nap模块里边，咱们是不是讲过nap数组的几点啊对吧，那么NB数组能继连。

那么我们的二维表格形式的data frame，也可以进行记连，那也就是说再重申一遍，我们所谓的接连，就是使用我们的表格，进行横向或纵向的一个拼接吧对吧，进行横向纵向的拼接。



![](img/d41e59ef32942f2944ce5648ae3fb70a_3.png)

那么在这咱们就基于我们的data frame，进行一个拼接，我们来看一下怎么进行起点，OK吧，首先在这先导一下咱们对应的模块，先导一下nip s n p import。

找一下pandas i s p d，从pandas里边导一下我们的这个data frame。

![](img/d41e59ef32942f2944ce5648ae3fb70a_5.png)

data frame啊，好这导完之后呢，首先我们来看一下这个节点怎么去做。

![](img/d41e59ef32942f2944ce5648ae3fb70a_7.png)

那做极点之前，咱们首先是不是得先有多个这个data frame吧，DF1好，这的话就是等于data frame好，那这的话我就是有一个数据源好，等于一个nap点，random点，random int好。

那这的话我们给它一个五行啊，五行三列吧，五行三列啊，然后的话我们指定下它的一个列索引，columns好，列索引的话就是一个ABC，OK吧，好然后呢还有一个什么呢，Df2，DF2好，DF2的话。

那这块的话我们就等于一个ADCOK吧，那现在的话我们这儿呢有两个这个data frame好。

![](img/d41e59ef32942f2944ce5648ae3fb70a_9.png)

那给它生成之后呢，我们在这呢给它进行一个这个节点所对应的，一个操作啊。

![](img/d41e59ef32942f2944ce5648ae3fb70a_11.png)

啊这，写一下啊，这是不是又错了，0~100size是五行三列对吧，好了，那么接下来的话我们来看一下。

![](img/d41e59ef32942f2944ce5648ae3fb70a_13.png)

这个是DF1对吧，ABC一共有五行三列，然后的话这个是DF2是吧。

![](img/d41e59ef32942f2944ce5648ae3fb70a_15.png)

还是有五行三列吧，只不过他们的列索引不一样，是不是好，那么接下来咱们给它进行一个提炼好，那怎么提炼呢，这会就是我们的PD点点什么呢，CONCAT通过CONCAT给它进行一个节点。

看一下它的参数有哪些参数，1objects就是说我们要接连的哪些data frame吧，是不是DF1和DF2啊，对吧好，那这块的话我们的xx是什么，X就是说我们基点的时候是横向节点呢，还是纵向节点呢。

对不对，我们先让它进行一个横向节点，可以吧，横向节点是不是一呀，对不对，看一下，那么这两个表格进行横向机一连的话，就是说让他们行行拼一起吧，有吧对吧，那现在行工行拼几是完全没有问题的吧对吧，没有问题啊。

好那这块我换一下啊，让它纵向节点，纵向节点。

![](img/d41e59ef32942f2944ce5648ae3fb70a_17.png)

那你猜一下纵向节点会不会生成什么问题呢，造看一下，那这块的话就会变成了什么ABCD了吧。

![](img/d41e59ef32942f2944ce5648ae3fb70a_19.png)

并且这里边有空，看见了吗。

![](img/d41e59ef32942f2944ce5648ae3fb70a_21.png)

这里边有空，那么这个空是什么呢，这个空就是说我们在进行集连的过程当中。

![](img/d41e59ef32942f2944ce5648ae3fb70a_23.png)

它是不是也要进行索引的匹配啊，对不对，你看如果我们的列跟列起集连到一起的话。

![](img/d41e59ef32942f2944ce5648ae3fb70a_25.png)

会发现我们现在DF1，它的列数是ABCDF2是ADC吧，B跟D所以不一样。

![](img/d41e59ef32942f2944ce5648ae3fb70a_27.png)

是匹配不到一起的吧对吧，所以说这种形式的节点，就是我们所谓的不匹配节点。

![](img/d41e59ef32942f2944ce5648ae3fb70a_29.png)

OK吧，它就是我们所谓的不匹配系列，那在不匹配极点的时候哈。

![](img/d41e59ef32942f2944ce5648ae3fb70a_31.png)

我们这儿是不是产生了空啊，对外产生了空，那空有了之后的话。

![](img/d41e59ef32942f2944ce5648ae3fb70a_33.png)

其实我们的空可能是没有意义的，那没有意义，我可以把空给它去掉，那空怎么去掉呢。

![](img/d41e59ef32942f2944ce5648ae3fb70a_35.png)

那这块会用到咱们不匹配机连当中的一个参数，叫什么呢，看一下这块有一个参数叫做joy啊对吧，join默认是alter，alter叫做外链接，外连接指的是保留所有的值，包括NN对吧。



![](img/d41e59ef32942f2944ce5648ae3fb70a_37.png)

那我给它改成inner，是不是内连接，走内连接就会发现我只连接能够连接的像对吧。

![](img/d41e59ef32942f2944ce5648ae3fb70a_39.png)

所以不一致的是不是就不连接了。

![](img/d41e59ef32942f2944ce5648ae3fb70a_41.png)

是不是内连接没有空，而我们的外连接会产生空值啊，只是在不匹配节点当中，是不是啊，在不匹配的节点当中，我们的内连接哈不会产生空值，只将能够匹配的项，能够连接的项进行一个链接吧。

而我们的外链接是不会产生空值啊对吧，那所以说在咱们的这个啊，在咱们的这个基点的过程当中哈，我们可以使用内节点，也可以使用外接点，对不对，但如果你想保证数据的完整性的话，就一定要使用外接点吧。

是外链接对吧，因为外链接它可以保证我们数据的完整性。

![](img/d41e59ef32942f2944ce5648ae3fb70a_43.png)

甭管有没有空，那所有的数据是不是都保留了，你会发现内连接它是不是只连接能够连接的线，那这样的话会造成数据的丢失吧对吧。



![](img/d41e59ef32942f2944ce5648ae3fb70a_45.png)

所以说如果哈写一下，在这啊，你要注意，如果想要保留数据的完整性，必须使用什么呢，使用我们的outer这种方式吧，指的是我们的Y链接或者Y节点，是不是OK吧，这一点你需要注意一下啊。

那这块是我们的contact at对应哪个操作吧，除了能用CONCAT，还可以用append append，append怎么玩呢，DF1dr append这块就可以写成什么呢。



![](img/d41e59ef32942f2944ce5648ae3fb70a_47.png)

DF2走，你是不是也可以啊对吧，你看默认情况下，Dnf 1append df2。

![](img/d41e59ef32942f2944ce5648ae3fb70a_49.png)

是不是只能是列跟列的起点对吧，并且你看这块的话，我们的这个什么呢，这里边有没有我们的这个join的操作啊。



![](img/d41e59ef32942f2944ce5648ae3fb70a_51.png)

是没有啊，那只能进行外节点吧对吧，所以说我们的append啊就是追加呗，只能在末尾追加，是不是只能是列跟列进行一个节点吧，并且默认情况下是我们的一个外接点。



![](img/d41e59ef32942f2944ce5648ae3fb70a_53.png)

不能改成内几点吧，那所以说通过节点的话，我们只需要掌握CONCAT就行。

![](img/d41e59ef32942f2944ce5648ae3fb70a_55.png)

append on知道有它的存在即可，一般不用它。

![](img/d41e59ef32942f2944ce5648ae3fb70a_57.png)

OK那这个就是我们的几点啊，就是我们的基点基点再次说一下，就是将我们的原始数据，进行横向或纵向的一个拼接对吧，那横向或纵向拼接的过程当中，需要保证拼接的这些个表格，他的行列索引得一致吧对吧。

不一致会产生空值的情况发生。

![](img/d41e59ef32942f2944ce5648ae3fb70a_59.png)

是不是啊，那其实还有一种特殊的情况，你比如说哈。

![](img/d41e59ef32942f2944ce5648ae3fb70a_61.png)

比如说那在这的话，我有一个什么呢，DF3吧。

![](img/d41e59ef32942f2944ce5648ae3fb70a_63.png)

比如说我有一个DF3啊，DF3长这个样子。

![](img/d41e59ef32942f2944ce5648ae3fb70a_65.png)

DF3好，它是什么，它是ab没有C了是吧。

![](img/d41e59ef32942f2944ce5648ae3fb70a_67.png)

是五行两列，可以吧，就是DF3，那我们在这能不能让DF3跟DF2，进行一个节点呢，看一下啊，PDD2contact at好，这一块的话是我们的DF1和DF3吧，你要知道DF1和DF3的区别是什么呀。

DF1它是五行三列列，索引是ABCDF2是五行两列，列数是AB吧，是不是好，那这块的话X等于一个一。

![](img/d41e59ef32942f2944ce5648ae3fb70a_69.png)

让它横向积是不行，行换写啊，能积累不能吧，因为你要知道DF1跟DF2，它们的行数跟行的个数是一样的，能够完全的积累，是不是，那如果是零呢，列跟列节点吧，虽然列索引AB是一样的，但是DF3少了一列是C吧。

而DF1是不是多了一列是C啊。

![](img/d41e59ef32942f2944ce5648ae3fb70a_71.png)

看不出现了这样的一种情况，会补空吧是吧。

![](img/d41e59ef32942f2944ce5648ae3fb70a_73.png)

这也是一种典型的不匹配的节点吧，OK吧。

![](img/d41e59ef32942f2944ce5648ae3fb70a_75.png)

所以说这个就是我们所谓基连的一个操作啊，基连完了之后，下边我们要讲合并。

![](img/d41e59ef32942f2944ce5648ae3fb70a_77.png)

那么这个基连跟合并的区别，各位一定要能够知道啊，那我们在讲合并的时候。

![](img/d41e59ef32942f2944ce5648ae3fb70a_79.png)

再给大家说一下合并和基点的区别到底是什么。

![](img/d41e59ef32942f2944ce5648ae3fb70a_81.png)