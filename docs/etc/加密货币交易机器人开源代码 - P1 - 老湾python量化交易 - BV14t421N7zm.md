# 加密货币交易机器人开源代码 - P1 - 老湾python量化交易 - BV14t421N7zm

各位同学大家好，我是Python量化交易的老汪，你们要的交易机器人的Python代码来了，之前呢，因为我自己在交易的代码呢比较复杂一点，大概写了几千行，而且有不同的系统支持。

所以在给同学的代码里面呢啊没办法写这么细，因为这整个系统要搬给同学才能运作的起来，今天呢在COLAB上面呃，帮同学整理了一个最简单的交易代码，每一个步骤阶段呢我都留了重点，同学可以再去细化优化一点。

先看一下我的右手边呢，这个是我的手机，我平常在交易的时候呢是不看盘的，因为这些交易的细节呢，送到我手机上台才就行了。



![](img/5e9290edab5e4b9e3dbdb616bc66550f_1.png)

应该会我们把交易信息呢送到我手机上面的，企业微信，因为企业微信上面的markdown我还挺喜欢的，有不同颜色，还有粗体，整理起来是比较方便一点的，它是直接可以在COLAB上面运行的。



![](img/5e9290edab5e4b9e3dbdb616bc66550f_3.png)

因为在COLAB上面你不能连到bi，因为B安的呃。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_5.png)

他有限制的，只在美国的交易服务器上面，你要去开一个美国的交易账号。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_7.png)

应用的，COLAB呢是谷歌上面的免费的云平台服务器。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_9.png)

就可以白嫖不用钱了，交易代码呢会放在下面的链接，所以你看就可以了。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_11.png)

右手边呢有我们的大纲目录，哪个步骤很简单的，上面只是介绍一下这个代码是怎么运行的，第一个呢是我要安装这个模块，我用到的模块呢是CCXT这个模块，第二个模块呢这个是画图的同学，要装不装都可以的。

看一下这个交易代码，第一块呢是我把一些函数把它先建立起来。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_13.png)

包括了我要先登录那边呢，替换一下你的API key，还有点secret，另外呢这个机器人呢，我们下面会看到我个人习惯使用的是企业微信，要一个web hook，一个链接就可以的，有些人喜欢用电报啊。

电报也是一串的微博户口就行了，只是电报呢他只能打文字，它不能有颜色。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_15.png)

不能有粗体，不能排版，看个人喜欢吧，开始登录交易所。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_17.png)

自己去设定吧，这个都是一样的，今天我的策略呢是布林通道策略。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_19.png)

布林通道我个人比较喜欢一点，不过我的交易真的上线的策略呢。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_21.png)

会用的比较复杂一点，我把它简化了，我们今天就用个固定通道，一开始的默认的布林通道的标准差，是三个标准差，然后是144根的K线，这个是半天六个小时的K线，因为我是用5分钟的K线自己入餐呢，调整一下就行了。

看自己的喜欢偏好啊，是先示范一下，那也同时做个风险提示啊。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_23.png)

这些代码只是让同学理解一下什么是城市交易，自动化交易。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_25.png)

所有的交易都是有风险的，包括了系统的风险，例如说谷歌崩溃了怎么办。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_27.png)

或者是交易所传过来的数据停了，或者你下单的时候，他就给你拔网线怎么办。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_29.png)

都是有风险的，这个都是最简单的策略，没有预料到那些风险，因为实际上上线之后，同学会遇到各种的风险，各种的情况，所以呢城市交易有它的风险，在那只是很简单的示范一下什么叫城市交易，自动化交易量化交易。

那下面呢这几段一大代码，大部分的代码都是在解交易的通知。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_31.png)

微信的机器人，那这个是markdown的一个格式，下面呢才是我们的主代码，从这边开始或联通到策略的代码，这边挑选了16支的加密货币，既然是城市交易呢，啊你做5~10字都是一样的。

因为我们今天是在免费的白嫖PB3同学。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_33.png)

如果你自己在家里呢，你有办法，你也要快一点了，首先看一下我的交易代码，这边呢是持续性的运行，你跑完一圈，18只的加密货币，跑完了，那再跑一圈吧，因为加密货币是24小十的交易啊，他有个优势。

就是你有什么信息呢，在市场上会立刻的反馈出来，不是几分钟之内保反应完毕了，所以在做城市交易是比较方便点，但是呢我这边也提示一下，股票期货在做交易的时候，因为他有收盘，如果你是遇到收盘的时候呢。

你的有效单就取消掉了，但是加密货币如果你没有取消，他单子就在那边了，所以呢，待会我们看到我们的交易流程是有些调整的，因为那是一时的无限制循环，所以我这边做的是合约，因为合约多空都可以做。

如果是在B安的话，总共大概有300支的约边，做个比较简单一点。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_35.png)

示例一下，因为一般的同学在做交易的时候，是有是有先进场再出场。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_37.png)

但是在做城市交易自动化，家有未成交订单都是要检查的，第一个步骤呢啊检查一下你未成交订单。

![](img/5e9290edab5e4b9e3dbdb616bc66550f_39.png)

如果要检查未成交订单是会持续性的下单，会把你的资金全部用掉，所以呢检查未成交订单，另外呢这个循环里面，第二步呢出场策略先做止盈止损，检查我有仓位，那是个连续化持续性单运行的，那这个代码呢。

先帮同学把这个流程的梳理清楚了，我实际上实盘交易的代码也是遵循这个步骤，先去检查未成交订单，再去检查一下我的仓位，最后呢才是开仓啊，所以这个顺序呢我们在交易流程里面呢，要先处理干净，布林通道里面呢。

如果是现价往下穿透了布林通道下轨的时候，这是一个买入群啊，往上穿透了上拐的时候，这是一个卖出去啊，最后一步呢才是处理建仓的，把每一个步骤一起送到我的手机上面来，包括开始运行或者是我建仓的时候。

都会送到我的手机上来啊，我们来运行一下看看，如果是要在自己的电脑上面跑呢，这个代码呢可以把它写成一个Python的脚本，我们因为我们在JP的上面呢，我是把它分成不同的模块去运行的，右手边的。

这是我的企业微信上面呢是我们的下单，是我们的交易所付，如果待会开始运行的时候呢，已经有下单的话，那边就可以看到被成交订单了，运行一下。



![](img/5e9290edab5e4b9e3dbdb616bc66550f_41.png)

开始的时候会看到哦，我现在有多少现金，那12345678嗯，这个是编号，我就知道我现在跑了几圈，如果遇到了交易信号，我这边可以看到这是有交易信号，Signal，如果出现一或者是一的时候。

就会下单送到我们的手机上，因为我现在的布林通道呢设的比较宽一点，所以没有触及到我们的交易信号，他的布林通道弄得窄一点。



![](img/5e9290edab5e4b9e3dbdb616bc66550f_43.png)

看会不会触发到我们的交易信号，而是设两个标准差，我这边把它设定成1。5版，通常如果波动比较大一点的时候呢，就会触发到两个标准上或者是三个标准。



![](img/5e9290edab5e4b9e3dbdb616bc66550f_45.png)

咱们先把它调整成1。5个标准，它看会不会触碰到好的，那我们来重新运行一下，看看会触发到我们的企业微信，这边就已经触发到喽，这边就已经有一张的多单哦。



![](img/5e9290edab5e4b9e3dbdb616bc66550f_47.png)

F叉USDT这边就已经送到我们的手机上面，看一下上面的交易所呢，他刚刚已经下单了，有看到的未成交订单，F x u s d t，以下企业为新价格是4。7381，下单的数量是5。2。

看一下企业微信上面刚刚送过来的信息，交易下单是一样的，不管你是电报或者是企业微信，都是很推荐送到自己的手机上，另外我再补充一下，因为我们现在已经下单了，整个交易流程需要先检查未成交订单。

再去检查是不是有仓位，最后呢还是建仓，我这边做个示范，我这边做啊，这个现在是cake，哈哈蛋糕，这个是蛋糕加密货币啊，这个名字那都有很有趣的，那我们先来示范一下，如果说我把这个单子取消掉的话。



![](img/5e9290edab5e4b9e3dbdb616bc66550f_49.png)

他会不会重，再下一次单，他会去检查我现在是不是已经下单了，另外把这个单子呢取消掉，他就会另外再下一次单了，因为他会去检查是不是我已经有未成交订单，先把所有的订单先把它取消掉，Can l all。

再来看一下哈，我现在把它取消掉取消，然后就可以看到他，待会他会重复再下一次单，把这个单子呢送到我的手机上面来，现在呢又说下了，另外一张单，因为我刚刚已经有下了资金的限制。

所以呢他都会去检查我的资金够不够，或者是已经有没有下过单了，这次我们做城市交易的时候，都是要流程再梳理一遍，你哪个步骤要先走，哪个步骤要后走，免得重复下单或者是止盈止损没有做好。

这个是我们在做城市交易的时候呢，跟我们一般主观交易最大不同，就城市交易自动化交易呢，这个步骤是要梳理清楚的。



![](img/5e9290edab5e4b9e3dbdb616bc66550f_51.png)

那今天的分享先到这边了，记得关注点赞。