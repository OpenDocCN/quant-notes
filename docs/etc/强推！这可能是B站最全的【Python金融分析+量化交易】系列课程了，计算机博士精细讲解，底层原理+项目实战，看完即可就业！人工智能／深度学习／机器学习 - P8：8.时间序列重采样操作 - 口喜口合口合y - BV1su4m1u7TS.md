# 强推！这可能是B站最全的【Python金融分析+量化交易】系列课程了，计算机博士精细讲解，底层原理+项目实战，看完即可就业！人工智能／深度学习／机器学习 - P8：8.时间序列重采样操作 - 口喜口合口合y - BV1su4m1u7TS

接下来咱们再来看这个重采样，还有时间窗口操作主咋样，咱们之前说过了，就是正常数据啊，它是按照以天为单位的，或者是以其他为单位的，现在呢我们想把这个单位啊做一个调整，比如说之前你是按天统计的。

等会先我换一个吧，我说我换到这个呃，以周为统计的，以年为统计的，以月为统计的，是不是也可以啊，直接啊对咱们这个data做什么的一个RESIMPLE操作，RESIMPLE完之后。

咱们就相当于得到了这个重采样的结果，重采样的过程当中，你需要给我指定啊，最少一个参数就是你告诉我以什么为单位是吧，那好了，以周为单位，一周为单位，两周为单位是不是都行啊，以周为单位的时候。

那你说显示的时候，你是显示个均值呢，还是第一个值，还是中位数呢，还是什么指标呢，自己来指定什么指标都行，指定指标之后。



![](img/fa418296736ce785cb8820ed5fd73cea_1.png)

然后来指定一个head，然后再看一下结果，你看这里哎呀。

![](img/fa418296736ce785cb8820ed5fd73cea_3.png)

你看这块儿他是直接1月10号了，咱看一下为什么是1月10号，因为原始数据当中唉这一块前面都没有吧，所以说啊我做了一个重载页，相当于一周一周是这样一个窗口，我看看一二呃，呃大大大概是这样一个窗口吧。

把这个窗口做完之后，咱得到了当前的一个结果啊，这是我们现在做了一个以周为重，采样之后得到的一份结果，那其实就是不光是一周七天七天往上涨。



![](img/fa418296736ce785cb8820ed5fd73cea_5.png)

那其实我们不光能一周的，那还可以什么再换一下吧，比如说哎我现在不以这个周，然后以这个月吧。

![](img/fa418296736ce785cb8820ed5fd73cea_7.png)

一个月行吧，是不是也能得到一个结果啊，但是这里啊大家需要注意一点啊。

![](img/fa418296736ce785cb8820ed5fd73cea_9.png)

你看这块我第二点说了，咱可以用什么不同的一个标签。

![](img/fa418296736ce785cb8820ed5fd73cea_11.png)

什么叫不同的一个标签呢，给大家来看一看，就拿第二事来说吧，这里我们还可以再加进来一个参数啊，比如说这里我这块写的是啊这么一个月是吧，然后呢我在这个label当中，微博里边，我说我给它加上一些变化吧。

加上什么，你可以把这个标签放到一个左边，或者说我给它放到一个右边，什么叫这个左边，还有这个右边，咱们来看一下这个level当中，你看啊就是如果说我指定一个left吧。



![](img/fa418296736ce785cb8820ed5fd73cea_13.png)

刚才默认是一个right，指定left，再来看一看，你看这个结果什么，原来第一个数据啊是这个1月31号，但是现在这个数据是12月31号哎，看起来数值不是那个统计怎么多统计一个月啊，这里也是1月31号啊。

但是你看数值，你看这里1月31号这个数值，和这里这个12月31号这个数值诶，大家来对比一下，你说是不是一模一样啊，是不是一模一样的东西啊，那他们之间什么意思呢，他说这样一件事就是现在啊。

你虽然说这是一个月数据统计完之后，你要以哪一天为命名吧，left就是第一天，RT就是最后一天啊，用哪一天来当做当前这个数据它的一个命名，或者当做它的索引名字吧，或者叫做一个日期名字。

这里就根据你不同任务来去选了，那比如说现在你觉着用前面的合适，那你就自己指定一个left，你觉得right合适，你就指定这个right是不可以啦。



![](img/fa418296736ce785cb8820ed5fd73cea_15.png)

不要忘记啊，这块还有一个指标叫做啊一个不同的标签。

![](img/fa418296736ce785cb8820ed5fd73cea_17.png)

一般就是left和right，你自己选，看一看什么值合适，我估计大部分情况下还都是一个right的吧，因为就是你看哦，你当你指定成一个以左边的时候，那数据当中都没有31号，你还出现一个31号。

这是我不太靠谱的这样一个意思啊，那下面这个值呢，下面这个值1月31号，它其实描述的什么描述，是从它开始2月份的一个情况吧，所以说啊你最好指定成一个就是right的形式。



![](img/fa418296736ce785cb8820ed5fd73cea_19.png)

是符合呀咱们观察的一个逻辑啊，当然可能不同任务啊。

![](img/fa418296736ce785cb8820ed5fd73cea_21.png)

大家做法的需求可能不太一样，这个就是一个时间序列的中采样啊。

![](img/fa418296736ce785cb8820ed5fd73cea_23.png)

也是比较简单的，直接就可以把这个数据啊，按照你想要的结果做很多重采样的方法好。

![](img/fa418296736ce785cb8820ed5fd73cea_25.png)

接下来接下来就是我现在啊，不光要做这个重采样啊，不是不是做这个重采样，我要做一个窗口，什么叫做窗口呢，我是这样，现在我说我这是有一批数据行吧，好了，在我这批数据当中啊，这样我说现在我这个数据当中啊。

呃我要做很多序列出来，那这个序列可能不是不是一天，那什么意思呢，这里还有100天数据行吧，好了，我说我去截，我说我截的第一个窗口是这样，我说我截了这十天可能会有点大了，我说这是十天数据行吧。

接完这十天之后呢，我说下我再截十天，我说这个是一个一号数据啊，是这十天的，然后呢我说我再截个2号数据，二数据它可能是从第二天到第11天的，可以吧，然后呢我说我再结合3号数据。

三数据呢可能是这个不光到这个11天，到这个三第三天到这个第12天可以吧，我可以啊，十天时间去结每一个十天呢，往后就是滑动窗口似的移了一个单位，可以吧，这东西你叫做滑动窗口或者叫时间窗口都行啊。

我们要做这样一件事，行了，咋做呀，这个东西给大家看一下吧，咱们现在怎么样去做这件事啊，首先第一步还是把我们的数据拿过来，然后呢你可以指定啊这样的一个window，就是我们的一个窗口。

比如说咱们这个窗口是等于十的，可以吧，然后呢接下来对我的数据啊，执行这个操作吧，窗口是10data当中说的数据。



![](img/fa418296736ce785cb8820ed5fd73cea_27.png)

那数据当中选一列吧，就选这一列得了。

![](img/fa418296736ce785cb8820ed5fd73cea_29.png)

数据当中咱选择某一列指标，然后呢对这个鼠标怎么样，我做一个rolling的操作，就该说的诶，你要做好多窗口做滑动了，然后呢这里边有有个参数，就是一个windo windows当中啊。

你自己指定的window等于多少啊，这块我自己指定了，就等于我这个window得了，这个window等于我单位window可以吧，然后呢统计完之后。



![](img/fa418296736ce785cb8820ed5fd73cea_31.png)

你看统计完之后啊，他现在这个结果展示的不是特别舒服，因为现在它是好多个序列，咱可能展示的不是特别好看，这样吧我给这个序列，我算每个序列当中它的一个最小值可以吧，相当于我第一个窗口最小值。

第二个窗口最小值，第三个窗口当中最小值可以吧。

![](img/fa418296736ce785cb8820ed5fd73cea_33.png)

这就能展示出来了，做一下啊，前几个前几个都是NAN值啊，因为这里边它是我们得有有十个，才能做当前这样的一个展示吧，好了，这里边就是我当前画出来的一份结果，而这个结果不太好，这个结果比较闹心。

因为数据当中啊，但凡一个窗口当中存在这个AN值呃。

![](img/fa418296736ce785cb8820ed5fd73cea_35.png)

这这些很多东西都展示不出来，这样咱先得先对我数据做预处理吧，这块大家到时候做着做出下一步吧，得先对我数据做预处理，你得先把这个缺失值诶给它剔除掉，要不然不行，在这里D3D把这个data重新的构建一下。

我说我的data等于我当前的这个frame当中，去drop一下啊，drop一个A就是我去做一个确实值吧，然后我写了data2吧，data2等于data点召唤A。

然后呢我把这个东西都拿做data2来去做行了。

![](img/fa418296736ce785cb8820ed5fd73cea_37.png)

这回咱就有了，你看这回咱下面的都不是空值了吧。

![](img/fa418296736ce785cb8820ed5fd73cea_39.png)

因为上面上面就是空值，正常的，因为窗口还没到那个长度，是不是。

![](img/fa418296736ce785cb8820ed5fd73cea_41.png)

然后下面你看之前咱算有AN值，现在怎么样就都没有了吧，这样我就得到了哎这是一模。

![](img/fa418296736ce785cb8820ed5fd73cea_43.png)

这都第几个我的部署了，这是第多少个窗口，然后它的一个最小值D多少窗口，它的一个最小值，咱是不是能把所有的结果全部都给他算出来啊。



![](img/fa418296736ce785cb8820ed5fd73cea_45.png)

啊这块咱把这个结果得到手了，那如果说呢你想对好多窗口啊。

![](img/fa418296736ce785cb8820ed5fd73cea_47.png)

都执行这样一些统计的操作，该怎么办呢，咱可以把这个序列啊都可以加一加哦。

![](img/fa418296736ce785cb8820ed5fd73cea_49.png)

来这边写一写，我说现在啊这个呃重新的构建一个data吧，我说这个data当中我加上一些列，data2当中加上一些列，加上一些什么列呢，我说这是一个最小值是吧，这是最小值等于最小值。



![](img/fa418296736ce785cb8820ed5fd73cea_51.png)

然后呢可以再讲啊，这块不光有最小值，我还可以统计它的一个最大值，然后这就是一个最大值，然后再写几个吧，再写一个均值和一个st得了命值，然后这块一个STD这块也是点名一下，然后这里是点STD一下就行了。

然后指定完之后。

![](img/fa418296736ce785cb8820ed5fd73cea_53.png)

我把这个额数据还是给大家打印来看一下，点hit一下行了。

![](img/fa418296736ce785cb8820ed5fd73cea_55.png)

看后面几个指标吧，这块怎么样，是不是哎呦，这个点还不行。

![](img/fa418296736ce785cb8820ed5fd73cea_57.png)

你这么的吧，你点tag一下吧，点tag当中是不是这个结果咱就给他算出来了啊，这块就是咱当前的一份结果，不光我们把这个呃前面节指标写出来了，还有什么基于当前这个窗口当中最小值，最大值。

还有它就是符合它的序列，符合他这个窗口当中所有的一些统计值，咱是不是全部给它画出来了，基于窗口来去画的，相当于啊是以这样一个范围来去统计，当前的我的一些结果啊，这就是我们的一个时间窗口。



![](img/fa418296736ce785cb8820ed5fd73cea_59.png)

或者是时间序列怎么去做，以及呢，我们可以对这个时间序列执行的一些操作。

![](img/fa418296736ce785cb8820ed5fd73cea_61.png)

不要忘记点啊，就是你对这些窗口在做操作的时候啊。

![](img/fa418296736ce785cb8820ed5fd73cea_63.png)

先做一个预处理，你得把这些缺失值给去掉。

![](img/fa418296736ce785cb8820ed5fd73cea_65.png)

因为刚才给大家演示的时候，我刚刚就忘了，如果你没去掉这个缺失值，它这块怎么样会出现好多N吧。

![](img/fa418296736ce785cb8820ed5fd73cea_67.png)

所以说第一步啊，咱得先把这个数据做好预处理，这可能是很多数据分析任务当中。

![](img/fa418296736ce785cb8820ed5fd73cea_69.png)