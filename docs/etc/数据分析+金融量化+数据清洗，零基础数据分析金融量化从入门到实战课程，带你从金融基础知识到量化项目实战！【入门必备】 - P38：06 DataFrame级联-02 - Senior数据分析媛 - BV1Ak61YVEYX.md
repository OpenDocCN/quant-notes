# 数据分析+金融量化+数据清洗，零基础数据分析金融量化从入门到实战课程，带你从金融基础知识到量化项目实战！【入门必备】 - P38：06 DataFrame级联-02 - Senior数据分析媛 - BV1Ak61YVEYX

到这儿能看懂的话。

![](img/201aede0fc92d1f99ffb27bb2f301da2_1.png)

我们再做一个变化啊，再做一个变化，那在这个位置啊，在这个位置这个I和K啊，我们给它结合到一块，因为这个值这个值我们它它先说这个字典啊，对吧，那这个值我们是得给它变成那个A0，A1A2那类的东西啊。

对不对，所以这个地方我们再给他改一下啊，我把这个复制一下，再做一步处理这个I啊，这个I然后我给它变成一个字符串，这个I和K都是已知的这块是吧，这块我们写个字符串啊，这是一个值，然后加上另一个值。

然后点for mate，我把这个I和K都写进来，这可以吧是吧。

![](img/201aede0fc92d1f99ffb27bb2f301da2_3.png)

因为在这个位置I和K都是已知的，在放放之前是吧，是不是A0B0C零了啊，那JS是个字典，那有了字典的话，我是不是可以很快的生成一个data frame啊，data frame字典里边的话建就成了列标签。

是不是建成列标签，那这边我们只需要再补一个行标签就行了，data等于这个，然后那个行标签index就是list是ABC，是不是啊，这就是成了啊，那我们把它封装成函数，Define create。

来个大写DF啊，一个index，一个columns，那这里边我们得替换一些值，这个值肯定是要返回的，这里边谁是谁是行标签啊，是不是这个index啊，应该填这啊，index填这，然后呢，哎不对啊对啊。

这是index是吧，index然后后边这个是不是columns啊，Columns，然后呢后边这个index呢我们再重新设定一次，index行了对吧好。



![](img/201aede0fc92d1f99ffb27bb2f301da2_5.png)

我们来验证一下啊，Create df，我们来一个ABCDE，然后，comments我给一个12345。



![](img/201aede0fc92d1f99ffb27bb2f301da2_7.png)

![](img/201aede0fc92d1f99ffb27bb2f301da2_8.png)

好吧好吧。

![](img/201aede0fc92d1f99ffb27bb2f301da2_10.png)

好了，咱们休息会吧，你猜为什么这个这个障碍参数，它的主要的作用是我们在几点的时候。

![](img/201aede0fc92d1f99ffb27bb2f301da2_12.png)

因为它它会这个保留我们的。

![](img/201aede0fc92d1f99ffb27bb2f301da2_14.png)

就是吉连方向的那个标签对吧，比如我们纵向的吉连的话，我们先创建两个表吧。

![](img/201aede0fc92d1f99ffb27bb2f301da2_16.png)

DF1等于create df，我们先来一个list，这个AABCD，然后再来一个list，这个123。



![](img/201aede0fc92d1f99ffb27bb2f301da2_18.png)

然后再来个DF2，等于create df list这个BCDE，哦哦我可。

![](img/201aede0fc92d1f99ffb27bb2f301da2_20.png)

234啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_22.png)

那么他们俩他们两者之间如果去做几点的话，pd点先输出一下啊，display一下DF1DF2。

![](img/201aede0fc92d1f99ffb27bb2f301da2_24.png)

他们俩如果我做纵向起点的话，那大家会想会怎么怎么连啊，是不是这个第二张表，这个因为它没有一这一列，所以它会填充一列空值对吧。



![](img/201aede0fc92d1f99ffb27bb2f301da2_26.png)

然后第一张表因为它没有四这一列，它也会填充空值，所以他们两个如果直接连的话，contact at额括号DF1DF2。



![](img/201aede0fc92d1f99ffb27bb2f301da2_28.png)

会把这个一和四这两列都补上，补上进来对吧，那比如有的时候我们不希望要，就是我不想要这个四和一有空值的这列的话，怎么办呢，这时候我们就可以用这个join参数啊，照样参数它这个里边呢主要就是两个方式啊。



![](img/201aede0fc92d1f99ffb27bb2f301da2_30.png)

一个是inner。

![](img/201aede0fc92d1f99ffb27bb2f301da2_32.png)

一个叫outer，那inner呢叫内集联，outer叫外级联，区别在于什么呢，inner呢我只取我吉连方向这个这个标签的交集，交集，那比如说我现在这个DF1和DF2，我节点的方向是什么，是不是列方向啊。

就纵向啊，对不对，纵向的话，那我不得取列标签啊是吧，那列标签他们列标签的交集是什么，第一个是123，第二个是234，所以它的交集数不就是二和三啊对吧，所以那这块我们如果设定为inner的话。

就只剩二和三这两列了啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_34.png)

那同样的，如果我现在是横着连contact at df1DF二五。

![](img/201aede0fc92d1f99ffb27bb2f301da2_36.png)

现在是横着连对吧，横着连的这这个标签的交集是什么呀，第一个是ABCD，第二个是BCDE对吧，那交集是不是BCD啊，那我这块把它这个join设置为inner。



![](img/201aede0fc92d1f99ffb27bb2f301da2_38.png)

就只剩下ECD了。

![](img/201aede0fc92d1f99ffb27bb2f301da2_40.png)

是吧啊，那如果你改成alter呢，就是全留下啊，所以默认是什么，默认就是这个alter啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_42.png)

这是JO的作用。

![](img/201aede0fc92d1f99ffb27bb2f301da2_44.png)

那另外呢还有什么呢，还有这个。

![](img/201aede0fc92d1f99ffb27bb2f301da2_46.png)

叫join axis，那我们通过这个john这个函这个参数来控制呢。

![](img/201aede0fc92d1f99ffb27bb2f301da2_48.png)

只能取交集或并集，不方便定制，比如说我现在想去呃。

![](img/201aede0fc92d1f99ffb27bb2f301da2_50.png)

DF1和DF2，我想横着连吧，现在我想横着连，我想取ABC，我想取ABC，我不管你有没有，我今天就要ABC这三列，那我就要定制对吧，定制的话呢，这时候我们就要用join axis来指定这个轴啊。



![](img/201aede0fc92d1f99ffb27bb2f301da2_52.png)

指定轴，但这个轴呢它写法比较特殊，这个咱们得特殊记啊，嗯比如说我可能我们的理解的话，那如果我要取轴的话，我就直接写个DF1，然后一个DF2。



![](img/201aede0fc92d1f99ffb27bb2f301da2_54.png)

我把这个方向改成一，现在呢我想取ABC的话，那我这个john axis，我就等于一个A再来个B。

![](img/201aede0fc92d1f99ffb27bb2f301da2_56.png)

再来个C就行了对吧，但实际上呢这种情况他是不认的。

![](img/201aede0fc92d1f99ffb27bb2f301da2_58.png)

比如说你不能用这种方式来给定，它的一个节点的值，这个值得怎么给呢啊，我们先做一个简单的一个处理啊，比如我可以这样啊，这个DF一点这个这个index，然后这我们加一个中括号看啊。



![](img/201aede0fc92d1f99ffb27bb2f301da2_60.png)

这样的话我取的是谁啊，我说取的这个轴我指定的是DF1的索引啊，就是我以DF1的索引为基准，我们来取值，那我这个DF2的那个E就没了是吧，那我们通过这个方式可以看到一个格式啊，这个格式是什么呢。

它必须是一个列表，而且列表里面放的这个数据类型是啥类型呢。

![](img/201aede0fc92d1f99ffb27bb2f301da2_62.png)

我们可以把它做一个输出啊，我想看它的类型是不是加个问号就行了。

![](img/201aede0fc92d1f99ffb27bb2f301da2_64.png)

是不是还记得吧啊假如说我看他的类型，这个类型什么类型，它是不就是个index类型啊，是个index类型啊，这个类型我们怎么去构造呢。



![](img/201aede0fc92d1f99ffb27bb2f301da2_66.png)

看看啊，有example，pd点index，123，我就构造出来了一个类型或者pd点index，list a abc我就挂用出一个index类型，是不是啊，所以如果我想去取BCD的话。

那我这块呢可以先把这个index构造出来啊，这个index等于这个pd点index，我要取的谁是BCD对吧，B。



![](img/201aede0fc92d1f99ffb27bb2f301da2_68.png)

然后我再把这个index放到这个数组当中，我这样取就取到了BCD啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_70.png)

所以这地方你要是没有中括号还不行是吧，所以他这个地方啊就是我们得特殊记一下，就特别奇怪啊，因为本身其实index已经是一个列表了对吧，而且它得是列表中的列表啊。



![](img/201aede0fc92d1f99ffb27bb2f301da2_72.png)

在地上这么取就可以了啊，可以用它来做定制。

![](img/201aede0fc92d1f99ffb27bb2f301da2_74.png)

把这个jn access我们放在这啊，用于定制要保留的这个标签，当然了，这个标签一定是跟你这个吉连的方向的标签，要匹配啊，不匹配的话，那就没有意义了啊。



![](img/201aede0fc92d1f99ffb27bb2f301da2_76.png)

就全控制好，除了这个之外，还有个参数参数看看啊，嗯还有个叫ignore index。

![](img/201aede0fc92d1f99ffb27bb2f301da2_78.png)

那它有什么用呢。

![](img/201aede0fc92d1f99ffb27bb2f301da2_80.png)

看看啊，我们先做一个简单的几点pd点。

![](img/201aede0fc92d1f99ffb27bb2f301da2_82.png)

Contact at df1，然后DF2，那这个默认是纵向节点对吧，纵向节点我发现有什么问题呢，我发现行索引啊，ABCDBCDE是不是重复了，他如果一旦重复的话。



![](img/201aede0fc92d1f99ffb27bb2f301da2_84.png)

那我这个data frame，你说我要读B的话，我把谁读出来了啊，我点lock b把两个都读出来了，看到了吧啊俩都读出来了啊，所以这种情况是不合适的啊，不合适的，所以这种情况呢我们其实有两个办法解决。

第一个办法就是用ignore index，那我现在可以这样来干啊，Contact at，然后DF1DF2，然后这块ignore a not，啥意思啊，是不是忽略的意思啊，对不对。

忽略我把它设置为true，就是什么呢，我们忽略索引，这个所谓的忽略索引是忽略原始索引。

![](img/201aede0fc92d1f99ffb27bb2f301da2_86.png)

忽略原始索引，那它所谓的这个原始索引指的是谁呢，指的是你没有参与集点的那个方向的索引，比如我们现在是纵向连，那我们是以列标签为基准来连接对吧，那么行标签就被我们忽略了，如果我们是横着连。

那么列标签就被我们忽略了，明白吧，忽略忽略了，忽略之后呢，它就会进行重新排列，它是什么呢，它是以以演示，索引的方式对这个原始索引进行重新排列啊。



![](img/201aede0fc92d1f99ffb27bb2f301da2_88.png)

所以我们这样一写，它设置为true的话，就变成01234567了。

![](img/201aede0fc92d1f99ffb27bb2f301da2_90.png)

那么它的索引就是整数了啊，本来是字符串啊，本来那个BCD是字符串。

![](img/201aede0fc92d1f99ffb27bb2f301da2_92.png)

是不是啊，现在都变成01234567这整数了啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_94.png)

我们可以证明一下啊，DF是吧。

![](img/201aede0fc92d1f99ffb27bb2f301da2_96.png)

现在我想读他的零点lock0，是不是啊，如果字符串的话，是不是得加双引号啊，这样是不认呢，那现在你谁是字符串列标签是不是字符串，1234是不是字符串，我想读那个1Z1列是不是读不出来啊，因为它是字符串。

这样才能读出来对吧，你看我这是怎么构造的呀。

![](img/201aede0fc92d1f99ffb27bb2f301da2_98.png)

我这个列标签怎么来的呀，是通过函数构造的嗯，是通过这个函数构造的。

![](img/201aede0fc92d1f99ffb27bb2f301da2_100.png)

是不是这个函数怎么实现的。

![](img/201aede0fc92d1f99ffb27bb2f301da2_102.png)

函数的行索引和列索引数，不都是来自于你的一个列表啊，是不是一个列表啊，列表你一猜出来，每一个字符是不是就是个字符串啊对吧。



![](img/201aede0fc92d1f99ffb27bb2f301da2_104.png)

所以它是个字符串啊，列标签是字符串，而行标签是什么，是我们ignore index是重排的，这个重排是什么隐式索引，所以它是整数。



![](img/201aede0fc92d1f99ffb27bb2f301da2_106.png)

知道吧。

![](img/201aede0fc92d1f99ffb27bb2f301da2_108.png)

这个没听明白吗，那我重新来一下啊，比如我我这样啊，我这样构造一个data frame啊啊，Data frame，data等于NP点，random点，Randoint，00~10。

然后size等于三行三列啊，然后我这个columns我让它等于一个list，0123啊，01202好了。



![](img/201aede0fc92d1f99ffb27bb2f301da2_110.png)

现在我这个data frame嘛，你先表面看它是数字，它也是数字，但是这两两边的类型是不一样的，列标签是什么，是不是字符串啊，所以说你要想读读取列的话。



![](img/201aede0fc92d1f99ffb27bb2f301da2_112.png)

读取列我们是直接用中括号就行了，我写个零能读出来吗，是不是读不出来，因为我的列标签是字符串对吧。

![](img/201aede0fc92d1f99ffb27bb2f301da2_114.png)

是字符串，那我想读行的话。

![](img/201aede0fc92d1f99ffb27bb2f301da2_116.png)

DF点lock0能不能读出来，能读出来，因为它是什么，因为它是整数，反而你变成字符串是就读不出来了，那我对于列标签，我给它变成字符串就能读出来了。



![](img/201aede0fc92d1f99ffb27bb2f301da2_118.png)

是不是啊啊，所以就是我们你不要光被表表象所迷惑啊，就是它是数字，它不一定就是数字类型，明白吧。

![](img/201aede0fc92d1f99ffb27bb2f301da2_120.png)

也可能是字符串类型啊，那我们想强调的是什么呢，ignore index它是以整数来进行填充的。

![](img/201aede0fc92d1f99ffb27bb2f301da2_122.png)

而不是字符串啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_124.png)

![](img/201aede0fc92d1f99ffb27bb2f301da2_125.png)

这是一种啊，但这种方式会有什么问题呢，如果我们这样去节点的话。

![](img/201aede0fc92d1f99ffb27bb2f301da2_127.png)

显然我们的原始索引数就没了，如果你是原始数也是姓名的话，那这个姓名丢了对不对，我们就不知道这个什么有什么含义了，所以说这种情况呢，它一般来讲呢我们对于纵向连就是行标签，一般来讲没意义，我们可以这么干啊。

那如果你是横着连列标签一般都是有意义的，所以我一般不这么干，因为你列标签都是字段的对吧，列表上面都是字段，这是name，这是edge，这是啊，身高体重分数，那我列标签。

如果你给他直接excel index的话，那这个东西没有意义了啊，所以一般我们列方向啊，就是横着几点的话，我们都不会用这个ignore index来处理。



![](img/201aede0fc92d1f99ffb27bb2f301da2_129.png)

那会用什么呢，我们可以这么干啊，Df 1df2，然后这个我们先把方向改成一啊，然后我们用一个什么呢，叫kiss kiss啊，我们可以给它分成什么呢，分成这个比如说是first。



![](img/201aede0fc92d1f99ffb27bb2f301da2_131.png)

second给它分成两个区啊，那它是123。

![](img/201aede0fc92d1f99ffb27bb2f301da2_133.png)

它是234，我们给他做这种多层级索引的这种方式，给他处理，这样的话呢我们可以保留原始索引对吧，那这样我们就可以避免什么，避免因为索引相同，然后导致的一些问题了啊，给他以这个多层级给他做一个划分就好了。



![](img/201aede0fc92d1f99ffb27bb2f301da2_135.png)

能理解吧，啊所以说我们ignore index跟kiss这两个参数啊，其实都是解决我们几天之后，这个标签重名的问题啊，那么这种情况解决的是啊。



![](img/201aede0fc92d1f99ffb27bb2f301da2_137.png)

一般，用于这个纵向集连，然后处理这个行标签嗯，重复问题的问题啊，为什么呢，因为因为行标签一般来讲没有意义，一般都是一个编号id啊，012345678啊，所以你可以忽略。



![](img/201aede0fc92d1f99ffb27bb2f301da2_139.png)

那么我们这种方式啊，是给他以这个分区的方式给他做处理的，所以它一般用于横向节点，来处理这个列标签重复的问题啊，因为字段因为列标签，是字段，所以一般保留。



![](img/201aede0fc92d1f99ffb27bb2f301da2_141.png)

![](img/201aede0fc92d1f99ffb27bb2f301da2_142.png)

好了，那这几个参数我们就说完了啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_144.png)

那我们来看一下下面这个练习。

![](img/201aede0fc92d1f99ffb27bb2f301da2_146.png)

首先吉林的场景是什么呀，什么时候吉林嗯嗯业务表的表结构相似，是不是相似或相近的这种汇总，我们用吉连就可以了啊，然后呢我们要构造这样一个表，一个期中考试张三李四的成绩表，新增一个考试学科，计算机如何实现。

新增王八五同学的成绩如何实现。

![](img/201aede0fc92d1f99ffb27bb2f301da2_148.png)

这里面要求我们用吉连的方式来实现啊，要求用几点的方式实现。

![](img/201aede0fc92d1f99ffb27bb2f301da2_150.png)

不要用别的方式啊，别的方式肯定能实现啊，但是不是不用啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_152.png)

使用吉联来实现，大家试一下啊，动手啊，嗯怎么说呢，咱们的动手能力太差了啊，一个双循环都写不出来啊，你这怎么搞明白，这都动起来啊，你要是不动的话，有想法的话，我是手机有没有通过，双击定于100。

然后关系对等进，N a t a，我们一起下，线上搞信息看这一信号，351哪能不能嗯，我前天买了，嗯嗯可以啊，嗯嗯知道了嗯嗯，今天怎么没用了，新人附近1cm i a o e，哎这几点都不看了，哎。

地上最后就是什么，谁来着，机器人吗，这是cf吗，英雄联盟全程自我把这个平行，这不就完了，能不能成功呢，是另外一个人，但是我可以进一下，C5什么3374咳咳十度，这么说也没法说实现。



![](img/201aede0fc92d1f99ffb27bb2f301da2_154.png)

你看好这个，我看有好多同学写完了啊，咱们一块写一下啊，这就是一个考试成绩，他就是一个单级表对吧，一个单级表啊，Scout我们要等于一个data frame data，然后这边有张三李四的场景。

那这里边我们可以去假设是两个人，三个学科啊，那我们这个data应该几行几列，两行三列是吧，NP点random，点RANDORINT啊，0~100size等于两行三列，然后index呢那就是张三李四。



![](img/201aede0fc92d1f99ffb27bb2f301da2_156.png)

好这是一张表啊，然后我们现在要干嘛呢，有我要新增一个考试，一个学科计算机啊，新增一个学科计算机，那也就是说我们说得，你得有一个这个一列数据是吧。



![](img/201aede0fc92d1f99ffb27bb2f301da2_158.png)

就一个计算机的成绩呗，对不对，这个是，啊DF1让它等于一个data frame，一列那就是两行一列呗，是不是两行一列，然后呢index呢，嗯是不是跟他这个index一样啊。

啊那就是score点index，然后COLUMENTS呢，你就直接指定为一个计算机就行了啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_160.png)

这是DF1啊，然后呢他俩之间是做个横向节点就可以了啊，那这个，scar等于pd点contact at，然后左边是scar，右边是DF。



![](img/201aede0fc92d1f99ffb27bb2f301da2_162.png)

一横着连，是不是得指定下方向啊，等于一。

![](img/201aede0fc92d1f99ffb27bb2f301da2_164.png)

啊他就连起来了，然后另外一个是新增一个王老五同学的成绩。

![](img/201aede0fc92d1f99ffb27bb2f301da2_166.png)

是不还是一样的，我们再构造一个DF2啊，这个王老五成绩data frame，然后data是几行几列啊，是不是应该是一行四列啊，NP点random点round int啊，这个0~100size等于一四。

那index等于什么，所以指定啊王老五啊，王老五，然后这个HOEMENTS呢，我们指定为，是不是这个死Scout的columns就行了，Scout columns。



![](img/201aede0fc92d1f99ffb27bb2f301da2_168.png)

这DF2好，然后这两个表是做纵向节点就可以了啊，这个scar等于pd点contact at scar。



![](img/201aede0fc92d1f99ffb27bb2f301da2_170.png)

然后再来个DF2。

![](img/201aede0fc92d1f99ffb27bb2f301da2_172.png)

好了啊嗯，另外一个还有一个可判的函数啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_174.png)

这个恶判函数就直接追加了啊，比如说我们这个scar scar。

![](img/201aede0fc92d1f99ffb27bb2f301da2_176.png)

我这两个表我看连到一块的话，我可以直接的判断，再来个scar是吧，就是一个我们纵向做追加。

![](img/201aede0fc92d1f99ffb27bb2f301da2_178.png)

做节点的一个便捷方式啊，和判断函数好了。

![](img/201aede0fc92d1f99ffb27bb2f301da2_180.png)

这个不说了啊。

![](img/201aede0fc92d1f99ffb27bb2f301da2_182.png)