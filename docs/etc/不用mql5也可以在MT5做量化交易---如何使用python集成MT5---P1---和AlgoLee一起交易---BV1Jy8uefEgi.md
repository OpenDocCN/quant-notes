# 不用mql5也可以在MT5做量化交易 ｜ 如何使用python集成MT5 - P1 - 和AlgoLee一起交易 - BV1Jy8uefEgi

![](img/aada0fe73d3ca74134e574fbb652e0d7_0.png)

哈喽大家好啊，我是阿勾丽，今天给大家分享一下如何使用Python在mt5中呃，做这个量化交易，为什么要做这期内容呢，是因为有一个小伙伴啊，他说他目前工作使用的是Python呃。

所以他是打算使用这个Python，来做策略的编写和回测，但是呢他呃他又想使用这个mt5的交易环境，去做实盘交易啊，呃因为mt5的数据啊，它都是现成的，都是免费的，不管你是实盘也好还是回测也好。

呃使用mt5的话，他就不用再去维护一套这个数据系统了，所以就想怎么才能把这个Python啊，和mt5啊集成在一起，我觉得这个问题还挺有意思的，所以我们今天就来讲解一下呃，那么有的观众可能会问啊。

为什么他不直接使用这个，MQ25的实现方式啊，呃因为你既然已经有了Python这种编码基础啊，你再去呃学另外一门语言，去学这个MQ25的话，其实是没有那么困难的啊，呃我个人呢觉得他可能是出于这个。

一方面是他因为他工作使用的是Python啊，他已经很熟悉了啊，他就不想再花更多的精力啊，再去呃学习另外一门语言了啊，另外就是就目前这个全球的使用范围来说。

Python代码上面的这个第三方的库啊的这种支持啊，要比MQ25啊多得多得多，包括一些比较复杂的应用场景，使用Python去实现的话要方便的多啊，并且就我个人而言啊。

虽然我不使用Python直接去做交易啊，但是我也是会用到它，帮助我去做一些呃比较固定化的啊，流程化的一些工作啊，他是一个非常不错的啊辅助，并且即便是你想直接使用这个Python代码。

在啊mt5mt5上去做交易啊，也是完全可以的，因为mt5他是已经呃集成了这个Python好，那么我们今天就来看一下，如何去使用这个Python去集成呃，使用这个mt5去集成这个Python代码去做交易。

我今天呢就先大体的介绍一下整个流程，以及它会涉及到的一些方法，呃，后面如果对这方面感兴趣的人比较多的话啊，我就再单独出一个视频去啊，演示如何使用Python去写一个啊，完整的mt5的量化程序。

当然如果因为这个东西相对来说，可能会比较冷门啊，嗯可能使用mt5的，它它就直接使用这个MKL5代码去实现了，使用Python的话，它直接就完全使用Python去这个实现量化的操作了。

所以关于这块的内容可能相对来说比较冷门啊，我估计呃可能关注的人比较少啊，啊但是我们先先先做一期看看好，那我们开始呃针对于这个集成m Python的话，做一个大体的介绍，呃，我假设点进这个视频的。

对这个视频感兴趣的，都是已经有了Python相关的这个理论基础的，所以我这里不会去介绍啊，什么是mt5，什么是啊，Python包括Python如何安装啊，他的这个编辑器啊这一类的东西啊。

我都我我这里就不说了啊，我假设你是已经熟悉的了，好那我们就开始啊，呃这里是这个mt5官方针对于Python呃。



![](img/aada0fe73d3ca74134e574fbb652e0d7_2.png)

集成的一个帮助文档，呃，你有任何的问题有任何的疑问啊，你都是以这个帮助文档为准啊。

![](img/aada0fe73d3ca74134e574fbb652e0d7_4.png)

包括我们今天所介绍的，其实就是介绍他这里面的这个方法啊。

![](img/aada0fe73d3ca74134e574fbb652e0d7_6.png)

你如果呃自己觉得呃，这个编程基础比较不错的话。

![](img/aada0fe73d3ca74134e574fbb652e0d7_8.png)

你可以自己去这个看文档就可以了，今天的视频就完全没有必要看啊，因为它这里面的内容就已经非常详尽了，好那么使使用这个集成Python的话，首先要有Python的环境啊，好首先要要有这个mt5的环境啊。

我们首先使用这个啊paper，来将这个mt5相关的这个包给安装一下，好他这里显示我是已经安装好了呃，大家注意啊，就是反正我今天尝试的时候啊，我使用导入这个包的话。

他要求的话这个long派的话嗯是要一点呃，版本的话是要小于二的啊，否则的话可能有不兼容的问题啊，当然这个不同的环境可能不一样，大家自己测试的时候自己去观察吧，反正我这里的话呃。

是安装了一个低版本的安排啊，好这里的话就是安装成功，安装成功之后，我们使用这个import把这个包进行一个引入，引入之后呢，我们调用这个initialize啊，进行一个相当于是连接这个mt5啊。

嗯大家注意啊，这一块的话，如果你们只有就是你们的电脑上，只安装了一个mt5的话，你可以直接这么调用就可以了啊，但是因为我的电脑上安装了多个mt5啊，所以我这里就指定给他指定一个。

我究竟要连接哪一个mt5，我就把他这里的这个EXE的路径给它，写在这里连接一下，那这里显示true的话，就代表我们的Python环境和这个额mt5的环境，已经连接成功了啊。

那接下来的话就是相当于是一个登录啊，就是mt5的身份验证，这里的login的话就是就是我们这一块的额。



![](img/aada0fe73d3ca74134e574fbb652e0d7_10.png)

相当于是这个账户id。

![](img/aada0fe73d3ca74134e574fbb652e0d7_12.png)

然后这里的password就是你这个账户的密码呃，这里的话我是啊，刚刚啊新申请了一个啊demo账户啊，大家使用自己的这个额账户信息去连接啊，不要使用我这里写的，不然的话是连接不上的。

然后server的话就是你这个broker的服务在哪里，就把他这里写上就可以了，然后我们调用这个mt的login方法嗯，我们看一下。



![](img/aada0fe73d3ca74134e574fbb652e0d7_14.png)

他这里调用的就是首先就是account number，然后password，然后就是server name。



![](img/aada0fe73d3ca74134e574fbb652e0d7_16.png)

最后有个连接超时的一个参数，不需要写，然后回车，我这里按的是CTRL加enter，它是这个编辑器的一个运行的呃方式，然后他是这里显示true的话，就代表连接成功了，身份验证成功了啊，验证成功之后。

我们就可以使用这个mt来调用它，这下面的这些所有的参数了，所有的方法首先给大家看一下账户相关的方法。

![](img/aada0fe73d3ca74134e574fbb652e0d7_18.png)

要用这个account info的话，他是给我们返回额，返回当前登录的这个账户的所有的用户信息。

![](img/aada0fe73d3ca74134e574fbb652e0d7_20.png)

然后得到这个对象之后，我们使用这个对象点server，就可以获取到他的这个broker的server地址，然后这里的话就是account account number啊。

返回的就是account number，然后这里就是账户的余额，这里的话就是账户的净值运行一下，看一下没有正确的获取啊，呃呃i ic markets demo的话就是正确的啊。

然后是我们登录的账户的话是，51881203881203，然后我们的账户的余额是99862。84，毛病啊，账户净值的话是998。620。84啊，是正确的啊，正常的获取到。



![](img/aada0fe73d3ca74134e574fbb652e0d7_22.png)

然后关于账户其他的一些信息啊，大家可以呃点开这里的account info，Integer，In info，Double info string，可以获取到额更多的一些信息啊。

我这里的话就带更多的演示了。

![](img/aada0fe73d3ca74134e574fbb652e0d7_24.png)

然后就是品种相关的这个方法。

![](img/aada0fe73d3ca74134e574fbb652e0d7_26.png)

我们使用这个SYMBOTOTAL的话，他可以帮我们获取到当前当前这个券商。

![](img/aada0fe73d3ca74134e574fbb652e0d7_28.png)

这个broker他支持的所有的这个品种数是多少，然后使用这个symbols get的话，他获取到的是这个当前所有的可交易的，这个商品的所有信息是什么，运行一下。

看一下他这里代表的就是这个s markets，它可交易的品种是2427个啊，大多数的话其实都是股票啊，股票占了大多数，然后这里的话我打印了一个symbol点visible，像类似于这种信息的话就可以。



![](img/aada0fe73d3ca74134e574fbb652e0d7_30.png)

这还是我刚才打开的那几个页面里面的。

![](img/aada0fe73d3ca74134e574fbb652e0d7_32.png)

而这里就是它的内膜，这里的话就代表它是否是否在这个市场报价中，展示出来了，比如说我们这里的欧美和镑美的话，它都是在这里面有的棒美欧美，然后这里的美瑞的话，它就在这里面是没有展示出来的。

所以他就是一个boss，我们给它添加一下啊，我们给它添加上一个北瑞的话，诶你家的美人啊，添加了一个美瑞，然后这里他在已经在这个额交易品种，市场报价中展示出来的话，这里的话那就应该再运行一下的话。

他应该就是true了啊，大家看这里啊，就是住了，好那么这里的话是再给大家演示一下，获取当前交易品种的一个品种信息。



![](img/aada0fe73d3ca74134e574fbb652e0d7_34.png)

调用的是这个symbol info的方法，然后传入的话就是传入你想要查询的，这个品种名称。

![](img/aada0fe73d3ca74134e574fbb652e0d7_36.png)

然后他就会把当前品种，这个品种的所有信息给展示出来，包括这里的这个啊bin mode，这里倍的价格，包括这里的什么拉斯泰啊，阿斯克hi啊，包括这里的volume啊，他都会展示出来这里的name，好。

那么我们关注的可能更多的是当前交易的一个。

![](img/aada0fe73d3ca74134e574fbb652e0d7_38.png)

报价方面的信息，我们就可以使用这个symbol info ticket，来进行获取，还是调用方式一样的啊，传入这个SYMBO。



![](img/aada0fe73d3ca74134e574fbb652e0d7_40.png)

然后他就可以获取到当前的时间，然后倍的价格，ask sk价格啊，Volume，还有这里的什么real volume这些啊信息啊，好这是品种相关的啊。



![](img/aada0fe73d3ca74134e574fbb652e0d7_42.png)

他还有一些其他的，包括这个slack什么之类的，大家感兴趣的话，自己去详细了解一下，我不会把这些所有的接口都做演示啊，我只会把一些呃可能比较常用的一些呃。



![](img/aada0fe73d3ca74134e574fbb652e0d7_44.png)

接口来做一个演示，那接下来的话就是数据相关的额数据相关之前，我先呃安装两个库啊，一个是pandas库，用来处理我们这个数据的，一个是用来画图的，然后进行一个引入。

然后我们调用这个mt的copy rates range的话。

![](img/aada0fe73d3ca74134e574fbb652e0d7_46.png)

这就是用来获取我们的呃历史数据，数据也好，当前数据也好，都可以使用它来进行获取，这可能也是后续大家做这个呃实盘啊，包括你做回测的时候，可能会用到频率比较高的一个方法，它的调用方式也比较简单。

首先第一个参数就是传入当前品种，然后啊time fit2是周期，然后就是开始时间和结束时间。

![](img/aada0fe73d3ca74134e574fbb652e0d7_48.png)

我这里的话就是获取的比特币的日线上的，2023年1月1日至今的一个呃历史数据啊。

![](img/aada0fe73d3ca74134e574fbb652e0d7_50.png)

然后他返回的是一个啊non派的err啊。

![](img/aada0fe73d3ca74134e574fbb652e0d7_52.png)

然后我们把这个南派的err来转换成这个，date frame的格式啊，最后的话使用这个呃pat来进行一个呃，折线图的一个显示啊，好X轴的话是我们的time啊，Y轴的话就是啊close价格调用一下的话。

他就会帮我们呈现出比特币额，从2023年至今的一个折线图，下面的话是啊具体的这个每一天的额报价嗯，然后我们看一下啊，日线，2023年，原因就是从这里开始啊，嗯没毛病啊，可能就是因为坐标系数的关系啊。

所以看起来额有一点不一样，但是其实是都是一样的，最近的话比特币是有所上升了啊，呃我的现货的建仓价格还是比较低的啊，目前来说还是盈利的，但是震了这么久啊，还是让我很难受啊，难受的都不想看电脑啊。



![](img/aada0fe73d3ca74134e574fbb652e0d7_54.png)

不想看行情，好说回来，我们这是获取他的这个报价信息。

![](img/aada0fe73d3ca74134e574fbb652e0d7_56.png)

然后的话就是关于这个额当前持仓。

![](img/aada0fe73d3ca74134e574fbb652e0d7_58.png)

![](img/aada0fe73d3ca74134e574fbb652e0d7_59.png)

还有历史持仓，包括还有他这个呃额挂单的一些方法调用一下，首先是这个position get，他获取的就是当前的目前的未平仓的订单，这里下两笔，不然的话看不出来好，这一笔的话是7058，也就这一个。

然后它的价格是66752，六六哎，看一下换啊，六六好，这里66752。14啊，WILLIAM的话就是一首，然后下一笔的话就是6673966，66739。6，然后也是一手啊，这就获取到当前的这个持仓好。

然后这里的这个order sk，他获取的就是目前的这个挂单的信息，我们还是运行一下，也是两个，一个是这个538，还有59238592啊，然后6676。056，对它的价格应该是这个啊。

70765和59698。76啊，都是没毛病的啊，这是挂单相关的啊，然后下面的话就是，然后下面的话就是我们这个history order sk，他获取的就是我们这个呃历史的这个呃，历史的订单信息啊。

还是因为我这里比较多啊，并且他这个因为我这个缩放问题啊，他老是看不清啊，所以大家看一下呃，第一行就是705786437，然后再看一下这里啊，705786437，第二行是这个705786439。

105786439是没有问题的啊，这获取的就是历史的持仓类的信息，好最终的话再接下来的话也没有其他的了。



![](img/aada0fe73d3ca74134e574fbb652e0d7_61.png)

就是我们比较常用的。

![](img/aada0fe73d3ca74134e574fbb652e0d7_63.png)

用的比较频繁的，这个ORDERSON的是我们具体的下单啊，开仓和平仓的方法看一下，先把这两个去掉，额，还是在比特币上测试啊，因为今天是一个周六啊，所以其他的都是已经闭盘了，使用BTC来做演示。

因为他是周六，周天也是开盘的，我们是调用这个order son的方法。

![](img/aada0fe73d3ca74134e574fbb652e0d7_65.png)

然后他需要的是一个request的一个呃数据结构，依此看一下它这里面的。

![](img/aada0fe73d3ca74134e574fbb652e0d7_67.png)

参数这action的话我们传入这个trade action dio，它代表的就是我们下的是一个额限价单。



![](img/aada0fe73d3ca74134e574fbb652e0d7_69.png)

看一下这里的说明啊，可以现现现价单，也可以下这个挂单，包括这个MOTIFY订单。

![](img/aada0fe73d3ca74134e574fbb652e0d7_71.png)

目的订单都有啊，这里就是下一个限价单，SYMBLE的话就是你要做的这个品种是什么，然后volume的话就是你具体的下单手数，然后type的话，他这里就代表了我们下单的一个类型。



![](img/aada0fe73d3ca74134e574fbb652e0d7_73.png)

我这里是order type，five的话，它就是，就是market by order啊，还可以下market sell，order的话就是order type sell，包括这里的by limit。

Cell limit by stop sales。

![](img/aada0fe73d3ca74134e574fbb652e0d7_75.png)

Stop by stop limit，By sales，Stop limit，他这里都是可以下的，而这个price的话，它代表的就是我们的压单价格，这样SL的话就代表我们的止止损，GP的话就是我们是啊。

然后因为这里他是这个币比特币啊，所以我们这里的点数都非常的大啊，如果你是额货币对的话，你这里可能就是比较小小的数值啊，啊这里的话就是可接受的这个呃，可接受的点差是多少。

然后常规的我们magic number comment是我们的注释都是额，其余的就是我们常规的根据这个不同的券商，他可能使用这个分类模式不一样，填入不一样的这个模式不一样的这个参数好。

我们最终的话是把这个STRUCT传入到这个，AUDERSON的方法里面，会他就会帮我们下一单，就这里就帮我们下了一手这个比特币的多兰啊，就是这一单，这就是我们的下单啊。

包括我们后续可能使用这种啊量量化程序的话，这个函数调用的也是比较频繁的好，这是我们的开仓，那接下来就是我们的具体的一个平仓的操作，然平仓的话它其余的参数大多都是一样的。

还是传入这个呃request的这个STRUCT结构，然后调用这个ORDERSON的方法，有一点不同的是，我们这里需要给他传入一个position的id啊，也就是我们的ticket id啊。

告诉他你具体要平的仓位是哪一个，比如说我们这里的就是这个705806，705806806，我们调用一下，大家看这里啊，我们调用的话，他就是直接把我们这一单给我们停掉了啊，好这就是我们的平仓方法。

余的也没有太多的内容了。

![](img/aada0fe73d3ca74134e574fbb652e0d7_77.png)

后面的话就是呃根据这些额方法。

![](img/aada0fe73d3ca74134e574fbb652e0d7_79.png)

然后融合成为一个reading boot，好，这就是我今天要给大家分享的全部内容，如果你也有这方面的需求的话，就自己去做一下呃，深度的研究好，那我们就下个视频再见吧，拜拜哦对了。

如果感觉视频对你有帮助的话。

![](img/aada0fe73d3ca74134e574fbb652e0d7_81.png)

还请点赞评论加关注。