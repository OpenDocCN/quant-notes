# Python实战量化交易理财系统2-2如何通过PythonAPI获取股票数据 - P1 - 无限超人Infinitman - BV13s4weUESj

哈喽大家好，这期视频我们来看一下，如何通过Python的API来获取股票数据，获取股票数据有三种方式，一种是通过爬虫啊，我们自己到东方财富的网站上去爬取它，那这样的话呢会比较费时费力。

因为有非常多的数据，当然也可以自己去写接口，但是会非常费时费力，然后第二种方式呢是通过数据服务商，也就是通过wind彭博或者是炒股软件，他们会提供这样的一个付费的接口，一年几万块钱。

然后第三种方式呢就是通过一些免费的接口，比如说一些量化交易平台开源代码库，那这个它给你提供了一些试用的是免费的接口，你可以获取到很多数据，那我们采取第三种方式啊，因为它是免费的嘛是吧。

我们来看到这里的距宽社区这里，那我们打开这个网站之后呢，我们可以看到啊，这就是一个量化的交易的一个社区，那这里他会给你提供一些数据，当然它也有会员在这里呢，我们来看一下。

我们怎么去获取到我们的想要的数据呢，我们先来了解一下这个网站，这个网站呢它提供很多东西，比如说策略研究数据，字典社区等等啊，在这里呢我们来切换到它的数据质点，这里可以看到它这里提供了股票数据。

行业概念数据，它的股票数据包括全面的行情，财务基本面等数据，然后还提供指数的数据，宏观经济数据，期货数据等等，它提供的数据还是挺多的，那在这里呢我们主要用的是股票数据，我们可以点击进去看一下。

他给你提供的这些股票的数据啊，已经给你按照这种菜单等级给分类好了是吧，比如说你获取单只股票的数据，可以用这种API的接口给你写好了是吧，那这里呢他们都会给你提供一个接口。

然后给你提供一个具体的它的参数的含义，然后具体的调用的实例是吧，就是看起来很简单，那在这里呢我们怎么去调用它呢。



![](img/b54e2ce8860165a6787c4274728d630b_1.png)

实际上除了这个数据字典的入口，这里还会有一个本地数据。

![](img/b54e2ce8860165a6787c4274728d630b_3.png)

我们通过Python版的API调用会更加的方便是吧，这里的有非常全的一个接口的说明和使用文档，我们来通过这个路口来了解怎么去使用，这个网站给你提供的接口是吧，那首先呢我们来看一下嗯。

嗯这个最基础的介绍啊，在这里呢他会给你一些就是数据说明书是吧，呃flow j q data sd k import新是吧，那我们来看一下他的介绍和说明吧，主要是这里。

首先呢我们会了解如何去开通这个j q data啊，就是join qu里一个data，我们来如何开通，首先呢我们他需要去提交试用的申请，就能得到六个月的有效期的试用账号是吧。

试用账号在试用期内可以免费调用，他的全部基础数据，每天可以调用100万条，具体的试用权限呢是吧，这些都是数据好。



![](img/b54e2ce8860165a6787c4274728d630b_5.png)

那我们现在就来提交试用申请了，在这里你需要填写各种数据，最重要的是你填写正确的手机号，然后呢他会给你输入一个验证码。



![](img/b54e2ce8860165a6787c4274728d630b_7.png)

你获取验证码之后点击确认提交，他就会给你一个账号了。

![](img/b54e2ce8860165a6787c4274728d630b_9.png)

具体的方式呢我在这里截图上，大家也可以看一下，就是如果你写好了之后呢，他会给你一个提供给你一个账号，还有密码，密码就是账号的后六位，然后你直接登录即可是吧。



![](img/b54e2ce8860165a6787c4274728d630b_11.png)

在这里呢我直接登录一下啊。

![](img/b54e2ce8860165a6787c4274728d630b_13.png)

![](img/b54e2ce8860165a6787c4274728d630b_14.png)

那因为我之前已经注册好了，所以我这里就直接登录了，登录完成后呢，你看就会显示这个东西是吧，我们来看一下，我们就是说这样的话我们就弄好了，接下来呢我们开通完成之后呢，我们要看什么东西呢。

就是说我们来看如何安装和使用j q data是吧，这里呢他会给你提供一些的步骤，安装就是papping store，然后升级就是popping store，杠U对吧，然后使用它呢就是flow jd。

使用它呢就是flow j q data SDK import新，然后在这里呢输入你的账号和密码，就可以调用它的接口了，就可以获取数据。



![](img/b54e2ce8860165a6787c4274728d630b_16.png)

所以呢，这里我们把最基本的概念介绍完成之后呢，我们就来实干一下啊。

![](img/b54e2ce8860165a6787c4274728d630b_18.png)

首先呢我们来看一下我们要安装这个SDK。

![](img/b54e2ce8860165a6787c4274728d630b_20.png)

那首先我们来创建一个脚本是吧，能创建一个。

![](img/b54e2ce8860165a6787c4274728d630b_22.png)

![](img/b54e2ce8860165a6787c4274728d630b_23.png)

叫做虚幻世俗的quit的一个项目，我们在这里，创建好这么一个项目啊，项目里面呢我们就可以通过file open folder。



![](img/b54e2ce8860165a6787c4274728d630b_25.png)

这是vs code呃，关于如何使用vs code来去编写Python代码，这些都是比较基础的东西，所以大家呢自己去了解就可以了，那在这里呢，我们直接去打开刚刚创建的那个文件夹。

比如说就是HUAQUENT是吧。

![](img/b54e2ce8860165a6787c4274728d630b_27.png)

我们选择这个文件夹，那这样的话呢在里面我们就来创建一个文件夹，因为我们这一次主要是获取数据，他就是数据端，所以我们给它创建一个data的文件，然后呢文件夹，然后在里面我们创建一个，Stock。

点PY获取股票行情数据的一个Python脚本文件。

![](img/b54e2ce8860165a6787c4274728d630b_29.png)

那这里呢我们就可以虽然很简单，我们直接来到他的官网，根据官网来编程，首先呢我们需要安装这个库啊。

![](img/b54e2ce8860165a6787c4274728d630b_31.png)

安装这个库很简单，我们先运行一下这个脚本，然后它会弹出一个终端是吧，我们直接popping store这个，然后他就会安装了，那安装的过程呢可能会比较长啊，因为他这个库还是比较大的。



![](img/b54e2ce8860165a6787c4274728d630b_33.png)

我们稍等一下，然后在后面的话呢，我们会把这个登录这个SDK。

![](img/b54e2ce8860165a6787c4274728d630b_35.png)

我们需要登录它是吧，那这里已经安装好了，安装好了之后呢，我们就要把刚刚的代码给它粘贴过来，那这里呢我们就睡去，把它引入进来，然后这里输入的是账号和密码，账号呢就是你申请的账号。

密码呢就是账号的后六位是吧，然后我们运行一下。

![](img/b54e2ce8860165a6787c4274728d630b_37.png)

这里因为我装了很多个版本的Python啊。

![](img/b54e2ce8860165a6787c4274728d630b_39.png)

所以我需要先运行CMD，可以看到我的是在空的，第一个的Python是在空的的Python点ex1。

![](img/b54e2ce8860165a6787c4274728d630b_41.png)

那我们选中这个啊，选中这个，然后继续再执行。

![](img/b54e2ce8860165a6787c4274728d630b_43.png)

这里的安装啊。

![](img/b54e2ce8860165a6787c4274728d630b_45.png)

因为刚刚可能安装到其他的，因为Python路径有很多，我安装了很多个版本，所以在这里呢，那如果你安装一个版本是没有这个问题的是吧，那我弄好了之后呢，我们再次运行一下。

这时候是通过空的点Python exe来运行这个Python文件，可以看到是没问题的，提示我已经成功登录了对吧好的，那这样的话呢我们就成功的去能够去登录。



![](img/b54e2ce8860165a6787c4274728d630b_47.png)

并且使用它的接口了，那接下来呢我们来看一下，就是我们如何来获取行情的数据，在这里呢他会给你提供了这么多的数据啊，有股票的，期货的，基金的，指数的，期权的，债券的都有，但是呢我们只需要获得股票的行情数据。

我们点击它，然后在这里呢我们可以看到这里会有一个get price，它就是获得一天或者每分钟的行情数据是吧，那这里呢它会有这个接口和它对应的参数，以及它的一些说明是吧，然后呢会给你不给每个参数呢介绍。

然后是files啊，这也是一个参数的一个介绍是吧，比较详细的介绍，那在这里呢我们可以看到他的代码示例啊，我们直接给它copy过来复制，然后呢我们到这里。



![](img/b54e2ce8860165a6787c4274728d630b_49.png)

给他粘贴上去，为了方便演示，我分了三行啊，首先呢这里我们看一下，我们先来运行一下，先运行一下代码，哎，大家可以看到这里呢，就会得到一个这样的结果是吧，然后这是我们调用的方式，我们简单给大家解释一下。

Get price，get price x s h1是什么东西呢。

![](img/b54e2ce8860165a6787c4274728d630b_51.png)

X h1，我们来看啊XSHG就是上海证券交易所，XSHE就是深圳证券交易所。

![](img/b54e2ce8860165a6787c4274728d630b_53.png)

也就是说我们这个是股票代码为000001，的深圳证券交易所，大家可以知道这个是平安银行是吧，也就是说它是一个股票代码，加上他的交易所，才能确定我是获取哪一个股票的行情数据是吧，然后呢。

End the data，就是它截止，你要获取到这个行情数据的截止时间，然后count等于四呢，就是你要获取四条数据，你看这里有四条是吧，截止时间是2015年1月30号2点的，前面4分钟是吧。

因为他是以每分钟为一个frequency去调用，获取这个接口的，然后files呢就是它的一个列的字段，比如说open close high low volume money是吧，都在这里好。

那这样的话呢就是这个行情数据的一个接口啊。

![](img/b54e2ce8860165a6787c4274728d630b_55.png)

是吧，我们成功的去获取到了这个行情数据，那关于它里面的详细的参数介绍呢，大家实际上可以在这里都能看得到，这里的话呢就是我们就可以去仔细看，如果你有别的要求的话，你就可以换一下这里的一个参数是吧。

那我们接下来看，我们接下来看一下，接下来呢我们来测试一下。

![](img/b54e2ce8860165a6787c4274728d630b_57.png)

我们刚刚只是大致讲解了一下，比如说我把它想获取十条数据是吧，我想获取2021年5月30号的数据，之前的数据，然后呢我想按照天来获取，叫做ED啊，day嘛是吧，一天，然后运行一下，那这里就大家就可以看到。

这只是5月28号啊，5月29号刚好就是周末是吧，5月27，5月26，5月25，他是按天来获取，获取了十条，然后呢是以5月28号，就是5月30号之前的那两个数据来获取是吧，那这样的话呢诶符合我们的预期。

我们测试就成功了，接下来呢我们来校验一下这些数据是否正确，因为有可能他的数据是错的啊，那这样的话呢我们通过这种量化交易呢，得到的结果也肯定是错的是吧，那有了这些数据之后呢，我们来对照一下，怎么对照呢。

非常简单。

![](img/b54e2ce8860165a6787c4274728d630b_59.png)

我们还是到哪里呢，到我们的东方财富网。

![](img/b54e2ce8860165a6787c4274728d630b_61.png)

然后呢在这里我直接输入股票代码就行了，唉他这里会显示深圳交易所的一个股票代码，我们点击它的行情，这里呢就是你看平安银行是吧，经开24。68，那这个就是5月28号的数据啊，因为我是获取最新的数据的。

对应到这里的接口呢就是24。68是吧，然后比如说你可以看这里的volume是对应的，就是这里的总市值是47541，啊成交量他是成交量，对应的是4924万手，49。24万手是吧，对应的成交额呢是12。

01亿，12。01亿是吧，就说明我们这个数据啊是没有错的是吧，当然如下，您想校验这5月27号也很简单，打开这个K线，5月28号是吧，然后呢你看这里他就定位到5月27号是吧。

你可以对应到这些数据实际上都是准确的，那这样的话呢，我们就能够去诶获取到正确的数据了是吧，这是正确的行情数据，这是每天的，那刚刚我们看到我们改了frequency啊。

虽然frequency它会有一种简化的表达方式，然后刚刚是一分钟吗，在一分钟内也有直接改成em，也可以去直接获取是吧，哎这样就获取到每分钟的数据了啊，那这样的话呢，因为他只要在5月30号之前。

那是他是在5月28号3点是吧，这是正确的好，那这样的话我们就获取到每分钟的数据，那接下来呢我们来看另一个接口，我们想要获取多个股票代码的一个数据，因为这个数据是吧，它只是一个股票代码，怎么获取多个呢。

我们现在再来讲解一个接口。

![](img/b54e2ce8860165a6787c4274728d630b_63.png)

就说我们来看一下，如何获取到所有的股票代码信息，看到这里获取所有的股票代码信息对吧，我们点击进去来看一下，这里我们直接拿他的一个例子啊，我们拿他的一个例子，将所有的股票信息转化为数组是吧。



![](img/b54e2ce8860165a6787c4274728d630b_65.png)

我们拿这个例子，然后到这里我们先把这一段注释起来，然后在后面呢我们来给它运行一下，我们运行，我们把前五个的结果给它打印出来啊，哎你看到他就是把前五个的股票代码，给打印出来了是吧，这里只是前五个是吧。

我们这个它是一个数组，是所有的，我们可以不妨打印出来所有的股票代码，那这里会比较长啊。

![](img/b54e2ce8860165a6787c4274728d630b_67.png)

你看总共是多少呢，总共应该是4000多个股票代码，A股的所有的一个，股票的一个数据都在这里好，那这样的话呢我们就获取到了所有的行情数据，是吧的一个股票代码，那接下来我们来看一下，我们直接拿这里的。

就是我们直接就会去拿这里的，我们在讲义中所写好的代码来讲解，这样方便呃，演示我们直接copy这段代码。



![](img/b54e2ce8860165a6787c4274728d630b_69.png)

实际上是一模一样的，我们只是为了讲解的快一点是吧，虽然是一模一样的，这是我们来看一下这段代码的含义，就是说我首先呢会导入这个time的时间库啊，我们会去让他sleep3秒钟，来看一下每一个行情数据。

就是我想每隔三秒获取一个股票代码的，行情数据，那这里呢是我们刚刚讲的接口，我们把所有的股票代码的一个列表给它获取到，那这里有4000多条，然后我们对这4000多条数据进行便利。

然后打印出你当前正在获取的那个股票代码，是什么是吧，然后呢我们通过获取这个股票的行情数据，然后去把它的每天的数据呢行情数据给获取到，然后从截止时间为这个时间，然后呢是五条数据是吧。

我们然后呢他FS是这么多，哎这是我们之前所有的介绍的一个过程是吧，那接下来呢我们就来运行一下，可以看到它正在获取哎平安银行的一个股票，然后过了三秒钟呢获取0002股票代码。

然后004的股票代码的一个行情数据，这样的话呢，我们就实现了通过接口来获取到，这个行情数据的一个方式啊，这非常简单是吧，我们非常非常简单，所以这就是一个简单的，获取行情数据的一个脚本。

后续呢我们会根据需求来对这个脚本进行扩充，那这就是本期课程全部内容，感谢你的观看。

![](img/b54e2ce8860165a6787c4274728d630b_71.png)